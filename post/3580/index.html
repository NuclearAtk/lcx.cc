<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>PHP安全编码 - Nuclear&#39;Atk（核攻击）网络安全实验室</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="瞌睡龙" /><meta name="description" content="PHP安全编码。验证过滤用户的输入即使是最普通的字母数字输入也可能是危险的，列举几个容易引起安全问题的字符：在数据库中可能有特殊意义的字符：还有一些非打印字符：字符\x00或者说ASCII 0，NULL或FALSE字符\x10和\x13，或者说ASCII 10和13，\n \r字符\x1a或者说ASCII 26，表示文件的结束输入错误的参数类型，也可能导致程序出现意想不到的错误。输入过多的参数值，可能导致溢出等错误。" />
<meta name="keywords" content="PHP安全编码" />



<meta name="baidu-site-verification" content="GSIJv096Bu" />



<meta name="generator" content="Hugo 0.82.0" />


<link rel="canonical" href="https://lcx.cc/post/3580/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.af20b78e95c84de86b00a0242a4a77bd2601700e1b250edf27537d957ac0041d.css" integrity="sha256-ryC3jpXITehrAKAkKkp3vSYBcA4bJQ7fJ1N9lXrABB0=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="PHP安全编码" />
<meta property="og:description" content="PHP安全编码。验证过滤用户的输入即使是最普通的字母数字输入也可能是危险的，列举几个容易引起安全问题的字符：在数据库中可能有特殊意义的字符：还有一些非打印字符：字符\x00或者说ASCII 0，NULL或FALSE字符\x10和\x13，或者说ASCII 10和13，\n \r字符\x1a或者说ASCII 26，表示文件的结束输入错误的参数类型，也可能导致程序出现意想不到的错误。输入过多的参数值，可能导致溢出等错误。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lcx.cc/post/3580/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2013-06-17T16:07:33&#43;08:00" />
<meta property="article:modified_time" content="2013-06-17T16:23:38&#43;08:00" />

<meta itemprop="name" content="PHP安全编码">
<meta itemprop="description" content="PHP安全编码。验证过滤用户的输入即使是最普通的字母数字输入也可能是危险的，列举几个容易引起安全问题的字符：在数据库中可能有特殊意义的字符：还有一些非打印字符：字符\x00或者说ASCII 0，NULL或FALSE字符\x10和\x13，或者说ASCII 10和13，\n \r字符\x1a或者说ASCII 26，表示文件的结束输入错误的参数类型，也可能导致程序出现意想不到的错误。输入过多的参数值，可能导致溢出等错误。"><meta itemprop="datePublished" content="2013-06-17T16:07:33&#43;08:00" />
<meta itemprop="dateModified" content="2013-06-17T16:23:38&#43;08:00" />
<meta itemprop="wordCount" content="4694">
<meta itemprop="keywords" content="PHP,安全,编码,app,Ascii,exe,EXP,Html,IE,IP,Mysql,POS,Shell,SQL,URL,查询,程序,代码,攻击,函数,脚本,命令,绕过,上传,数据,数据库,图片,文件,问题,系统,注入," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="PHP安全编码"/>
<meta name="twitter:description" content="PHP安全编码。验证过滤用户的输入即使是最普通的字母数字输入也可能是危险的，列举几个容易引起安全问题的字符：在数据库中可能有特殊意义的字符：还有一些非打印字符：字符\x00或者说ASCII 0，NULL或FALSE字符\x10和\x13，或者说ASCII 10和13，\n \r字符\x1a或者说ASCII 26，表示文件的结束输入错误的参数类型，也可能导致程序出现意想不到的错误。输入过多的参数值，可能导致溢出等错误。"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Nuclear'Atk</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/post/">归档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/categories/">分类</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/">友链</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%85%B3%E4%BA%8E/">关于</a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      Nuclear'Atk
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/post/">归档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/categories/">分类</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/">友链</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%85%B3%E4%BA%8E/">关于</a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">PHP安全编码</h1>
      
      <div class="post-meta">
        <time datetime="2013-06-17" class="post-time">
          2013-06-17
        </time>
        <div class="post-category">
            <a href="https://lcx.cc/categories/%E8%80%81%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AE%B9/"> 老系统内容 </a>
            <a href="https://lcx.cc/categories/php/"> PHP </a>
            <a href="https://lcx.cc/categories/%E5%AE%89%E5%85%A8/"> 安全 </a>
            <a href="https://lcx.cc/categories/%E7%BC%96%E7%A0%81/"> 编码 </a>
            
          </div>
        <span class="more-meta"> 约 4694 字 </span>
          <span class="more-meta"> 预计阅读 10 分钟 </span>

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    
  </div>
</div>

    
    <div class="post-content">
      
<p style="text-indent:2em;">
	2013/06/03 18:56 | 瞌睡龙
</p>
<p>
	<strong>验证过滤用户的输入</strong> 
</p>
<p style="text-indent:2em;">
	即使是最普通的字母数字输入也可能是危险的，列举几个容易引起安全问题的字符：
</p>
<pre class="prettyprint">! $ ^ &amp; * ( ) ~ [ ] \ | { } ' " ; &lt; &gt; ? - `</pre>
<p style="text-indent:2em;">
	在数据库中可能有特殊意义的字符：
</p>
<pre class="prettyprint">' " ; \</pre>
<p style="text-indent:2em;">
	还有一些非打印字符：
</p>
<p style="text-indent:2em;">
	字符\x00或者说ASCII 0，NULL或FALSE
</p>
<p style="text-indent:2em;">
	字符\x10和\x13，或者说ASCII 10和13，\n \r
</p>
<p style="text-indent:2em;">
	字符\x1a或者说ASCII 26，表示文件的结束
</p>
<p style="text-indent:2em;">
	输入错误的参数类型，也可能导致程序出现意想不到的错误。
</p>
<p style="text-indent:2em;">
	输入过多的参数值，可能导致溢出等错误。
</p>
<p>
	<strong>PHP中验证用户的输入</strong> 
</p>
<p style="text-indent:2em;">
	这里特别要注意php.ini中的register_globals的设定，在早期的php版本中是默认开启的，这会导致很严重的安全问题：
</p>
<pre class="prettyprint lang-php">&lt;?php
// set admin flag
if ($auth-&gt;isAdmin()) {
$admin = TRUE;
}
// ...
if ($admin) {
// do administrative tasks
}
?&gt;</pre>
<p style="text-indent:2em;">
	上面这段代码看起来是安全的，但是如果register_globals开启了的话，在访问的url中加入?admin=1即可绕过前半部分的逻辑判断。
</p>
<p style="text-indent:2em;">
	更安全的代码应该给$admin赋默认FALSE值：
</p>
<pre class="prettyprint lang-php">&lt;?php
// create then set admin flag
$admin = FALSE;
if ($auth-&gt;isAdmin()) {
    $admin = TRUE;
}
// ...
if ($admin) {
    // do administrative tasks
}
?&gt;</pre>
<p style="text-indent:2em;">
	早期人们开发调试的时候发现使用register_globals有极大的便利，所以早期的php版本中默认开启。
</p>
<p style="text-indent:2em;">
	但是随着越来越多的安全问题，从php 4.2.0开始，register_globals变为了默认关闭。
</p>
<p style="text-indent:2em;">
	当你发现register_globals是on的时候，你可能会在脚本当中加入如下代码使其关闭：
</p>
<pre class="prettyprint lang-php">ini_set('register_globals', 0);</pre>
<p style="text-indent:2em;">
	但实际上，当所有的全局变量已经创建了之后，以上代码并不会起到作用。
</p>
<p style="text-indent:2em;">
	但是你可以在文档的根目录下的.htaccess的文件中加上下面这一行：
</p>
<pre class="prettyprint">php_flag register_globals 0</pre>
<p style="text-indent:2em;">
	变量声明：强烈建议总是事先声明变量。
</p>
<p style="text-indent:2em;">
	检查输入的类型，长度和格式：
</p>
<p style="text-indent:2em;">
	字符串检查：在PHP中，字符串几乎可以是任何事情，但有些值并不是严格的字符串类型，可以用is_string()函数来确定。
</p>
<p style="text-indent:2em;">
	有些时候你不介意数字作为字符串，可以用empty()函数。
</p>
<p style="text-indent:2em;">
	数字类型检查：使用is_int()函数或者is_integer()或is_long()，例如：
</p>
<pre class="prettyprint lang-php">$year = $_POST['year'];
if (!is_int($year))
exit("$year is an invalid value for year!");</pre>
<p style="text-indent:2em;">
	也可以使用gettype()函数判断类型后做处理：
</p>
<pre class="prettyprint lang-php">if (gettype($year) != 'integer') {
exit("$year is an invalid value for year!");
}</pre>
<p style="text-indent:2em;">
	至少还有三种方式可以吧$year变量转变为整数：
</p>
<pre class="prettyprint lang-php">$year = intval($_POST['year']);
$year = ( int ) $_POST['year'];
if (!settype($year, 'integer')) {exit("$year is an invalid value for year!");}</pre>
<p style="text-indent:2em;">
	如果允许浮点型与零的值，可以使用is_numeric()函数来做判断。 判断一个值是否为布尔型的时候使用is_bool()函数。
</p>
<p style="text-indent:2em;">
	下表是对各种类型变量使用各函数判断的结果：
</p>
<p style="text-indent:2em;">
	<img title="PHP安全编码" alt="PHP安全编码" src="/file/old/2385_table1.jpg" width="780" height="407" /> 
</p>
<p style="text-indent:2em;">
	检查字符串的长度使用strlen()变量：
</p>
<pre class="prettyprint lang-php">if (strlen($year) != 4)
    exit("$year is an invalid value for year!");</pre>
<p style="text-indent:2em;">
	概括总结一下PHP中类型，长度，格式等验证：
</p>
<pre class="prettyprint lang-php">&lt;?php
// set up array of expected values and types
$expected = array(
    'carModel' =&gt; 'string',
    'year' =&gt; 'int',
    'imageLocation' =&gt; 'filename'
);
// check each input value for type and length
foreach ($expected AS $key =&gt; $type) {
    if (empty($_GET[$key])) {
        ${$key} = NULL;
        continue;
    }
    switch ($type) {
        case 'string':
            if (is_string($_GET[$key]) &amp;&amp; strlen($_GET[$key]) &lt; 256) {
                ${$key} = $_GET[$key];
            }
            break;
        case 'int':
            if (is_int($_GET[$key])) {
                ${$key} = $_GET[$key];
            }
            break;
        case 'filename':
            // limit filenames to 64 characters
            if (is_string($_GET[$key]) &amp;&amp; strlen($_GET[$key]) &lt; 64) {
                // escape any non-ASCII
                ${$key} = str_replace('%', '_', rawurlencode($_GET[$key]));
                // disallow double dots
                if (strpos(${$key}, '..') === TRUE) {
                    ${$key} = NULL;
                }
            }
            break;
    }
    if (!isset(${$key})) {
        ${$key} = NULL;
    }
}
// use the now-validated input in your application</pre>
<p style="text-indent:2em;">
	对于一些可能有害的字符，可以用如下的几种方式进行保护：
</p>
<ul>
	<li>
		<p>
			使用 \ 对其进行转义。
		</p>
	</li>
	<li>
		<p>
			使用引号把他引起来。
		</p>
	</li>
	<li>
		<p>
			使用%nn的方式编码，如urlencode()函数。
		</p>
	</li>
</ul>
<p style="text-indent:2em;">
	可以尝试在php.ini中开启magic_quotes_gpc，这样对于所有由用户GET、POST、COOKIE中传入的特殊字符都会转义。
</p>
<p style="text-indent:2em;">
	也可是使用addslashes()函数，但是开启magic_quotes_gpc所造成的影响可能远超过益处。
</p>
<p style="text-indent:2em;">
	addslashes()也只对最常见的四个字符做了转义：单引号、双引号、反斜线、空字符。
</p>
<p style="text-indent:2em;">
	同时为了使数据还原，需要使用stripslashes()函数，也可能破坏一些多字节的转义。
</p>
<p style="text-indent:2em;">
	推荐使用mysql_real_escape_string()函数，虽然只是用来设计转义插入数据库的数据，但是他能转义更多的字符。
</p>
<p style="text-indent:2em;">
	如：NULL、\x00、\n、\r、\、'、"和\x1a。使用用例：
</p>
<pre class="prettyprint lang-php">&lt;?php
$expected = array(
    'carModel',
    'year',
    'bodyStyle'
);
foreach ($expected AS $key) {
    if (!empty($_GET[$key])) {
        ${$key} = mysql_real_escape_string($_GET[$key]);
    }
}
?&gt;</pre>
<p style="text-indent:2em;">
	使用mysql_real_escape_string()函数也不是万能的，转义一些并非是要写入mysql的数据库的数据可能不会产生作用或者出现错误。
</p>
<p style="text-indent:2em;">
	可以根据自己的实际需要，自己使用str_replace()函数写一个针对特殊字符的转义。
</p>
<p>
	<strong>对于文件的路径与名称的过滤</strong> 
</p>
<p style="text-indent:2em;">
	文件名中不能包含二进制数据，否则可能引起问题。
</p>
<p style="text-indent:2em;">
	一些系统允许Unicode多字节编码的文件名，但是尽量避免，应当使用ASCII的字符。
</p>
<p style="text-indent:2em;">
	虽然Unix系统几乎可以在文件名设定中使用任何符号，但是应当尽量使用 - 和 _ 避免使用其他字符。
</p>
<p style="text-indent:2em;">
	同时需要限定文件名的长度。
</p>
<p style="text-indent:2em;">
	php中的文件操作通常使用fopen()函数与file_get_contents()函数。
</p>
<pre class="prettyprint lang-php">&lt;?php
$applicationPath = '/home/www/myphp/code/';
$scriptname      = $_POST['scriptname'];
highlight_file($applicationPath . $scriptname);
?&gt;</pre>
<p style="text-indent:2em;">
	上面代码的问题在于用户POST输入的scriptname没有做任何过滤，如果用户输入../../../../etc/passwd，则有可能读取到系统的passwd文件。
</p>
<pre class="prettyprint lang-php">&lt;?php
$uri = $_POST['uri'];
if (strpos($uri, '..'))
    exit('That is not a valid URI.');
$importedData = file_get_contents($uri);</pre>
<p style="text-indent:2em;">
	如果发现 .. 字符串就不执行会不会出现问题呢？如果前面并没有路径限制的话，仍然会出现问题：
</p>
<p style="text-indent:2em;">
	使用file协议，当用户输入file:///etc/passwd的时候，会把passwd的内容带入$importedData变量中。
</p>
<p>
	<strong>防止SQL注入</strong> 
</p>
<p style="text-indent:2em;">
	<strong>SQL注入是如何产生的：</strong> 
</p>
<p style="text-indent:2em;">
	1、接收一个由用户提交的变量，假设变量为$variety：
</p>
<pre class="prettyprint lang-php">$variety = $_POST['variety'];</pre>
<p style="text-indent:2em;">
	2、接收的变量带入构造一个数据库查询语句：
</p>
<pre class="prettyprint lang-php">$query = "SELECT * FROM wines WHERE variety='$variety'";</pre>
<p style="text-indent:2em;">
	3、把构造好的语句提交给MySQL服务器查询，MySQL返回查询结果。
</p>
<p style="text-indent:2em;">
	当由用户输入lagrein' or 1=1#时，产生的结果将会完全不同。
</p>
<p style="text-indent:2em;">
	<strong>防止SQL注入的几种方式：</strong> 
</p>
<p style="text-indent:2em;">
	检查用户输入的类型，当用户输入的为数字时可以使用如下方式：
</p>
<p style="text-indent:2em;">
	使用is_int()函数（或is_integer()或is_long()函数）
</p>
<p style="text-indent:2em;">
	使用gettype()函数
</p>
<p style="text-indent:2em;">
	使用intval()函数
</p>
<p style="text-indent:2em;">
	使用settype()函数
</p>
<p style="text-indent:2em;">
	检查用户输入字符串的长度使用strlen()函数。
</p>
<p style="text-indent:2em;">
	检查日期或时间是否是有效的，可以使用strtotime()函数
</p>
<p style="text-indent:2em;">
	对于一个已经存在的程序来说，可以写一个通用函数来过滤：
</p>
<pre class="prettyprint lang-php">function safe($string)
{
    return "'" . mysql_real_escape_string($string) . "'";
}</pre>
<p style="text-indent:2em;">
	调用方式：
</p>
<pre class="prettyprint lang-php">$variety = safe($_POST['variety']);
$query = "SELECT * FROM wines WHERE variety=" . $variety;</pre>
<p style="text-indent:2em;">
	对于一个刚开始写的程序，应当设计的更安全一些，PHP5中，增加了MySQL支持，提供了mysqli扩展：
</p>
<p style="text-indent:2em;">
	PHP手册地址：<a href="http://php.net/mysqli" target="_blank">http://php.net/mysqli</a> 
</p>
<pre class="prettyprint lang-php">&lt;?php
// retrieve the user's input
$animalName = $_POST['animalName'];
// connect to the database
$connect    = mysqli_connect('localhost', 'username', 'password', 'database');
if (!$connect)
    exit('connection failed:  ' . mysqli_connect_error());
// create a query statement resource
$stmt = mysqli_prepare($connect, "SELECT intelligence FROM animals WHERE name = ?");
if ($stmt) {
    // bind the substitution to the statement
    mysqli_stmt_bind_param($stmt, "s", $animalName);
    // execute the statement
    mysqli_stmt_execute($stmt);
    // retrieve the result...
    mysqli_stmt_bind_result($stmt, $intelligence);
    // ...and display it
    if (mysqli_stmt_fetch($stmt)) {
        print "A $animalName has $intelligence intelligence.\n";
    } else {
        print 'Sorry, no records found.';
    }
    // clean up statement resource
    mysqli_stmt_close($stmt);
}
mysqli_close($connect);
?&gt;</pre>
<p style="text-indent:2em;">
	mysqli扩展提供了所有的查询功能。
</p>
<p style="text-indent:2em;">
	mysqli扩展也提供了面向对象的版本：
</p>
<pre class="prettyprint lang-php">&lt;?php
$animalName = $_POST['animalName'];
$mysqli     = new mysqli('localhost', 'username', 'password', 'database');
if (!$mysqli)
    exit('connection failed:  ' . mysqli_connect_error());
$stmt = $mysqli-&gt;prepare("SELECT intelligence FROM animals WHERE name = ?");
if ($stmt) {
    $stmt-&gt;bind_param("s", $animalName);
    $stmt-&gt;execute();
    $stmt-&gt;bind_result($intelligence);
    if ($stmt-&gt;fetch()) {
        print "A $animalName has $intelligence intelligence.\n";
    } else {
        print 'Sorry, no records found.';
    }
    $stmt-&gt;close();
}
$mysqli-&gt;close();
?&gt;</pre>
<p>
	<strong>防止XSS攻击</strong> 
</p>
<p style="text-indent:2em;">
	xss攻击一个常用的方法就是注入HTML元素执行js脚本，php中已经内置了一些防御的函数（如htmlentities或者htmlspecialchars）：
</p>
<pre class="prettyprint lang-php">&lt;?php
function safe($value)
{
    htmlentities($value, ENT_QUOTES, 'utf-8');
    // other processing
    return $value;
}
// retrieve $title and $message from user input
$title   = $_POST['title'];
$message = $_POST['message'];
// and display them safely
print '&lt;h1&gt;' . safe($title) . '&lt;/h1&gt;
       &lt;p&gt;' . safe($message) . '&lt;/p&gt;';
?&gt;</pre>
<p style="text-indent:2em;">
	<strong>过滤用户提交的URL</strong> 
</p>
<p style="text-indent:2em;">
	如果允许用户输入一个URL用来调用一个图片或者链接，你需要保证他不传入javascript:或者vbscript:或data:等非http协议。
</p>
<p style="text-indent:2em;">
	可以使用php的内置函数parse_url()函数来分割URL，然后做判断。
</p>
<p style="text-indent:2em;">
	设置允许信任的域：
</p>
<pre class="prettyprint lang-php">&lt;?php
$trustedHosts      = array(
    'example.com',
    'another.example.com'
);
$trustedHostsCount = count($trustedHosts);
function safeURI($value)
{
    $uriParts = parse_url($value);
    for ($i = 0; $i &lt; $trustedHostsCount; $i++) {
        if ($uriParts['host'] === $trustedHosts[$i]) {
            return $value;
        }
    }
    $value .= ' [' . $uriParts['host'] . ']';
    return $value;
}
// retrieve $uri from user input
$uri = $_POST['uri'];
// and display it safely
echo safeURI($uri);
?&gt;</pre>
<p style="text-indent:2em;">
	<strong>防止远程执行</strong> 
</p>
<p style="text-indent:2em;">
	远程执行通常是使用了php代码执行如eval()函数，或者是调用了命令执行如exec()，passthru()，proc_open()，shell_exec()，system()或popen()。
</p>
<p style="text-indent:2em;">
	<strong>注入php代码：</strong> 
</p>
<p style="text-indent:2em;">
	php为开发者提供了非常多的方法可以来调用允许php脚本，我们就需要注意对用户可控的数据进行过滤。
</p>
<p style="text-indent:2em;">
	<strong>调用的几种方式：</strong> 
</p>
<p style="text-indent:2em;">
	include()和require()函数，eval()函数，preg_replace()采用e模式调用，编写脚本模板。
</p>
<pre class="prettyprint lang-php">&lt;?php
print Hello . world;
?&gt;</pre>
<p style="text-indent:2em;">
	上面代码将会输出Helloworld，php在解析的时候会检查是否存在一个名为Hello的函数。
</p>
<p style="text-indent:2em;">
	如果没有找到的话，他会自己创建一个并把它的名字作为它的值，world也是一样。
</p>
<p style="text-indent:2em;">
	上传文件中嵌入php代码：
</p>
<p style="text-indent:2em;">
	攻击者可以上传一个看似很普通的图片，PDF等，但是实际上呢？
</p>
<p style="text-indent:2em;">
	linux下可以使用如下命令插入php代码进入图片中：
</p>
<pre class="prettyprint">$ echo '&lt;?php phpinfo();?&gt;' &gt;&gt; locked.gif</pre>
<p style="text-indent:2em;">
	把<?php phpinfo();?>代码插入到了locked.gif图片中。
</p>
<p style="text-indent:2em;">
	并且此时用file命令查看文件格式仍为图片：
</p>
<pre class="prettyprint">$ file -i locked.giflocked.gif: image/gif</pre>
<p style="text-indent:2em;">
	任何的图像编辑或图像处理的程序包括PHP的getimagesize()函数，都会认为它是一个GIF图像。
</p>
<p style="text-indent:2em;">
	但是当你使用cat命令查看图片时，可以看到图片末尾的<?php phpinfo();?>
</p>
<p style="text-indent:2em;">
	当把图片的后缀改为php或者已php的方式解析时，插入的phpinfo()函数便会执行。
</p>
<p style="text-indent:2em;">
	<strong>Shell命令执行</strong> 
</p>
<p style="text-indent:2em;">
	PHP提供了一些可以直接执行系统命令的函数，如exec()函数或者 `（反引号）。
</p>
<p style="text-indent:2em;">
	PHP的安全模式会提供一些保护，但是也有一些方式可以绕过安全模式：
</p>
<p style="text-indent:2em;">
	1、上传一个Perl脚本，或者Python或Ruby等，服务器支持的环境，来执行其他语言的脚本可绕过PHP的安全模式。
</p>
<p style="text-indent:2em;">
	2、利用系统的缓冲溢出漏洞，绕过安全模式。
</p>
<p style="text-indent:2em;">
	下表列出了跟Shell相关的一些字符：
</p>
<table style="width:90%;" align="center">
	<thead>
		<tr>
			<td>
				名称
			</td>
			<td>
				字符
			</td>
			<td>
				ASCII
			</td>
			<td>
				16进制
			</td>
			<td>
				URL编码
			</td>
			<td>
				HTML编码
			</td>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>
				换行
			</td>
			<td>
			</td>
			<td>
				10
			</td>
			<td>
				\x0a
			</td>
			<td>
				%0a
			</td>
			<td>
				&amp;#10
			</td>
		</tr>
		<tr>
			<td>
				感叹号
			</td>
			<td>
				!
			</td>
			<td>
				33
			</td>
			<td>
				\x21
			</td>
			<td>
				%21
			</td>
			<td>
				&amp;#33
			</td>
		</tr>
		<tr>
			<td>
				双引号
			</td>
			<td>
				"
			</td>
			<td>
				34
			</td>
			<td>
				\x22
			</td>
			<td>
				%22
			</td>
			<td>
				&amp;#34或&amp;quot
			</td>
		</tr>
		<tr>
			<td>
				美元符号
			</td>
			<td>
				$
			</td>
			<td>
				36
			</td>
			<td>
				\x24
			</td>
			<td>
				%24
			</td>
			<td>
				&amp;#36
			</td>
		</tr>
		<tr>
			<td>
				连接符
			</td>
			<td>
				&amp;
			</td>
			<td>
				38
			</td>
			<td>
				\x26
			</td>
			<td>
				%26
			</td>
			<td>
				&amp;#38或&amp;#amp
			</td>
		</tr>
		<tr>
			<td>
				单引号
			</td>
			<td>
				'
			</td>
			<td>
				39
			</td>
			<td>
				\x27
			</td>
			<td>
				%27
			</td>
			<td>
				&amp;#39
			</td>
		</tr>
		<tr>
			<td>
				左括号
			</td>
			<td>
				(
			</td>
			<td>
				40
			</td>
			<td>
				\x28
			</td>
			<td>
				%28
			</td>
			<td>
				&amp;#40
			</td>
		</tr>
		<tr>
			<td>
				右括号
			</td>
			<td>
				)
			</td>
			<td>
				41
			</td>
			<td>
				\x29
			</td>
			<td>
				%29
			</td>
			<td>
				&amp;#41
			</td>
		</tr>
		<tr>
			<td>
				星号
			</td>
			<td>
				*
			</td>
			<td>
				42
			</td>
			<td>
				\x2a
			</td>
			<td>
				%2a
			</td>
			<td>
				&amp;#42
			</td>
		</tr>
		<tr>
			<td>
				连字符号
			</td>
			<td>
				-
			</td>
			<td>
				45
			</td>
			<td>
				\x2d
			</td>
			<td>
				%2d
			</td>
			<td>
				&amp;#45
			</td>
		</tr>
		<tr>
			<td>
				分号
			</td>
			<td>
				;
			</td>
			<td>
				59
			</td>
			<td>
				\x3b
			</td>
			<td>
				%3b
			</td>
			<td>
				&amp;#59
			</td>
		</tr>
		<tr>
			<td>
				左尖括号
			</td>
			<td>
				&lt;
			</td>
			<td>
				60
			</td>
			<td>
				\x3c
			</td>
			<td>
				%3c
			</td>
			<td>
				&amp;#60
			</td>
		</tr>
		<tr>
			<td>
				右尖括号
			</td>
			<td>
				&gt;
			</td>
			<td>
				62
			</td>
			<td>
				\x3e
			</td>
			<td>
				%3e
			</td>
			<td>
				&amp;#62
			</td>
		</tr>
		<tr>
			<td>
				问号
			</td>
			<td>
				?
			</td>
			<td>
				63
			</td>
			<td>
				\x3f
			</td>
			<td>
				%3f
			</td>
			<td>
				&amp;#63
			</td>
		</tr>
		<tr>
			<td>
				左方括号
			</td>
			<td>
				[
			</td>
			<td>
				91
			</td>
			<td>
				\x5b
			</td>
			<td>
				%5b
			</td>
			<td>
				&amp;#91
			</td>
		</tr>
		<tr>
			<td>
				反斜线
			</td>
			<td>
				\
			</td>
			<td>
				92
			</td>
			<td>
				\x5c
			</td>
			<td>
				%5c
			</td>
			<td>
				&amp;#92
			</td>
		</tr>
		<tr>
			<td>
				右方括号
			</td>
			<td>
				]
			</td>
			<td>
				93
			</td>
			<td>
				\x5d
			</td>
			<td>
				%5d
			</td>
			<td>
				&amp;#93
			</td>
		</tr>
		<tr>
			<td>
				插入符
			</td>
			<td>
				^
			</td>
			<td>
				94
			</td>
			<td>
				\x5e
			</td>
			<td>
				%5e
			</td>
			<td>
				&amp;#94
			</td>
		</tr>
		<tr>
			<td>
				反引号
			</td>
			<td>
				`
			</td>
			<td>
				96
			</td>
			<td>
				\x60
			</td>
			<td>
				%60
			</td>
			<td>
				&amp;#96
			</td>
		</tr>
		<tr>
			<td>
				左花括号
			</td>
			<td>
				{
			</td>
			<td>
				123
			</td>
			<td>
				\x7b
			</td>
			<td>
				%7b
			</td>
			<td>
				&amp;#123
			</td>
		</tr>
		<tr>
			<td>
				管道符
			</td>
			<td>
				|
			</td>
			<td>
				124
			</td>
			<td>
				\x7c
			</td>
			<td>
				%7c
			</td>
			<td>
				&amp;#124
			</td>
		</tr>
		<tr>
			<td>
				右花括号
			</td>
			<td>
				}
			</td>
			<td>
				125
			</td>
			<td>
				\x7d
			</td>
			<td>
				%7d
			</td>
			<td>
				&amp;#125
			</td>
		</tr>
		<tr>
			<td>
				波浪号
			</td>
			<td>
				~
			</td>
			<td>
				126
			</td>
			<td>
				\x7e
			</td>
			<td>
				%7e
			</td>
			<td>
				&amp;#126
			</td>
		</tr>
	</tbody>
</table>
<p style="text-indent:2em;">
	如下PHP脚本：
</p>
<pre class="prettyprint lang-php">&lt;?php
// get the word count of the requested file
$filename = $_GET['filename'];
$command  = "/usr/bin/wc $filename";
$words    = shell_exec($command);
print "$filename contains $words words.";
?&gt;</pre>
<p style="text-indent:2em;">
	用户可以输入如下的URL来攻击读取passwd文件：
</p>
<pre class="prettyprint">wordcount.php?filename=%2Fdev%2Fnull%20%7C%20cat%20-%20%2Fetc%2Fpasswd</pre>
<p style="text-indent:2em;">
	字符串拼接之后，将会执行 /usr/bin/wc /dev/null | cat - /etc/passwd这条命令
</p>
<p style="text-indent:2em;">
	如果能够不适用命令执行函数与eval()函数，可以在php.ini中禁止：disable_functions = "eval,phpinfo"
</p>
<p style="text-indent:2em;">
	PHP中还有一个preg_replace()函数，可能引起代码执行漏洞。
</p>
<pre class="prettyprint">mixed preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, int $limit ] )</pre>
<p style="text-indent:2em;">
	在 subject 中搜索 pattern 模式的匹配项并替换为 replacement 。如果指定了 limit ，则仅替换 limit 个匹配。
</p>
<p style="text-indent:2em;">
	如果省略 limit 或者其值为 -1，则所有的匹配项都会被替换。
</p>
<p style="text-indent:2em;">
	特别注意：
</p>
<p style="text-indent:2em;">
	/e 修正符使 preg_replace() 将 replacement 参数当作 PHP 代码（在适当的逆向引用替换完之后）。
</p>
<p style="text-indent:2em;">
	提示：要确保 replacement 构成一个合法的 PHP 代码字符串，否则 PHP 会在报告在包含 preg_replace() 的行中出现语法解析错误。
</p>
<pre class="prettyprint lang-php">&lt;?php
function test($str)
{
    //......
    //......
    return $str;
}
echo preg_replace("/\s*\[p hp language=""](.+?)\[\/php\]\s*/ies", 'test("\1")', $_GET["h"]);
?&gt;</pre>
<p style="text-indent:2em;">
	当用户输入
</p>
<pre class="prettyprint">?h=[p hp]phpinfo()[/php]</pre>
<p style="text-indent:2em;">
	经过正则匹配后， replacement 参数变为'test("phpinfo()")'，
</p>
<p style="text-indent:2em;">
	此时phpinfo仅是被当做一个字符串参数了。
</p>
<p style="text-indent:2em;">
	但是当我们提交
</p>
<pre class="prettyprint">?h=[p hp]{${phpinfo()}}[/php]</pre>
<p style="text-indent:2em;">
	时，phpinfo()就会被执行。
</p>
<p style="text-indent:2em;">
	在php中，双引号里面如果包含有变量，php解释器会将其替换为变量解释后的结果；单引号中的变量不会被处理。
</p>
<p style="text-indent:2em;">
	注意：双引号中的函数不会被执行和替换。
</p>
<p style="text-indent:2em;">
	在这里我们需要通过{${}}构造出了一个特殊的变量，'test("{${phpinfo()}}")'，达到让函数被执行的效果 ${phpinfo()} 会被解释执行。
</p>
<p style="text-indent:2em;">
	<a href="http://drops.wooyun.org/tips/135" target="_blank">[原文地址]</a> 
</p>
    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">瞌睡龙</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2013-06-17
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a href="https://lcx.cc/" target="_blank">Nuclear'Atk（核攻击）网络安全实验室</a>版权所有，转载请注明出处。</span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://lcx.cc/tags/php/">PHP</a>
          <a href="https://lcx.cc/tags/%E5%AE%89%E5%85%A8/">安全</a>
          <a href="https://lcx.cc/tags/%E7%BC%96%E7%A0%81/">编码</a>
          <a href="https://lcx.cc/tags/app/">app</a>
          <a href="https://lcx.cc/tags/ascii/">Ascii</a>
          <a href="https://lcx.cc/tags/exe/">exe</a>
          <a href="https://lcx.cc/tags/exp/">EXP</a>
          <a href="https://lcx.cc/tags/html/">Html</a>
          <a href="https://lcx.cc/tags/ie/">IE</a>
          <a href="https://lcx.cc/tags/ip/">IP</a>
          <a href="https://lcx.cc/tags/mysql/">Mysql</a>
          <a href="https://lcx.cc/tags/pos/">POS</a>
          <a href="https://lcx.cc/tags/shell/">Shell</a>
          <a href="https://lcx.cc/tags/sql/">SQL</a>
          <a href="https://lcx.cc/tags/url/">URL</a>
          <a href="https://lcx.cc/tags/%E6%9F%A5%E8%AF%A2/">查询</a>
          <a href="https://lcx.cc/tags/%E7%A8%8B%E5%BA%8F/">程序</a>
          <a href="https://lcx.cc/tags/%E4%BB%A3%E7%A0%81/">代码</a>
          <a href="https://lcx.cc/tags/%E6%94%BB%E5%87%BB/">攻击</a>
          <a href="https://lcx.cc/tags/%E5%87%BD%E6%95%B0/">函数</a>
          <a href="https://lcx.cc/tags/%E8%84%9A%E6%9C%AC/">脚本</a>
          <a href="https://lcx.cc/tags/%E5%91%BD%E4%BB%A4/">命令</a>
          <a href="https://lcx.cc/tags/%E7%BB%95%E8%BF%87/">绕过</a>
          <a href="https://lcx.cc/tags/%E4%B8%8A%E4%BC%A0/">上传</a>
          <a href="https://lcx.cc/tags/%E6%95%B0%E6%8D%AE/">数据</a>
          <a href="https://lcx.cc/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>
          <a href="https://lcx.cc/tags/%E5%9B%BE%E7%89%87/">图片</a>
          <a href="https://lcx.cc/tags/%E6%96%87%E4%BB%B6/">文件</a>
          <a href="https://lcx.cc/tags/%E9%97%AE%E9%A2%98/">问题</a>
          <a href="https://lcx.cc/tags/%E7%B3%BB%E7%BB%9F/">系统</a>
          <a href="https://lcx.cc/tags/%E6%B3%A8%E5%85%A5/">注入</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/3581/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">sqlmap用户手册</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/3579/">
            <span class="next-text nav-default">waf 绕过的技巧，SQL 注入中绕过 waf 的技巧</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:root@lcx.cc" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="linkedin"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="33" height="33">
  <path d="M872.405333 872.618667h-151.637333v-237.610667c0-56.661333-1.152-129.578667-79.018667-129.578667-79.061333 0-91.136 61.653333-91.136 125.397334v241.792H398.976V384h145.664v66.602667h1.962667c20.352-38.4 69.845333-78.933333 143.786666-78.933334 153.642667 0 182.058667 101.12 182.058667 232.746667v268.202667zM227.712 317.141333a87.978667 87.978667 0 0 1-88.021333-88.106666 88.064 88.064 0 1 1 88.021333 88.106666z m76.032 555.477334H151.68V384h152.064v488.618667zM948.266667 0H75.562667C33.792 0 0 33.024 0 73.770667v876.458666C0 991.018667 33.792 1024 75.562667 1024h872.576C989.866667 1024 1024 991.018667 1024 950.229333V73.770667C1024 33.024 989.866667 0 948.138667 0h0.128z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="weibo"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M385.714286 733.714286q12-19.428571 6.285714-39.428571t-25.714286-28.571429q-19.428571-8-41.714286-0.571429t-34.285714 26.285714q-12.571429 19.428571-7.428571 39.142857t24.571429 28.857143 42.571429 1.428571 35.714286-27.142857zm53.714286-69.142857q4.571429-7.428571 2-15.142857t-10-10.571429q-8-2.857143-16.285714 2.857143t-12.285714 10.571429q-9.714286 17.714286 7.428571 25.714286 8 2.857143 16.571429 2.857143t12.571429-10.571429zm99.428571 61.142857q-25.714286 58.285714-90.285714 85.714286t-128 6.857143q-61.142857-19.428571-84.285714-72.285714t3.714286-107.142857q26.857143-53.142857 86.571429-79.428571t120.285714-10.857143q63.428571 16.571429 90.571429 68.285714t1.428571 108.857143zm178.285714-91.428571q-5.142857-54.857143-50.857143-97.142857t-119.142857-62.285714-156.857143-12q-127.428571 13.142857-211.142857 80.857143t-75.714286 151.142857q5.142857 54.857143 50.857143 97.142857t119.142857 62.285714 156.857143 12q127.428571-13.142857 211.142857-80.857143t75.714286-151.142857zm176 2.285714q0 38.857143-21.142857 79.714286t-62.285714 78.285714-96.285714 67.142857-129.142857 47.428571-154.571429 17.714286-157.142857-19.142857-137.428571-53.142857-98-86.285714-37.142857-114q0-65.714286 39.714286-140t112.857143-147.428571q96.571429-96.571429 195.142857-134.857143t140.857143 4q37.142857 36.571429 11.428571 119.428571-2.285714 8-0.571429 11.428571t5.714286 4 8.285714 2.857143 7.714286-2l3.428571-1.142857q79.428571-33.714286 140.571429-33.714286t87.428571 34.857143q25.714286 36 0 101.714286-1.142857 7.428571-2.571429 11.428571t2.571429 7.142857 6.857143 4.285714 9.714286 3.428571q32.571429 10.285714 58.857143 26.857143t45.714286 46.571429 19.428571 66.571429zm-42.285714-356.571429q24 26.857143 31.142857 62t-3.714286 67.142857q-4.571429 13.142857-16.857143 19.428571t-25.428571 2.285714q-13.142857-4.571429-19.428571-16.857143t-2.285714-25.428571q11.428571-36-13.714286-63.428571t-61.142857-20q-13.714286 2.857143-25.714286-4.571429t-14.285714-21.142857q-2.857143-13.714286 4.571429-25.428571t21.142857-14.571429q34.285714-7.428571 68 3.142857t57.714286 37.428571zm103.428571-93.142857q49.714286 54.857143 64.285714 127.142857t-7.714286 138q-5.142857 15.428571-19.428571 22.857143t-29.714286 2.285714-22.857143-19.428571-2.857143-29.714286q16-46.857143 5.714286-98.285714t-45.714286-90.285714q-35.428571-39.428571-84.571429-54.571429t-98.857143-4.857143q-16 3.428571-29.714286-5.428571t-17.142857-24.857143 5.428571-29.428571 24.857143-16.857143q70.285714-14.857143 139.428571 6.571429t118.857143 76.857143z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="zhihu"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M351.791182 562.469462l192.945407 0c0-45.367257-21.3871-71.939449-21.3871-71.939449L355.897709 490.530013c3.977591-82.182744 7.541767-187.659007 8.816806-226.835262l159.282726 0c0 0-0.86367-67.402109-18.578124-67.402109s-279.979646 0-279.979646 0 16.850783-88.141456 39.318494-127.053698c0 0-83.60514-4.510734-112.121614 106.962104S81.344656 355.077018 76.80834 367.390461c-4.536316 12.313443 24.62791 5.832845 36.941354 0 12.313443-5.832845 68.050885-25.924439 84.252893-103.69571l86.570681 0c1.165546 49.28652 4.596691 200.335724 3.515057 226.835262L109.86113 490.530013c-25.275663 18.147312-33.701566 71.939449-33.701566 71.939449L279.868105 562.469462c-8.497535 56.255235-23.417339 128.763642-44.275389 167.210279-33.05279 60.921511-50.55235 116.65793-169.802314 212.576513 0 0-19.442818 14.257725 40.829917 9.073656 60.273758-5.185093 117.305683-20.739347 156.840094-99.807147 20.553105-41.107233 41.805128-93.250824 58.386782-146.138358l-0.055259 0.185218 167.855986 193.263655c0 0 22.035876-51.847855 5.832845-108.880803L371.045711 650.610918l-42.1244 31.157627-0.045025 0.151449c11.69946-41.020252 20.11206-81.5749 22.726607-116.858498C351.665315 564.212152 351.72876 563.345412 351.791182 562.469462z"></path>
  <path d="M584.918753 182.033893l0 668.840094 70.318532 0 28.807093 80.512708 121.875768-80.512708 153.600307 0L959.520453 182.033893 584.918753 182.033893zM887.150192 778.934538l-79.837326 0-99.578949 65.782216-23.537066-65.782216-24.855084 0L659.341766 256.673847l227.807403 0L887.149169 778.934538z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="douban"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M926.917973 37.80608C959.65184 37.80608 986.19392 64.34816 986.19392 97.082027L986.19392 926.917973C986.19392 959.65184 959.65184 986.19392 926.917973 986.19392L97.082027 986.19392C64.34816 986.19392 37.80608 959.65184 37.80608 926.917973L37.80608 97.082027C37.80608 64.34816 64.34816 37.80608 97.082027 37.80608zM176.653653 176.19968 176.653653 252.678827 825.658027 252.678827 825.658027 176.19968zM217.719467 316.146347 217.719467 628.08064 273.524053 628.08064 341.292373 770.39616 157.259093 770.39616 157.259093 845.417813 842.949973 845.417813 842.949973 770.39616 654.226773 770.39616 722.899627 628.08064 783.67744 628.08064 783.67744 316.146347zM684.885333 392.891733 684.885333 553.987413 312.576 553.987413 312.576 392.891733zM570.770773 770.39616 426.653013 770.39616 359.621973 628.08064 639.443627 628.08064z"></path>
</svg>

    </a>


<a href="https://lcx.cc/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">

  

  <span class="copyright-year">
    &copy;
    
      2010 -
    2025
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        Nuclear'Atk（核攻击）网络安全实验室
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>






<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?90a2a7fb2c0fa46d3747ec9668f12a39";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>

<script id="baidu_push">
  (function(){
    if (window.location.hostname === 'localhost') return;
    var bp = document.createElement('script'); bp.async = true;
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
  })();
</script>



  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  














  <script src="/js/my.js"></script>


</body>
</html>
