<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>从开发角度也说《互联网最大规模帐号劫持漏洞即将引爆》 - Nuclear&#39;Atk（核攻击）网络安全实验室</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="horseluke" /><meta name="description" content="小议OAuth 2.0的state参数——从开发角度也说《互联网最大规模帐号劫持漏洞即将引爆》。有一个外国研究员在最近研究OAuth 2.0的登录过程中发现了许多程序员常犯的错误（见翻译文：http://www.freebuf.com/articles/web/5997.html ），原始地址见 http://homakov.blogspot.jp/2012/07/saferweb-most-common-oauth2.html 知道创宇测试国内各网站后发现确为如此，并在今天发表了《互联网最大规模帐号劫持漏洞即将引爆》（http://tech.ccidnet.com/art/32963/20121109/4448657_1.html ）。但这篇文章本身的标题实在过于劲爆，同时微博出现了各种误传，结果成了一场个人看来并不必要的恐慌，以及口水战。这篇文章，主要从开发者的角度，来解释这个漏洞的来龙去脉，并以问答的形式给出一些个人建议和其他看法。" />
<meta name="keywords" content="小议OAuth 2.0的state参数——从开发角度也说《互联网最大规模帐号劫持漏洞即将引爆》" />



<meta name="baidu-site-verification" content="GSIJv096Bu" />



<meta name="generator" content="Hugo 0.82.0" />


<link rel="canonical" href="https://lcx.cc/post/3077/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.af20b78e95c84de86b00a0242a4a77bd2601700e1b250edf27537d957ac0041d.css" integrity="sha256-ryC3jpXITehrAKAkKkp3vSYBcA4bJQ7fJ1N9lXrABB0=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="从开发角度也说《互联网最大规模帐号劫持漏洞即将引爆》" />
<meta property="og:description" content="小议OAuth 2.0的state参数——从开发角度也说《互联网最大规模帐号劫持漏洞即将引爆》。有一个外国研究员在最近研究OAuth 2.0的登录过程中发现了许多程序员常犯的错误（见翻译文：http://www.freebuf.com/articles/web/5997.html ），原始地址见 http://homakov.blogspot.jp/2012/07/saferweb-most-common-oauth2.html 知道创宇测试国内各网站后发现确为如此，并在今天发表了《互联网最大规模帐号劫持漏洞即将引爆》（http://tech.ccidnet.com/art/32963/20121109/4448657_1.html ）。但这篇文章本身的标题实在过于劲爆，同时微博出现了各种误传，结果成了一场个人看来并不必要的恐慌，以及口水战。这篇文章，主要从开发者的角度，来解释这个漏洞的来龙去脉，并以问答的形式给出一些个人建议和其他看法。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lcx.cc/post/3077/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2012-11-12T15:06:38&#43;08:00" />
<meta property="article:modified_time" content="2012-11-12T16:07:50&#43;08:00" />

<meta itemprop="name" content="从开发角度也说《互联网最大规模帐号劫持漏洞即将引爆》">
<meta itemprop="description" content="小议OAuth 2.0的state参数——从开发角度也说《互联网最大规模帐号劫持漏洞即将引爆》。有一个外国研究员在最近研究OAuth 2.0的登录过程中发现了许多程序员常犯的错误（见翻译文：http://www.freebuf.com/articles/web/5997.html ），原始地址见 http://homakov.blogspot.jp/2012/07/saferweb-most-common-oauth2.html 知道创宇测试国内各网站后发现确为如此，并在今天发表了《互联网最大规模帐号劫持漏洞即将引爆》（http://tech.ccidnet.com/art/32963/20121109/4448657_1.html ）。但这篇文章本身的标题实在过于劲爆，同时微博出现了各种误传，结果成了一场个人看来并不必要的恐慌，以及口水战。这篇文章，主要从开发者的角度，来解释这个漏洞的来龙去脉，并以问答的形式给出一些个人建议和其他看法。"><meta itemprop="datePublished" content="2012-11-12T15:06:38&#43;08:00" />
<meta itemprop="dateModified" content="2012-11-12T16:07:50&#43;08:00" />
<meta itemprop="wordCount" content="8231">
<meta itemprop="keywords" content="爆,互联网,劫持,漏洞,360,Html,HTTP,IE,IP,PHP,Wiki,wooyun,XSS,安全,保护,程序,程序员,代理,代码,第三方,服务,服务器,攻击,技术,跨站,浏览器,淘宝,网站,微博,问题,协议,云,账号," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="从开发角度也说《互联网最大规模帐号劫持漏洞即将引爆》"/>
<meta name="twitter:description" content="小议OAuth 2.0的state参数——从开发角度也说《互联网最大规模帐号劫持漏洞即将引爆》。有一个外国研究员在最近研究OAuth 2.0的登录过程中发现了许多程序员常犯的错误（见翻译文：http://www.freebuf.com/articles/web/5997.html ），原始地址见 http://homakov.blogspot.jp/2012/07/saferweb-most-common-oauth2.html 知道创宇测试国内各网站后发现确为如此，并在今天发表了《互联网最大规模帐号劫持漏洞即将引爆》（http://tech.ccidnet.com/art/32963/20121109/4448657_1.html ）。但这篇文章本身的标题实在过于劲爆，同时微博出现了各种误传，结果成了一场个人看来并不必要的恐慌，以及口水战。这篇文章，主要从开发者的角度，来解释这个漏洞的来龙去脉，并以问答的形式给出一些个人建议和其他看法。"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Nuclear'Atk</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/post/">归档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/categories/">分类</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/">友链</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%85%B3%E4%BA%8E/">关于</a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      Nuclear'Atk
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/post/">归档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/categories/">分类</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/">友链</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%85%B3%E4%BA%8E/">关于</a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">从开发角度也说《互联网最大规模帐号劫持漏洞即将引爆》</h1>
      
      <div class="post-meta">
        <time datetime="2012-11-12" class="post-time">
          2012-11-12
        </time>
        <div class="post-category">
            <a href="https://lcx.cc/categories/%E8%80%81%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AE%B9/"> 老系统内容 </a>
            <a href="https://lcx.cc/categories/%E7%88%86/"> 爆 </a>
            <a href="https://lcx.cc/categories/%E4%BA%92%E8%81%94%E7%BD%91/"> 互联网 </a>
            <a href="https://lcx.cc/categories/%E5%8A%AB%E6%8C%81/"> 劫持 </a>
            <a href="https://lcx.cc/categories/%E6%BC%8F%E6%B4%9E/"> 漏洞 </a>
            
          </div>
        <span class="more-meta"> 约 8231 字 </span>
          <span class="more-meta"> 预计阅读 17 分钟 </span>

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    
  </div>
</div>

    
    <div class="post-content">
      
<p style="text-indent:2em;">
	标题：小议OAuth 2.0的state参数——从开发角度也说《互联网最大规模帐号劫持漏洞即将引爆》
</p>
<p style="text-indent:2em;">
	有一个外国研究员在最近研究OAuth 2.0的登录过程中发现了许多程序员常犯的错误（见翻译文：<a href="http://www.freebuf.com/articles/web/5997.html" target="_blank">http://www.freebuf.com/articles/web/5997.html</a>），原始地址见 <a href="http://homakov.blogspot.jp/2012/07/saferweb-most-common-oauth2.html" target="_blank">http://homakov.blogspot.jp/2012/07/saferweb-most-common-oauth2.html</a> 知道创宇测试国内各网站后发现确为如此，并在今天发表了《<a href="https://lcx.cc/post/3071/" target="_blank">互联网最大规模帐号劫持漏洞即将引爆</a>》（http://tech.ccidnet.com/art/32963/20121109/4448657_1.html ）。但这篇文章本身的标题实在过于劲爆，同时微博出现了各种误传，结果成了一场个人看来并不必要的恐慌，以及口水战。这篇文章，主要从开发者的角度，来解释这个漏洞的来龙去脉，并以问答的形式给出一些个人建议和其他看法。
</p>
<p style="text-indent:2em;">
	通俗的说一下这个漏洞的表现（虽然不全准确）：你有一间房子，证明方法是你有一张房契，上面说“你和房子存在有效关系”。某一天，有个中介叫你签续租合同（带复写纸一式三份那种）；你签了，结果被告知房子成了别人了。后经调查，续租合同的第二联，其实是一份转让合同。就这样，房契的关系就变了。
</p>
<p style="text-indent:2em;">
	你也许懊恼，为什么没有好好检查这一式三份的合同是否一致。同样，在这个漏洞中，开发者就会懊恼，为什么没有好好使用并检查state参数？
</p>
<p style="text-indent:2em;">
	但是在说明这个state参数前，有必要了解大部分程序员所写的绑定OAuth账号流程，由于绑定流程很多，这里挑最常见的“用户在第三方网站A上登录后，通过Authorization code方式绑定微博”流程（也是这个漏洞常见的场景流程）：
</p>
<p style="text-indent:2em;">
	（1）用户甲到第三方网站A登录后，到了绑定页面。此时还没绑定微博。
</p>
<p style="text-indent:2em;">
	（2）绑定页面提供一个按钮：“绑定微博”（地址a：http://aaa.com/index.php?m=user_3rd_bind_sina）
</p>
<p style="text-indent:2em;">
	（3）用户甲点击地址a，程序生成如下地址b（为方便大家查看，参数部分均未urlencode以【】包含显示）：
</p>
<p style="text-indent:2em;">
	https://api.weibo.com/oauth2/authorize?client_id=【9999999】&amp;redirect_uri=【http://aaa.comindex.php?m=user_3rd_bind_sina_callback】&amp;response_type=【code】
</p>
<p style="text-indent:2em;">
	（4）用户甲浏览器定向到地址b，授权该应用。
</p>
<p style="text-indent:2em;">
	（5）授权服务器根据传递的redirect_uri参数，组合认证参数code生成地址c：
</p>
<p style="text-indent:2em;">
	http://aaa.comindex.php?m=user_3rd_bind_sina_callback&amp;code=【809ui0asduve】
</p>
<p style="text-indent:2em;">
	（6）用户甲浏览器返回到地址c，完成绑定。
</p>
<p style="text-indent:2em;">
	咋看起来，好像没啥问题，毕竟code也是不可预测嘛。但是各开发者有没有想过，地址c实质上是和当前登录用户一点关系都没有的，因为地址c只能证明微博用户信息，但无法证明网站A的用户信息。所以漏洞就此产生了——假设有用户乙和丙，同时发起绑定请求，登录到不同的微博账号，然后在第5步后打住，互相交换地址c，会是什么结果？答案就是用户乙绑定了用户丙的微博，用户丙绑定了用户乙的微博了…...攻击者的目标，其实就是要获取地址c，然后诱骗已登录网站A的受害者点击，从而改变了绑定关系。
</p>
<p style="text-indent:2em;">
	为应对这种情况，Oauth 2.0引入了state参数。state参数是什么？看看没多长时间前最终定稿的rfc6749（The OAuth 2.0 Authorization Framework， http://tools.ietf.org/html/rfc6749 ）：
</p>
<p style="text-indent:2em;">
	state: RECOMMENDED. An opaque value used by the client to maintain state between the request and callback.&nbsp;&nbsp;The authorization server includes this value when redirecting the user-agent back to the client.&nbsp;&nbsp;The parameter SHOULD be used for preventing cross-site request forgery as described in Section 10.12.
</p>
<p style="text-indent:2em;">
	（推荐。一个由client使用的不透明参数，用于请求阶段和回调阶段之间的状态保持。此参数将在授权服务器重定向用户代理（如浏览器，译者注）回client时包含。该参数理应使用，以防止章节10.12中描述的CSRF。）（PS：不知咋翻译opaque value，只好翻译为“不透明参数”）
</p>
<p style="text-indent:2em;">
	这个参数在许多开放平台上也会有提及，比如新浪微博的Oauth2/authorize（http://open.weibo.com/wiki/Oauth2/authorize ）：
</p>
<p style="text-indent:2em;">
	用于保持请求和回调的状态，在回调时，会在Query Parameter中回传该参数。开发者可以用这个参数验证请求有效性，也可以记录用户请求授权页前的位置。这个参数可用于防止跨站请求伪造（CSRF）攻击。
</p>
<p style="text-indent:2em;">
	然而大多数开发者（包括许多官方SDK），会忽略使用这个state参数。所以，大面积的网站（不乏大站）确实存在这种漏洞，这也是知道创宇认为“互联网最大规模帐号劫持即将引爆”的根源。但是在我看来，有点危言耸听，因为利用条件实属有点苛刻：
</p>
<p style="text-indent:2em;">
	（1）攻击者必须了解第三方网站可能的绑定特性，否则攻击极可能失败。绝大多数网站都是一个网站账号只能绑定一个OAuth提供方账号（比如微博帐号）。这种特性，导致这个漏洞在绝大多数网站根本无法快速撒网，只能定向劫持未绑定的用户到攻击者OAuth账号上，而攻击一次后，这个账号必须解绑才能用于别的攻击，导致利用难度增大不少。
</p>
<p style="text-indent:2em;">
	（2）攻击者还必须了解被定向劫持用户的上网习惯。在这个漏洞中，绝大部分都需要受害者在第三方网站上处于登录状态，否则攻击基本失效。
</p>
<p style="text-indent:2em;">
	（3）攻击者还必须了解第三方网站、以及用户在该第三方网站上存在的利益。现在的攻击有许多都是带有利益的，如果是电商类的话，网站本身的金钱利益驱动可能存在，但又需要判断该用户在该网站是否存在高价值，这就增加了额外的工作量；如果只是娱乐类网站，除了言论相关和用户所拥有的网站管理权，我还想不出有什么可以吸引攻击者去定向攻击。
</p>
<p style="text-indent:2em;">
	以上各种条件造就了在攻击实施环节更像是那种一对一的淘宝或者QQ钓鱼手段、或者放入针对高价值目标的社工（或APT）一环中。就前者而言，淘宝、QQ甚至各类热门游戏的钓鱼量之大，安全研究者们应该更清楚；就后者而言，实质还有其它更有效地手段。那么，这个漏洞，还能冠以“最大规模帐号劫持”吗？我相信，地下产业者看到后只会轻蔑的笑一下，然后继续埋头干活……
</p>
<p style="text-indent:2em;">
	对于开发者而言，要修复这个漏洞，就是必须加入state参数，这个参数既不可预测，又必须可以充分证明client和当前第三方网站的登录认证状态存在关联（如果存在过期时间更好）。见rfc6749 章节10.12：
</p>
<p style="text-indent:2em;">
	The binding value used for CSRF protection MUST contain a non-guessable value (as described in Section 10.10), and the user-agent's authenticated state (e.g., session cookie, HTML5 local storage) MUST be kept in a location accessible only to the client and the user-agent (i.e., protected by same-origin policy).
</p>
<p style="text-indent:2em;">
	（这个用于防御CSRF的绑定参数（即state参数，译者注）必须包含一个不可预测的数值（如同章节10.10的描述），还有用户代理（如浏览器，译者注）的认证状态必须保存在只允许client和用户代理两者访问的地方（也就是受到同源策略保护））
</p>
<p style="text-indent:2em;">
	这听起来好复杂，其实，随机算一个字符串，然后保存在session，回调时检查state参数和session里面的值，就满足要求了。php示例如下：
</p>
<p style="text-indent:2em;">
	构造Oauth2/authorize阶段：
</p>
<pre class="prettyprint lang-php">$_SESSION['REQ_STATE'] = md5(uniqid(mt_rand(1, 100000), true));  //生成state参数，并存放于session
//$_SESSION['REQ_STATE'] = $_USER['uid']. '_'. $_USER['reg_ip']. '_'. $state;   //（如果还是怕随机不够，算法多考虑一些独特且不可预知的用户信息吧，reg_ip是个不错的选择）</pre>
<p style="text-indent:2em;">
	callback回调检查：
</p>
<pre class="prettyprint lang-php">$_state_check = !empty($_SESSION['REQ_STATE']) &amp;&amp; ($_SESSION['REQ_STATE'] == $_GET['state']) ? true : false;   //callback回调检查</pre>
<hr />
<p>
	<strong>以下是问答环节：</strong> 
</p>
<p style="text-indent:2em;">
	<strong>一、普通用户问答环节</strong> 
</p>
<p style="text-indent:2em;">
	问：有微博提出，针对这个漏洞，解决方法是“微博用户立刻检查“我的应用”，暂取消所有应用授权，再根据需要重新授权”，是否正确？
</p>
<p style="text-indent:2em;">
	答：就这个漏洞而言，完全错误！该漏洞的结果是第三方网站帐号被关联到攻击者的微博账号上，而不是自己的微博帐号被关联到攻击者的第三方网站账号。在“我的应用”中解除所有应用并不会对攻击者产生任何影响。还记得房子的例子吧？可以类比为：即使自己自杀，也不能导致房子和攻击者解除房契关系。
</p>
<p style="text-indent:2em;">
	正确方法请看知道创宇的方案：“定期查看重要网站（比如你经常看优酷的话就检查优酷）的第三方帐号绑定页面，检查是否有陌生的其他帐号绑定到自身账户，如果发现应立即取消绑定或授权。”
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	问：如果有一个网站的帐号可绑定多个OAuth帐号（或反过来），我是否很容易中招？（即攻击难度是否降低成可以广撒网？）
</p>
<p style="text-indent:2em;">
	答：明显是的。然而，从实际接触的业务来看，这种奇葩应用有理由相信存在量不会多，而且做不好绝对不只有这个漏洞，各平台也基本不允许这类应用存在。
</p>
<p style="text-indent:2em;">
	真遇到了这类应用怎么办？如果你不是搞营销的，还是别碰这类应用稳妥，赶紧双向取消绑定吧（奇葩应用取消所有绑定，微博“我的应用”也取消）。
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	问：如何判断自己是否为高价值用户，容易遭受攻击？
</p>
<p style="text-indent:2em;">
	答：简单判断方法就是，你在微博上经常晒自己购物的网站来源，还说自己中了优惠券，就有可能了；又或者你成大嘴了，就容易被盯上社工。但是实际上，偷账号的手段更多，这个漏洞对普通用户意义实在不大，该干啥就干啥吧！
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	<strong>二、开发者问答环节</strong> 
</p>
<p style="text-indent:2em;">
	问：这个漏洞究竟严不严重？
</p>
<p style="text-indent:2em;">
	答：“安全无小事”。作为合格的开发者，如果你是对用户负责，又是高价值网站，那是确实挺高的。而综合目前的情况，我个人综合评价是低。原因已经在上面讲了。
</p>
<p style="text-indent:2em;">
	而且个人觉得开发者过于关注这个漏洞，其实并不见得是好事，因为这个漏洞实质上暴露的是开发者们对OAuth协议（或者说各种第三方接入协议）的各种流程和参数了解得不足——当然这也有平台甚至协议本身的责任在，看看各wiki和sdk就知道了。历史上相关案例也不少，甚至更严重，比如《淘网址sina oauth认证登录漏洞》：http://www.wooyun.org/bugs/wooyun-2012-011104 。
</p>
<p style="text-indent:2em;">
	基于以上原因，个人非常建议开发者对整个OAuth流程部分（包括登录、绑定、解绑等）都通盘检查一次；阅读各种wiki（如果可以读RFC，那就更好了），对OAuth的相关参数要有相当清晰的了解并合理地运用——但这个过程确实很长，我自己也没完全仔细看各种wiki和rfc，囧。平台的话，加强引导（尤其是SDK）还是很重要的，这点绝对要赞淘宝的@放翁_文初 （http://weibo.com/fangweng ）。
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	问：如果设计为“在绑定状态下不允许更换，需要先解绑再绑定”，那是否意味着没有问题？
</p>
<p style="text-indent:2em;">
	答：难说，假设攻击者可以CSRF解绑；或者你的绑定回调callback代码实际上没有检查绑定状态，一样可以遭受这个攻击。如果可以确定不存在上述问题，那还好。
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	问：为什么OAuth 1.0没有这个问题？
</p>
<p style="text-indent:2em;">
	答：问这个问题的都是第三方应用的开发老手啊！想必也是和我一样被一路折磨而来，还不知道哪天到头啊！表示泪流满面！（群众：喂喂喂你干嘛这么激动，扔鸡蛋 -_-#）
</p>
<p style="text-indent:2em;">
	其实不是没这个问题，而是OAuth 1.0时代，大多数开发者都会将REQUEST TOKEN写到session（或者和当前用户有关的地方中），攻击者获取到的REQUEST TOKEN根本无法跑到受害者的session中，并且ACCESS TOKEN的时候又必须要用REQUEST TOKEN来换，这样一来，无意间完成了client的用户登录状态维持和校验，这就救了大家一命啊！OAuth 2.0时代，没了三次握手，大多数开发者也没有留意到用户状态校验这点，所以就出事了。还是强调那句，state参数除了随机，还必须可以充分证明和当前网站的登录认证状态存在关联。
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	问：还是不明白state参数所说的“必须可以充分证明client和当前网站的登录认证状态存在关联”，不是随机就成了么？
</p>
<p style="text-indent:2em;">
	答：只要state参数不能校验第三方网站的登陆认证状态，这个漏洞就生效。比如：
</p>
<p style="text-indent:2em;">
	构造Oauth2/authorize阶段：
</p>
<pre class="prettyprint lang-php">$state = md5(uniqid(mt_rand(1, 100000), true));  //生成state参数
set_cache($state, 1, 1800);  //$state作为cachekey存入缓存。</pre>
<p style="text-indent:2em;">
	callback回调检查：
</p>
<pre class="prettyprint lang-php">If(!empty($_GET['state'])){
$_state_check = get_cache($_GET['state']) == 1 ? true : false;   //这块缓存并不能证明是当前第三方网站的用户的，所以state并没有防御这个漏洞的效果
}else{
$_state_check = false;
}</pre>
<p style="text-indent:2em;">
	解决方法还是要想方设法加入用户登录认证信息的校验，不愿想的话，session足矣。
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	问：如果想在参数state内传递多个参数，怎么办？
</p>
<p style="text-indent:2em;">
	答：强烈建议在传递前进行一次base64编码！在这方面我吃过很大的亏，只是使用http_build_query而没有在最后再加一次base64_encode，导致在最后回调阶段的时候，因为php解析器自动帮我urldecode了参数state，导致数据不完整，哭死了！
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	<strong>三、安全研究员问答环节</strong> 
</p>
<p style="text-indent:2em;">
	问：《百度开放平台oauth授权接口可以劫持access_token》（WooYun-2012-12683）是否就是这个漏洞？
</p>
<p style="text-indent:2em;">
	答：乌云这次确实搞错了。百度所反映的问题是OAuth 2.0所普遍存在的client-side Implicit Grant问题；但这个漏洞攻击的前提是使用了Authorization code方式（所以知道创宇所说的“推荐使用Authorization Code方式进行授权，而不要使用Implicit Flow方式。这样access token会从授权服务器以响应体的形式返回而不会暴露在客户端”在这个漏洞上并不成立的原因）。两者的流程并不一致。
</p>
<p style="text-indent:2em;">
	关于client-side Implicit Grant问题，请参考本人之前写的另一篇文章：<a href="http://zone.wooyun.org/content/1088" target="_blank">http://zone.wooyun.org/content/1088</a> 
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	问：知道创宇提供的解决方案，在业务上有没有可能存在冲突？
</p>
<p style="text-indent:2em;">
	答：有一个不完全符合业务需求：“在绑定过程中，应强制用户重新输入用户名密码确认绑定，不要直接读取当前用户session进行绑定”。这样实质上增加了用户的负担；同时，现在新兴网站均在使用OAuth登录授权后自动创建账号，此时账号密码是随机的，用户并不知道，导致这种方案的流程实质走不下去。
</p>
<p style="text-indent:2em;">
	对于大部分网站而言，加强state的校验、登录和绑定流程分开、不允许绑时换账号、只允许一对一绑定、绑时检查绑定状态等措施已经足够。
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	问：纵观全文，你既不能否定这个漏洞未来可以爆发到“最大规模”的可能性，又无充分案例证明不可能爆发。是否你在误导人更多一些啊？
</p>
<p style="text-indent:2em;">
	答：是的，我无法证明，因为对于安全问题，绝大部分开发者永远不可能达到深入的境界，但是他们拥有对业务方面更专深的了解。安全研究者当然可以认为任何漏洞都可以爆发到不可收拾的后果，但摊分到业务，是否真的有充分的条件可以爆发？摊分到公众，是否真的需要冠上“最大”“史上”“灾难性”等词汇来刺激公众、造成恐慌？这正是我从业务层面写这篇文章的原因，至于是否误导（即云舒所说的第二和第三种程序员），相信日后会有证明。
</p>
<p style="text-indent:2em;">
	特别是在这次漏洞传播中，有安全公司竟然传播错误的解决方案，就像一个本来教地震安全知识的课堂，却传授大家地震时往防空洞跑（即将防空知识错误地传授到地震领域中），用户觉得学到安全知识了，结果呢？太多空喊“狼来了”的后果大家都懂，那么错误的安全知识会否造成比这更严重的后果？安全公司在传授安全意识时，是否应当有更多务实的意识呢？IT界是一团浆糊，安全圈是娱乐圈，那么是否就要将公众当无知的公仔乱扯？…...
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	摘自：<a href="http://zone.wooyun.org/content/1562" target="_blank">http://zone.wooyun.org/content/1562</a> 
</p>
<hr />
<p>
	<strong>白帽子精彩评论：</strong> 
</p>
<p style="text-indent:2em;">
	shine (shield) | 2012-11-10 07:52
</p>
<p style="text-indent:2em;">
	这里的问答模式很好，日后可能催生乌云一个新的功能或平台发展，介于安全与用户的第三方安全问答平台，也就是安全翻译了，楼主就是首席安全问答官,哈哈!
</p>
<p style="text-indent:2em;">
	至于主不主观，个人想，如果问题都是不确定性地去描述，那还有什么观点意义了!
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	gainover ("&gt;_&lt; ' / &amp; \ 看啥，没见过跨站字符么) | 2012-11-10 10:34
</p>
<p style="text-indent:2em;">
	@shine 嗯，从主观的角度讲，我觉得这篇文章挺客观的，既肯定了可能性，又否定了必然性。
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	horseluke (微碌) | 2012-11-10 10:38
</p>
<p style="text-indent:2em;">
	@B1n4ry @伟大娃娃 @only_guest @gainover 我擦.......你们果然是夜猫。
</p>
<p style="text-indent:2em;">
	昨晚想了一下，如果想广撒网，也不是不可以，攻击者需要许多个OAuth账号，然后不停地授权获取地址然后群发。但这个缺陷有：开放平台的异常登录封杀；撒网后还需要按受害者list进行检查......成本还是高了
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	gainover ("&gt;_&lt; ' / &amp; \ 看啥，没见过跨站字符么) | 2012-11-10 10:54
</p>
<p style="text-indent:2em;">
	@horseluke 这样是不是黑客的oauth账号数目决定了攻击规模了?
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	horseluke (微碌) | 2012-11-10 11:09
</p>
<p style="text-indent:2em;">
	@gainover 是。从我知道的情况来看，一个营销团队拥有上w账号是基本业务量要求。
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	p.z (让我们一起，把前列腺溶解在风里。) | 2012-11-10 12:04
</p>
<p style="text-indent:2em;">
	@horseluke 获取授权地址之类的事情，完全可以在服务器端来完成，对于攻击者来说，只要大量的spam账号即可。攻击代码可简化到&lt;img src='http://evil.com/hijack.php'/&gt;，只要收益足够高，不排除有人会这么搞。
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	horseluke (微碌) | 2012-11-10 12:15
</p>
<p style="text-indent:2em;">
	@p.z 用服务端频繁模拟授权，会导致平台对其进行ip限制问题；如果弄肉鸡，各平台也应该有对应的策略（因为肉鸡的对抗已经不是一天两天的事情了）。
</p>
<p style="text-indent:2em;">
	收益问题，需要要看目标网站的属性和相关代码实现是否存在纰漏容易被利用。目前来讲，电商类确实会危险点。
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	Pnig0s (Know me then ignore me.) | 2012-11-10 12:29
</p>
<p style="text-indent:2em;">
	其一，译文只提到了OAuth CSRF的部分问题。我们在其基础上进行了研究，扩大了攻击面，降低了利用成本。
</p>
<p style="text-indent:2em;">
	其二，如你的文章题目-从开发者角度，而我们那篇文章更多不是给开发人员去看的。
</p>
<p style="text-indent:2em;">
	其三，RFC怎么写是一回事，开发人员怎么用是另一回事。OAuth授权一环扣一环，用户其中一个帐号被劫持，他使用OAuth授权的所有帐号都会存在被劫持风险。比如：我劫持了目标的360帐号，而360又向其他厂商提供用户资源，那么就可以继续劫持用户在其他网站使用360平台登录的帐号。
</p>
<p style="text-indent:2em;">
	其四，我们的报道点在于，广泛存在于整个互联网各行业且易于实施攻击，一个GET即可，不用搞接收平台，且为持久性劫持不必考虑时效性,鉴于目前研究OAuth安全问题的人并不多，我们的报道要起到预警作用。
</p>
<p style="text-indent:2em;">
	其五，以讹传讹不是我们能控制的，但报道的文章中我们已字字斟酌。危言耸听是你狭隘了，仅以技术角度去分析那篇文章。你所说的质疑，也都集中在圈内，还要算上各路水军吧:)
</p>
<p style="text-indent:2em;">
	其六，技术人员看不惯这种公司层面借用技术大面积报道可以理解。
</p>
<p style="text-indent:2em;">
	综上，没有任何争论的必要了:)
</p>
<p style="text-indent:2em;">
	P.S:至于你说的封杀，我基本把国内提供或使用第三方平台的知名站点都测试过，目前看我的号一个都没有被干掉:)当然还是辛苦你熬夜写出一篇文章，抛开事件不谈，还是值得开发人员学习和了解的，只是难道好文都要这么被逼出来么:)
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	horseluke (微碌) | 2012-11-10 12:39
</p>
<p style="text-indent:2em;">
	@Pnig0s 对于开发人员来讲，他看到一篇不透明的文章，不知道如何修复，那么预警就完全失去了意义；对于公众，无处不在的漏洞和信息泄露下，漏洞再多再大都只会把公众继续推向不愿抵抗的羊群的边缘，这也是营销们可以肆无忌惮搞小动作搞口水的理由。
</p>
<p style="text-indent:2em;">
	我反对的不是这个漏洞本身，我也承认这个漏洞可能的最大严重后果；我反对的，是报道这个漏洞的时候，没有结合业务来搞清楚，并且使用了疑似夸大与不透明的词汇，导致不必要的公众恐慌和口水。
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	xsser (十根阳具有长短!!) | 2012-11-10 12:45
</p>
<p style="text-indent:2em;">
	@horseluke 譬如某些微博说取消所有应用授权...... 另外，不透明真没好处，总有一天有人会说，XXX存在严重安全漏洞，请大家卸载或者不要访问，而根本原因可能是个xss，如果这事真发生了，我们都有责任
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	horseluke (微碌) | 2012-11-10 12:59
</p>
<p style="text-indent:2em;">
	摘一个转发：
</p>
<p style="text-indent:2em;">
	===================================
</p>
<p style="text-indent:2em;">
	http://weibo.com/1921985135/z4wUOvAon
</p>
<p style="text-indent:2em;">
	@渥村万涛: 其实, 这个漏洞的根本原因, 是违反了RFC6749, 没有任何CSRF保护, 而不是没有使用state参数 (state只是实现CSRF保护的一种). 根据RFC6749 http://t.cn/zlTZyo6 state是推荐(SHOULD), 而不是必须(MUST). 但CSRF保护是MUST. 没有用state, 不违反标准, 但没有CSRF保护, 则违反
</p>
<p style="text-indent:2em;">
	===================================
</p>
<p style="text-indent:2em;">
	这个转发更能说明这个漏洞的本质。顿感自己写这文太啰嗦了，哈。
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	xsser (十根阳具有长短!!) | 2012-11-10 13:02
</p>
<p style="text-indent:2em;">
	@horseluke 本质是状态的身份验证吧，还是state的事儿，不认为是csrf
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	c4bbage | 2012-11-10 13:08
</p>
<p style="text-indent:2em;">
	rfc&nbsp;&nbsp; RFC
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	horseluke (微碌) | 2012-11-10 13:40
</p>
<p style="text-indent:2em;">
	@xsser 其实相关身份验证参数还可以放到redirect_uri上（某些不提供state参数的还真只能放在这里面）；只不过state参数在各平台更加通用。
</p>
<p style="text-indent:2em;">
	&nbsp;
</p>
<p style="text-indent:2em;">
	<a href="http://zone.wooyun.org/content/1562" target="_blank">[点此围观更多白帽子评论]</a> 
</p>
<p>
	<strong>相关内容：</strong>
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/3077/" target="_blank">从开发角度也说《互联网最大规模帐号劫持漏洞即将引爆》</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/3071/" target="_blank">互联网最大规模帐号劫持漏洞即将引爆</a> 
</p>
<p><strong>留言评论（旧系统）：</strong></p>
<div style="max-height:600px;width:100%;overflow:auto;overflow-x:hidden;">
<blockquote id="2648,3077,175.160.199.44">
<p>佚名 @ 2012-11-12 16:00:33</p>
<p style="text-indent:2em">CSRF问题，开放平台文档里写的很明白了。新浪：http://t.cn/a3jeVD 腾讯：http://t.cn/zjPcXUr 人人：http://t.cn/zjPc8fk</p>
<p>本站回复：</p>
<p style="text-indent:2em">Good!</p>
</blockquote>
</div>
    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">horseluke</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2012-11-12
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a href="https://lcx.cc/" target="_blank">Nuclear'Atk（核攻击）网络安全实验室</a>版权所有，转载请注明出处。</span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://lcx.cc/tags/%E7%88%86/">爆</a>
          <a href="https://lcx.cc/tags/%E4%BA%92%E8%81%94%E7%BD%91/">互联网</a>
          <a href="https://lcx.cc/tags/%E5%8A%AB%E6%8C%81/">劫持</a>
          <a href="https://lcx.cc/tags/%E6%BC%8F%E6%B4%9E/">漏洞</a>
          <a href="https://lcx.cc/tags/360/">360</a>
          <a href="https://lcx.cc/tags/html/">Html</a>
          <a href="https://lcx.cc/tags/http/">HTTP</a>
          <a href="https://lcx.cc/tags/ie/">IE</a>
          <a href="https://lcx.cc/tags/ip/">IP</a>
          <a href="https://lcx.cc/tags/php/">PHP</a>
          <a href="https://lcx.cc/tags/wiki/">Wiki</a>
          <a href="https://lcx.cc/tags/wooyun/">wooyun</a>
          <a href="https://lcx.cc/tags/xss/">XSS</a>
          <a href="https://lcx.cc/tags/%E5%AE%89%E5%85%A8/">安全</a>
          <a href="https://lcx.cc/tags/%E4%BF%9D%E6%8A%A4/">保护</a>
          <a href="https://lcx.cc/tags/%E7%A8%8B%E5%BA%8F/">程序</a>
          <a href="https://lcx.cc/tags/%E7%A8%8B%E5%BA%8F%E5%91%98/">程序员</a>
          <a href="https://lcx.cc/tags/%E4%BB%A3%E7%90%86/">代理</a>
          <a href="https://lcx.cc/tags/%E4%BB%A3%E7%A0%81/">代码</a>
          <a href="https://lcx.cc/tags/%E7%AC%AC%E4%B8%89%E6%96%B9/">第三方</a>
          <a href="https://lcx.cc/tags/%E6%9C%8D%E5%8A%A1/">服务</a>
          <a href="https://lcx.cc/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器</a>
          <a href="https://lcx.cc/tags/%E6%94%BB%E5%87%BB/">攻击</a>
          <a href="https://lcx.cc/tags/%E6%8A%80%E6%9C%AF/">技术</a>
          <a href="https://lcx.cc/tags/%E8%B7%A8%E7%AB%99/">跨站</a>
          <a href="https://lcx.cc/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/">浏览器</a>
          <a href="https://lcx.cc/tags/%E6%B7%98%E5%AE%9D/">淘宝</a>
          <a href="https://lcx.cc/tags/%E7%BD%91%E7%AB%99/">网站</a>
          <a href="https://lcx.cc/tags/%E5%BE%AE%E5%8D%9A/">微博</a>
          <a href="https://lcx.cc/tags/%E9%97%AE%E9%A2%98/">问题</a>
          <a href="https://lcx.cc/tags/%E5%8D%8F%E8%AE%AE/">协议</a>
          <a href="https://lcx.cc/tags/%E4%BA%91/">云</a>
          <a href="https://lcx.cc/tags/%E8%B4%A6%E5%8F%B7/">账号</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/3078/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">终端机常见绕过沙盘方法、突破终端机屏幕锁定限制方法大全</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/3076/">
            <span class="next-text nav-default">说一说新手在寻找XSS时所存在的一些误区</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:root@lcx.cc" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="linkedin"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="33" height="33">
  <path d="M872.405333 872.618667h-151.637333v-237.610667c0-56.661333-1.152-129.578667-79.018667-129.578667-79.061333 0-91.136 61.653333-91.136 125.397334v241.792H398.976V384h145.664v66.602667h1.962667c20.352-38.4 69.845333-78.933333 143.786666-78.933334 153.642667 0 182.058667 101.12 182.058667 232.746667v268.202667zM227.712 317.141333a87.978667 87.978667 0 0 1-88.021333-88.106666 88.064 88.064 0 1 1 88.021333 88.106666z m76.032 555.477334H151.68V384h152.064v488.618667zM948.266667 0H75.562667C33.792 0 0 33.024 0 73.770667v876.458666C0 991.018667 33.792 1024 75.562667 1024h872.576C989.866667 1024 1024 991.018667 1024 950.229333V73.770667C1024 33.024 989.866667 0 948.138667 0h0.128z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="weibo"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M385.714286 733.714286q12-19.428571 6.285714-39.428571t-25.714286-28.571429q-19.428571-8-41.714286-0.571429t-34.285714 26.285714q-12.571429 19.428571-7.428571 39.142857t24.571429 28.857143 42.571429 1.428571 35.714286-27.142857zm53.714286-69.142857q4.571429-7.428571 2-15.142857t-10-10.571429q-8-2.857143-16.285714 2.857143t-12.285714 10.571429q-9.714286 17.714286 7.428571 25.714286 8 2.857143 16.571429 2.857143t12.571429-10.571429zm99.428571 61.142857q-25.714286 58.285714-90.285714 85.714286t-128 6.857143q-61.142857-19.428571-84.285714-72.285714t3.714286-107.142857q26.857143-53.142857 86.571429-79.428571t120.285714-10.857143q63.428571 16.571429 90.571429 68.285714t1.428571 108.857143zm178.285714-91.428571q-5.142857-54.857143-50.857143-97.142857t-119.142857-62.285714-156.857143-12q-127.428571 13.142857-211.142857 80.857143t-75.714286 151.142857q5.142857 54.857143 50.857143 97.142857t119.142857 62.285714 156.857143 12q127.428571-13.142857 211.142857-80.857143t75.714286-151.142857zm176 2.285714q0 38.857143-21.142857 79.714286t-62.285714 78.285714-96.285714 67.142857-129.142857 47.428571-154.571429 17.714286-157.142857-19.142857-137.428571-53.142857-98-86.285714-37.142857-114q0-65.714286 39.714286-140t112.857143-147.428571q96.571429-96.571429 195.142857-134.857143t140.857143 4q37.142857 36.571429 11.428571 119.428571-2.285714 8-0.571429 11.428571t5.714286 4 8.285714 2.857143 7.714286-2l3.428571-1.142857q79.428571-33.714286 140.571429-33.714286t87.428571 34.857143q25.714286 36 0 101.714286-1.142857 7.428571-2.571429 11.428571t2.571429 7.142857 6.857143 4.285714 9.714286 3.428571q32.571429 10.285714 58.857143 26.857143t45.714286 46.571429 19.428571 66.571429zm-42.285714-356.571429q24 26.857143 31.142857 62t-3.714286 67.142857q-4.571429 13.142857-16.857143 19.428571t-25.428571 2.285714q-13.142857-4.571429-19.428571-16.857143t-2.285714-25.428571q11.428571-36-13.714286-63.428571t-61.142857-20q-13.714286 2.857143-25.714286-4.571429t-14.285714-21.142857q-2.857143-13.714286 4.571429-25.428571t21.142857-14.571429q34.285714-7.428571 68 3.142857t57.714286 37.428571zm103.428571-93.142857q49.714286 54.857143 64.285714 127.142857t-7.714286 138q-5.142857 15.428571-19.428571 22.857143t-29.714286 2.285714-22.857143-19.428571-2.857143-29.714286q16-46.857143 5.714286-98.285714t-45.714286-90.285714q-35.428571-39.428571-84.571429-54.571429t-98.857143-4.857143q-16 3.428571-29.714286-5.428571t-17.142857-24.857143 5.428571-29.428571 24.857143-16.857143q70.285714-14.857143 139.428571 6.571429t118.857143 76.857143z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="zhihu"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M351.791182 562.469462l192.945407 0c0-45.367257-21.3871-71.939449-21.3871-71.939449L355.897709 490.530013c3.977591-82.182744 7.541767-187.659007 8.816806-226.835262l159.282726 0c0 0-0.86367-67.402109-18.578124-67.402109s-279.979646 0-279.979646 0 16.850783-88.141456 39.318494-127.053698c0 0-83.60514-4.510734-112.121614 106.962104S81.344656 355.077018 76.80834 367.390461c-4.536316 12.313443 24.62791 5.832845 36.941354 0 12.313443-5.832845 68.050885-25.924439 84.252893-103.69571l86.570681 0c1.165546 49.28652 4.596691 200.335724 3.515057 226.835262L109.86113 490.530013c-25.275663 18.147312-33.701566 71.939449-33.701566 71.939449L279.868105 562.469462c-8.497535 56.255235-23.417339 128.763642-44.275389 167.210279-33.05279 60.921511-50.55235 116.65793-169.802314 212.576513 0 0-19.442818 14.257725 40.829917 9.073656 60.273758-5.185093 117.305683-20.739347 156.840094-99.807147 20.553105-41.107233 41.805128-93.250824 58.386782-146.138358l-0.055259 0.185218 167.855986 193.263655c0 0 22.035876-51.847855 5.832845-108.880803L371.045711 650.610918l-42.1244 31.157627-0.045025 0.151449c11.69946-41.020252 20.11206-81.5749 22.726607-116.858498C351.665315 564.212152 351.72876 563.345412 351.791182 562.469462z"></path>
  <path d="M584.918753 182.033893l0 668.840094 70.318532 0 28.807093 80.512708 121.875768-80.512708 153.600307 0L959.520453 182.033893 584.918753 182.033893zM887.150192 778.934538l-79.837326 0-99.578949 65.782216-23.537066-65.782216-24.855084 0L659.341766 256.673847l227.807403 0L887.149169 778.934538z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="douban"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M926.917973 37.80608C959.65184 37.80608 986.19392 64.34816 986.19392 97.082027L986.19392 926.917973C986.19392 959.65184 959.65184 986.19392 926.917973 986.19392L97.082027 986.19392C64.34816 986.19392 37.80608 959.65184 37.80608 926.917973L37.80608 97.082027C37.80608 64.34816 64.34816 37.80608 97.082027 37.80608zM176.653653 176.19968 176.653653 252.678827 825.658027 252.678827 825.658027 176.19968zM217.719467 316.146347 217.719467 628.08064 273.524053 628.08064 341.292373 770.39616 157.259093 770.39616 157.259093 845.417813 842.949973 845.417813 842.949973 770.39616 654.226773 770.39616 722.899627 628.08064 783.67744 628.08064 783.67744 316.146347zM684.885333 392.891733 684.885333 553.987413 312.576 553.987413 312.576 392.891733zM570.770773 770.39616 426.653013 770.39616 359.621973 628.08064 639.443627 628.08064z"></path>
</svg>

    </a>


<a href="https://lcx.cc/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">

  

  <span class="copyright-year">
    &copy;
    
      2010 -
    2025
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        Nuclear'Atk（核攻击）网络安全实验室
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>






<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?90a2a7fb2c0fa46d3747ec9668f12a39";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>

<script id="baidu_push">
  (function(){
    if (window.location.hostname === 'localhost') return;
    var bp = document.createElement('script'); bp.async = true;
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
  })();
</script>



  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  














  <script src="/js/my.js"></script>


</body>
</html>
